"use strict";(()=>{var mE=Object.create;var _g=Object.defineProperty;var yE=Object.getOwnPropertyDescriptor;var SE=Object.getOwnPropertyNames;var CE=Object.getPrototypeOf,PE=Object.prototype.hasOwnProperty;var p=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports);var RE=(i,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of SE(e))!PE.call(i,n)&&n!==t&&_g(i,n,{get:()=>e[n],enumerable:!(r=yE(e,n))||r.enumerable});return i};var Xu=(i,e,t)=>(t=i!=null?mE(CE(i)):{},RE(e||!i||!i.__esModule?_g(t,"default",{value:i,enumerable:!0}):t,i));var Yu=p(Zu=>{"use strict";Object.defineProperty(Zu,"__esModule",{value:!0});Zu.default=_E;var gs,EE=new Uint8Array(16);function _E(){if(!gs&&(gs=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!gs))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return gs(EE)}});var Ig=p(ms=>{"use strict";Object.defineProperty(ms,"__esModule",{value:!0});ms.default=void 0;var IE=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;ms.default=IE});var dn=p(ys=>{"use strict";Object.defineProperty(ys,"__esModule",{value:!0});ys.default=void 0;var wE=bE(Ig());function bE(i){return i&&i.__esModule?i:{default:i}}function AE(i){return typeof i=="string"&&wE.default.test(i)}var TE=AE;ys.default=TE});var fn=p(vn=>{"use strict";Object.defineProperty(vn,"__esModule",{value:!0});vn.default=void 0;vn.unsafeStringify=wg;var OE=kE(dn());function kE(i){return i&&i.__esModule?i:{default:i}}var le=[];for(let i=0;i<256;++i)le.push((i+256).toString(16).slice(1));function wg(i,e=0){return le[i[e+0]]+le[i[e+1]]+le[i[e+2]]+le[i[e+3]]+"-"+le[i[e+4]]+le[i[e+5]]+"-"+le[i[e+6]]+le[i[e+7]]+"-"+le[i[e+8]]+le[i[e+9]]+"-"+le[i[e+10]]+le[i[e+11]]+le[i[e+12]]+le[i[e+13]]+le[i[e+14]]+le[i[e+15]]}function ME(i,e=0){let t=wg(i,e);if(!(0,OE.default)(t))throw TypeError("Stringified UUID is invalid");return t}var DE=ME;vn.default=DE});var Ag=p(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});Ss.default=void 0;var xE=qE(Yu()),NE=fn();function qE(i){return i&&i.__esModule?i:{default:i}}var bg,ep,tp=0,rp=0;function jE(i,e,t){let r=e&&t||0,n=e||new Array(16);i=i||{};let s=i.node||bg,o=i.clockseq!==void 0?i.clockseq:ep;if(s==null||o==null){let d=i.random||(i.rng||xE.default)();s==null&&(s=bg=[d[0]|1,d[1],d[2],d[3],d[4],d[5]]),o==null&&(o=ep=(d[6]<<8|d[7])&16383)}let a=i.msecs!==void 0?i.msecs:Date.now(),c=i.nsecs!==void 0?i.nsecs:rp+1,u=a-tp+(c-rp)/1e4;if(u<0&&i.clockseq===void 0&&(o=o+1&16383),(u<0||a>tp)&&i.nsecs===void 0&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");tp=a,rp=c,ep=o,a+=122192928e5;let l=((a&268435455)*1e4+c)%4294967296;n[r++]=l>>>24&255,n[r++]=l>>>16&255,n[r++]=l>>>8&255,n[r++]=l&255;let h=a/4294967296*1e4&268435455;n[r++]=h>>>8&255,n[r++]=h&255,n[r++]=h>>>24&15|16,n[r++]=h>>>16&255,n[r++]=o>>>8|128,n[r++]=o&255;for(let d=0;d<6;++d)n[r+d]=s[d];return e||(0,NE.unsafeStringify)(n)}var zE=jE;Ss.default=zE});var ip=p(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});Cs.default=void 0;var LE=BE(dn());function BE(i){return i&&i.__esModule?i:{default:i}}function FE(i){if(!(0,LE.default)(i))throw TypeError("Invalid UUID");let e,t=new Uint8Array(16);return t[0]=(e=parseInt(i.slice(0,8),16))>>>24,t[1]=e>>>16&255,t[2]=e>>>8&255,t[3]=e&255,t[4]=(e=parseInt(i.slice(9,13),16))>>>8,t[5]=e&255,t[6]=(e=parseInt(i.slice(14,18),16))>>>8,t[7]=e&255,t[8]=(e=parseInt(i.slice(19,23),16))>>>8,t[9]=e&255,t[10]=(e=parseInt(i.slice(24,36),16))/1099511627776&255,t[11]=e/4294967296&255,t[12]=e>>>24&255,t[13]=e>>>16&255,t[14]=e>>>8&255,t[15]=e&255,t}var VE=FE;Cs.default=VE});var np=p(Mr=>{"use strict";Object.defineProperty(Mr,"__esModule",{value:!0});Mr.URL=Mr.DNS=void 0;Mr.default=JE;var UE=fn(),WE=HE(ip());function HE(i){return i&&i.__esModule?i:{default:i}}function KE(i){i=unescape(encodeURIComponent(i));let e=[];for(let t=0;t<i.length;++t)e.push(i.charCodeAt(t));return e}var Tg="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Mr.DNS=Tg;var Og="6ba7b811-9dad-11d1-80b4-00c04fd430c8";Mr.URL=Og;function JE(i,e,t){function r(n,s,o,a){var c;if(typeof n=="string"&&(n=KE(n)),typeof s=="string"&&(s=(0,WE.default)(s)),((c=s)===null||c===void 0?void 0:c.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+n.length);if(u.set(s),u.set(n,s.length),u=t(u),u[6]=u[6]&15|e,u[8]=u[8]&63|128,o){a=a||0;for(let l=0;l<16;++l)o[a+l]=u[l];return o}return(0,UE.unsafeStringify)(u)}try{r.name=i}catch{}return r.DNS=Tg,r.URL=Og,r}});var Mg=p(Rs=>{"use strict";Object.defineProperty(Rs,"__esModule",{value:!0});Rs.default=void 0;function GE(i){if(typeof i=="string"){let e=unescape(encodeURIComponent(i));i=new Uint8Array(e.length);for(let t=0;t<e.length;++t)i[t]=e.charCodeAt(t)}return $E(QE(XE(i),i.length*8))}function $E(i){let e=[],t=i.length*32,r="0123456789abcdef";for(let n=0;n<t;n+=8){let s=i[n>>5]>>>n%32&255,o=parseInt(r.charAt(s>>>4&15)+r.charAt(s&15),16);e.push(o)}return e}function kg(i){return(i+64>>>9<<4)+14+1}function QE(i,e){i[e>>5]|=128<<e%32,i[kg(e)-1]=e;let t=1732584193,r=-271733879,n=-1732584194,s=271733878;for(let o=0;o<i.length;o+=16){let a=t,c=r,u=n,l=s;t=Pe(t,r,n,s,i[o],7,-680876936),s=Pe(s,t,r,n,i[o+1],12,-389564586),n=Pe(n,s,t,r,i[o+2],17,606105819),r=Pe(r,n,s,t,i[o+3],22,-1044525330),t=Pe(t,r,n,s,i[o+4],7,-176418897),s=Pe(s,t,r,n,i[o+5],12,1200080426),n=Pe(n,s,t,r,i[o+6],17,-1473231341),r=Pe(r,n,s,t,i[o+7],22,-45705983),t=Pe(t,r,n,s,i[o+8],7,1770035416),s=Pe(s,t,r,n,i[o+9],12,-1958414417),n=Pe(n,s,t,r,i[o+10],17,-42063),r=Pe(r,n,s,t,i[o+11],22,-1990404162),t=Pe(t,r,n,s,i[o+12],7,1804603682),s=Pe(s,t,r,n,i[o+13],12,-40341101),n=Pe(n,s,t,r,i[o+14],17,-1502002290),r=Pe(r,n,s,t,i[o+15],22,1236535329),t=Re(t,r,n,s,i[o+1],5,-165796510),s=Re(s,t,r,n,i[o+6],9,-1069501632),n=Re(n,s,t,r,i[o+11],14,643717713),r=Re(r,n,s,t,i[o],20,-373897302),t=Re(t,r,n,s,i[o+5],5,-701558691),s=Re(s,t,r,n,i[o+10],9,38016083),n=Re(n,s,t,r,i[o+15],14,-660478335),r=Re(r,n,s,t,i[o+4],20,-405537848),t=Re(t,r,n,s,i[o+9],5,568446438),s=Re(s,t,r,n,i[o+14],9,-1019803690),n=Re(n,s,t,r,i[o+3],14,-187363961),r=Re(r,n,s,t,i[o+8],20,1163531501),t=Re(t,r,n,s,i[o+13],5,-1444681467),s=Re(s,t,r,n,i[o+2],9,-51403784),n=Re(n,s,t,r,i[o+7],14,1735328473),r=Re(r,n,s,t,i[o+12],20,-1926607734),t=Ee(t,r,n,s,i[o+5],4,-378558),s=Ee(s,t,r,n,i[o+8],11,-2022574463),n=Ee(n,s,t,r,i[o+11],16,1839030562),r=Ee(r,n,s,t,i[o+14],23,-35309556),t=Ee(t,r,n,s,i[o+1],4,-1530992060),s=Ee(s,t,r,n,i[o+4],11,1272893353),n=Ee(n,s,t,r,i[o+7],16,-155497632),r=Ee(r,n,s,t,i[o+10],23,-1094730640),t=Ee(t,r,n,s,i[o+13],4,681279174),s=Ee(s,t,r,n,i[o],11,-358537222),n=Ee(n,s,t,r,i[o+3],16,-722521979),r=Ee(r,n,s,t,i[o+6],23,76029189),t=Ee(t,r,n,s,i[o+9],4,-640364487),s=Ee(s,t,r,n,i[o+12],11,-421815835),n=Ee(n,s,t,r,i[o+15],16,530742520),r=Ee(r,n,s,t,i[o+2],23,-995338651),t=_e(t,r,n,s,i[o],6,-198630844),s=_e(s,t,r,n,i[o+7],10,1126891415),n=_e(n,s,t,r,i[o+14],15,-1416354905),r=_e(r,n,s,t,i[o+5],21,-57434055),t=_e(t,r,n,s,i[o+12],6,1700485571),s=_e(s,t,r,n,i[o+3],10,-1894986606),n=_e(n,s,t,r,i[o+10],15,-1051523),r=_e(r,n,s,t,i[o+1],21,-2054922799),t=_e(t,r,n,s,i[o+8],6,1873313359),s=_e(s,t,r,n,i[o+15],10,-30611744),n=_e(n,s,t,r,i[o+6],15,-1560198380),r=_e(r,n,s,t,i[o+13],21,1309151649),t=_e(t,r,n,s,i[o+4],6,-145523070),s=_e(s,t,r,n,i[o+11],10,-1120210379),n=_e(n,s,t,r,i[o+2],15,718787259),r=_e(r,n,s,t,i[o+9],21,-343485551),t=or(t,a),r=or(r,c),n=or(n,u),s=or(s,l)}return[t,r,n,s]}function XE(i){if(i.length===0)return[];let e=i.length*8,t=new Uint32Array(kg(e));for(let r=0;r<e;r+=8)t[r>>5]|=(i[r/8]&255)<<r%32;return t}function or(i,e){let t=(i&65535)+(e&65535);return(i>>16)+(e>>16)+(t>>16)<<16|t&65535}function ZE(i,e){return i<<e|i>>>32-e}function Ps(i,e,t,r,n,s){return or(ZE(or(or(e,i),or(r,s)),n),t)}function Pe(i,e,t,r,n,s,o){return Ps(e&t|~e&r,i,e,n,s,o)}function Re(i,e,t,r,n,s,o){return Ps(e&r|t&~r,i,e,n,s,o)}function Ee(i,e,t,r,n,s,o){return Ps(e^t^r,i,e,n,s,o)}function _e(i,e,t,r,n,s,o){return Ps(t^(e|~r),i,e,n,s,o)}var YE=GE;Rs.default=YE});var xg=p(Es=>{"use strict";Object.defineProperty(Es,"__esModule",{value:!0});Es.default=void 0;var e_=Dg(np()),t_=Dg(Mg());function Dg(i){return i&&i.__esModule?i:{default:i}}var r_=(0,e_.default)("v3",48,t_.default),i_=r_;Es.default=i_});var Ng=p(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});_s.default=void 0;var n_=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),s_={randomUUID:n_};_s.default=s_});var zg=p(Is=>{"use strict";Object.defineProperty(Is,"__esModule",{value:!0});Is.default=void 0;var qg=jg(Ng()),o_=jg(Yu()),a_=fn();function jg(i){return i&&i.__esModule?i:{default:i}}function c_(i,e,t){if(qg.default.randomUUID&&!e&&!i)return qg.default.randomUUID();i=i||{};let r=i.random||(i.rng||o_.default)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){t=t||0;for(let n=0;n<16;++n)e[t+n]=r[n];return e}return(0,a_.unsafeStringify)(r)}var u_=c_;Is.default=u_});var Lg=p(ws=>{"use strict";Object.defineProperty(ws,"__esModule",{value:!0});ws.default=void 0;function p_(i,e,t,r){switch(i){case 0:return e&t^~e&r;case 1:return e^t^r;case 2:return e&t^e&r^t&r;case 3:return e^t^r}}function sp(i,e){return i<<e|i>>>32-e}function l_(i){let e=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof i=="string"){let o=unescape(encodeURIComponent(i));i=[];for(let a=0;a<o.length;++a)i.push(o.charCodeAt(a))}else Array.isArray(i)||(i=Array.prototype.slice.call(i));i.push(128);let r=i.length/4+2,n=Math.ceil(r/16),s=new Array(n);for(let o=0;o<n;++o){let a=new Uint32Array(16);for(let c=0;c<16;++c)a[c]=i[o*64+c*4]<<24|i[o*64+c*4+1]<<16|i[o*64+c*4+2]<<8|i[o*64+c*4+3];s[o]=a}s[n-1][14]=(i.length-1)*8/Math.pow(2,32),s[n-1][14]=Math.floor(s[n-1][14]),s[n-1][15]=(i.length-1)*8&4294967295;for(let o=0;o<n;++o){let a=new Uint32Array(80);for(let g=0;g<16;++g)a[g]=s[o][g];for(let g=16;g<80;++g)a[g]=sp(a[g-3]^a[g-8]^a[g-14]^a[g-16],1);let c=t[0],u=t[1],l=t[2],h=t[3],d=t[4];for(let g=0;g<80;++g){let M=Math.floor(g/20),D=sp(c,5)+p_(M,u,l,h)+d+e[M]+a[g]>>>0;d=h,h=l,l=sp(u,30)>>>0,u=c,c=D}t[0]=t[0]+c>>>0,t[1]=t[1]+u>>>0,t[2]=t[2]+l>>>0,t[3]=t[3]+h>>>0,t[4]=t[4]+d>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}var h_=l_;ws.default=h_});var Fg=p(bs=>{"use strict";Object.defineProperty(bs,"__esModule",{value:!0});bs.default=void 0;var d_=Bg(np()),v_=Bg(Lg());function Bg(i){return i&&i.__esModule?i:{default:i}}var f_=(0,d_.default)("v5",80,v_.default),g_=f_;bs.default=g_});var Vg=p(As=>{"use strict";Object.defineProperty(As,"__esModule",{value:!0});As.default=void 0;var m_="00000000-0000-0000-0000-000000000000";As.default=m_});var Ug=p(Ts=>{"use strict";Object.defineProperty(Ts,"__esModule",{value:!0});Ts.default=void 0;var y_=S_(dn());function S_(i){return i&&i.__esModule?i:{default:i}}function C_(i){if(!(0,y_.default)(i))throw TypeError("Invalid UUID");return parseInt(i.slice(14,15),16)}var P_=C_;Ts.default=P_});var Wg=p(ut=>{"use strict";Object.defineProperty(ut,"__esModule",{value:!0});Object.defineProperty(ut,"NIL",{enumerable:!0,get:function(){return w_.default}});Object.defineProperty(ut,"parse",{enumerable:!0,get:function(){return O_.default}});Object.defineProperty(ut,"stringify",{enumerable:!0,get:function(){return T_.default}});Object.defineProperty(ut,"v1",{enumerable:!0,get:function(){return R_.default}});Object.defineProperty(ut,"v3",{enumerable:!0,get:function(){return E_.default}});Object.defineProperty(ut,"v4",{enumerable:!0,get:function(){return __.default}});Object.defineProperty(ut,"v5",{enumerable:!0,get:function(){return I_.default}});Object.defineProperty(ut,"validate",{enumerable:!0,get:function(){return A_.default}});Object.defineProperty(ut,"version",{enumerable:!0,get:function(){return b_.default}});var R_=Vt(Ag()),E_=Vt(xg()),__=Vt(zg()),I_=Vt(Fg()),w_=Vt(Vg()),b_=Vt(Ug()),A_=Vt(dn()),T_=Vt(fn()),O_=Vt(ip());function Vt(i){return i&&i.__esModule?i:{default:i}}});var ar=p(mi=>{"use strict";Object.defineProperty(mi,"__esModule",{value:!0});mi.createNoDashGuid=mi.createGuid=void 0;var k_=Wg(),Hg=()=>k_.v4();mi.createGuid=Hg;var M_=()=>Hg().replace(new RegExp("-","g"),"").toUpperCase();mi.createNoDashGuid=M_});var yi=p(Dr=>{"use strict";Object.defineProperty(Dr,"__esModule",{value:!0});Dr.PlatformEvent=Dr.EventType=void 0;var D_=ar(),x_;(function(i){i[i.Debug=0]="Debug",i[i.Info=1]="Info",i[i.Warning=2]="Warning",i[i.Error=3]="Error",i[i.None=4]="None"})(x_=Dr.EventType||(Dr.EventType={}));var op=class{constructor(e,t){this.privName=e,this.privEventId=D_.createNoDashGuid(),this.privEventTime=new Date().toISOString(),this.privEventType=t,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}};Dr.PlatformEvent=op});var gp=p($=>{"use strict";Object.defineProperty($,"__esModule",{value:!0});$.AudioStreamNodeErrorEvent=$.AudioStreamNodeDetachedEvent=$.AudioStreamNodeAttachedEvent=$.AudioStreamNodeAttachingEvent=$.AudioStreamNodeEvent=$.AudioSourceErrorEvent=$.AudioSourceOffEvent=$.AudioSourceReadyEvent=$.AudioSourceInitializingEvent=$.AudioSourceEvent=void 0;var ap=yi(),cr=class extends ap.PlatformEvent{constructor(e,t,r=ap.EventType.Info){super(e,r),this.privAudioSourceId=t}get audioSourceId(){return this.privAudioSourceId}};$.AudioSourceEvent=cr;var cp=class extends cr{constructor(e){super("AudioSourceInitializingEvent",e)}};$.AudioSourceInitializingEvent=cp;var up=class extends cr{constructor(e){super("AudioSourceReadyEvent",e)}};$.AudioSourceReadyEvent=up;var pp=class extends cr{constructor(e){super("AudioSourceOffEvent",e)}};$.AudioSourceOffEvent=pp;var lp=class extends cr{constructor(e,t){super("AudioSourceErrorEvent",e,ap.EventType.Error),this.privError=t}get error(){return this.privError}};$.AudioSourceErrorEvent=lp;var xr=class extends cr{constructor(e,t,r){super(e,t),this.privAudioNodeId=r}get audioNodeId(){return this.privAudioNodeId}};$.AudioStreamNodeEvent=xr;var hp=class extends xr{constructor(e,t){super("AudioStreamNodeAttachingEvent",e,t)}};$.AudioStreamNodeAttachingEvent=hp;var dp=class extends xr{constructor(e,t){super("AudioStreamNodeAttachedEvent",e,t)}};$.AudioStreamNodeAttachedEvent=dp;var vp=class extends xr{constructor(e,t){super("AudioStreamNodeDetachedEvent",e,t)}};$.AudioStreamNodeDetachedEvent=vp;var fp=class extends xr{constructor(e,t,r){super("AudioStreamNodeErrorEvent",e,t),this.privError=r}get error(){return this.privError}};$.AudioStreamNodeErrorEvent=fp});var Kg=p(te=>{"use strict";Object.defineProperty(te,"__esModule",{value:!0});te.ConnectionMessageSentEvent=te.ConnectionMessageReceivedEvent=te.ConnectionEstablishErrorEvent=te.ConnectionErrorEvent=te.ConnectionClosedEvent=te.ConnectionEstablishedEvent=te.ConnectionStartEvent=te.ConnectionEvent=te.ServiceEvent=void 0;var Nr=yi(),mp=class extends Nr.PlatformEvent{constructor(e,t,r=Nr.EventType.Info){super(e,r),this.privJsonResult=t}get jsonString(){return this.privJsonResult}};te.ServiceEvent=mp;var Rt=class extends Nr.PlatformEvent{constructor(e,t,r=Nr.EventType.Info){super(e,r),this.privConnectionId=t}get connectionId(){return this.privConnectionId}};te.ConnectionEvent=Rt;var yp=class extends Rt{constructor(e,t,r){super("ConnectionStartEvent",e),this.privUri=t,this.privHeaders=r}get uri(){return this.privUri}get headers(){return this.privHeaders}};te.ConnectionStartEvent=yp;var Sp=class extends Rt{constructor(e){super("ConnectionEstablishedEvent",e)}};te.ConnectionEstablishedEvent=Sp;var Cp=class extends Rt{constructor(e,t,r){super("ConnectionClosedEvent",e,Nr.EventType.Debug),this.privReason=r,this.privStatusCode=t}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}};te.ConnectionClosedEvent=Cp;var Pp=class extends Rt{constructor(e,t,r){super("ConnectionErrorEvent",e,Nr.EventType.Debug),this.privMessage=t,this.privType=r}get message(){return this.privMessage}get type(){return this.privType}};te.ConnectionErrorEvent=Pp;var Rp=class extends Rt{constructor(e,t,r){super("ConnectionEstablishErrorEvent",e,Nr.EventType.Error),this.privStatusCode=t,this.privReason=r}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}};te.ConnectionEstablishErrorEvent=Rp;var Ep=class extends Rt{constructor(e,t,r){super("ConnectionMessageReceivedEvent",e),this.privNetworkReceivedTime=t,this.privMessage=r}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}};te.ConnectionMessageReceivedEvent=Ep;var _p=class extends Rt{constructor(e,t,r){super("ConnectionMessageSentEvent",e),this.privNetworkSentTime=t,this.privMessage=r}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}};te.ConnectionMessageSentEvent=_p});var pt=p(ur=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});ur.ObjectDisposedError=ur.InvalidOperationError=ur.ArgumentNullError=void 0;var Ip=class extends Error{constructor(e){super(e),this.name="ArgumentNull",this.message=e}};ur.ArgumentNullError=Ip;var wp=class extends Error{constructor(e){super(e),this.name="InvalidOperation",this.message=e}};ur.InvalidOperationError=wp;var bp=class extends Error{constructor(e,t){super(t),this.name=e+"ObjectDisposed",this.message=t}};ur.ObjectDisposedError=bp});var Tp=p(jr=>{"use strict";Object.defineProperty(jr,"__esModule",{value:!0});jr.ConnectionMessage=jr.MessageType=void 0;var Os=pt(),N_=ar(),qr;(function(i){i[i.Text=0]="Text",i[i.Binary=1]="Binary"})(qr=jr.MessageType||(jr.MessageType={}));var Ap=class{constructor(e,t,r,n){if(this.privBody=null,e===qr.Text&&t&&typeof t!="string")throw new Os.InvalidOperationError("Payload must be a string");if(e===qr.Binary&&t&&!(t instanceof ArrayBuffer))throw new Os.InvalidOperationError("Payload must be ArrayBuffer");switch(this.privMessageType=e,this.privBody=t,this.privHeaders=r||{},this.privId=n||N_.createNoDashGuid(),this.messageType){case qr.Binary:this.privSize=this.binaryBody!==null?this.binaryBody.byteLength:0;break;case qr.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===qr.Binary)throw new Os.InvalidOperationError("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===qr.Text)throw new Os.InvalidOperationError("Not supported for text message");return this.privBody}get id(){return this.privId}};jr.ConnectionMessage=Ap});var Jg=p(ks=>{"use strict";Object.defineProperty(ks,"__esModule",{value:!0});ks.ConnectionOpenResponse=void 0;var Op=class{constructor(e,t){this.privStatusCode=e,this.privReason=t}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}};ks.ConnectionOpenResponse=Op});var Gg=p(Ms=>{"use strict";Object.defineProperty(Ms,"__esModule",{value:!0});Ms.DeferralMap=void 0;var kp=class{constructor(){this.privMap={}}add(e,t){this.privMap[e]=t}getId(e){return this.privMap[e]}complete(e,t){try{this.privMap[e].resolve(t)}catch(r){this.privMap[e].reject(r)}finally{this.privMap[e]=void 0}}};Ms.DeferralMap=kp});var Dp=p(Si=>{"use strict";Object.defineProperty(Si,"__esModule",{value:!0});Si.SendingAgentContextMessageEvent=Si.DialogEvent=void 0;var $g=yi(),Ds=class extends $g.PlatformEvent{constructor(e,t=$g.EventType.Info){super(e,t)}};Si.DialogEvent=Ds;var Mp=class extends Ds{constructor(e){super("SendingAgentContextMessageEvent"),this.privAgentConfig=e}get agentConfig(){return this.privAgentConfig}};Si.SendingAgentContextMessageEvent=Mp});var Np=p(xs=>{"use strict";Object.defineProperty(xs,"__esModule",{value:!0});xs.EventSource=void 0;var q_=pt(),j_=ar(),xp=class{constructor(e){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=e}onEvent(e){if(this.isDisposed())throw new q_.ObjectDisposedError("EventSource");if(this.metadata)for(let t in this.metadata)t&&e.metadata&&(e.metadata[t]||(e.metadata[t]=this.metadata[t]));for(let t in this.privEventListeners)t&&this.privEventListeners[t]&&this.privEventListeners[t](e)}attach(e){let t=j_.createNoDashGuid();return this.privEventListeners[t]=e,{detach:()=>(delete this.privEventListeners[t],Promise.resolve())}}attachListener(e){return this.attach(t=>e.onEvent(t))}attachConsoleListener(e){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach(t=>e.onEvent(t)),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}};xs.EventSource=xp});var Qg=p(qs=>{"use strict";Object.defineProperty(qs,"__esModule",{value:!0});qs.Events=void 0;var z_=pt(),L_=Np(),Ns=class i{static setEventSource(e){if(!e)throw new z_.ArgumentNullError("eventSource");i.privInstance=e}static get instance(){return i.privInstance}};qs.Events=Ns;Ns.privInstance=new L_.EventSource});var Zg=p(Xg=>{"use strict";Object.defineProperty(Xg,"__esModule",{value:!0})});var Yg=p(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});gn.ConnectionState=void 0;var B_;(function(i){i[i.None=0]="None",i[i.Connected=1]="Connected",i[i.Connecting=2]="Connecting",i[i.Disconnected=3]="Disconnected"})(B_=gn.ConnectionState||(gn.ConnectionState={}))});var tm=p(em=>{"use strict";Object.defineProperty(em,"__esModule",{value:!0})});var im=p(rm=>{"use strict";Object.defineProperty(rm,"__esModule",{value:!0})});var sm=p(nm=>{"use strict";Object.defineProperty(nm,"__esModule",{value:!0})});var am=p(om=>{"use strict";Object.defineProperty(om,"__esModule",{value:!0})});var um=p(cm=>{"use strict";Object.defineProperty(cm,"__esModule",{value:!0})});var lm=p(pm=>{"use strict";Object.defineProperty(pm,"__esModule",{value:!0})});var dm=p(hm=>{"use strict";Object.defineProperty(hm,"__esModule",{value:!0})});var fm=p(vm=>{"use strict";Object.defineProperty(vm,"__esModule",{value:!0})});var jp=p(js=>{"use strict";Object.defineProperty(js,"__esModule",{value:!0});js.List=void 0;var F_=pt(),qp=class i{constructor(e){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],e)for(let t of e)this.privList.push(t)}get(e){return this.throwIfDisposed(),this.privList[e]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(e){this.throwIfDisposed(),this.insertAt(this.privList.length,e)}insertAt(e,t){this.throwIfDisposed(),e===0?this.privList.unshift(t):e===this.privList.length?this.privList.push(t):this.privList.splice(e,0,t),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(e){return this.throwIfDisposed(),this.remove(e,1)[0]}remove(e,t){this.throwIfDisposed();let r=this.privList.splice(e,t);return this.triggerSubscriptions(this.privRemoveSubscriptions),r}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(e){this.throwIfDisposed();let t=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[t]=e,{detach:()=>(delete this.privAddSubscriptions[t],Promise.resolve())}}onRemoved(e){this.throwIfDisposed();let t=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[t]=e,{detach:()=>(delete this.privRemoveSubscriptions[t],Promise.resolve())}}onDisposed(e){this.throwIfDisposed();let t=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[t]=e,{detach:()=>(delete this.privDisposedSubscriptions[t],Promise.resolve())}}join(e){return this.throwIfDisposed(),this.privList.join(e)}toArray(){let e=Array();return this.privList.forEach(t=>{e.push(t)}),e}any(e){return this.throwIfDisposed(),e?this.where(e).length()>0:this.length()>0}all(e){return this.throwIfDisposed(),this.where(e).length()===this.length()}forEach(e){this.throwIfDisposed();for(let t=0;t<this.length();t++)e(this.privList[t],t)}select(e){this.throwIfDisposed();let t=[];for(let r=0;r<this.privList.length;r++)t.push(e(this.privList[r],r));return new i(t)}where(e){this.throwIfDisposed();let t=new i;for(let r=0;r<this.privList.length;r++)e(this.privList[r],r)&&t.add(this.privList[r]);return t}orderBy(e){this.throwIfDisposed();let r=this.toArray().sort(e);return new i(r)}orderByDesc(e){return this.throwIfDisposed(),this.orderBy((t,r)=>e(r,t))}clone(){return this.throwIfDisposed(),new i(this.toArray())}concat(e){return this.throwIfDisposed(),new i(this.privList.concat(e.toArray()))}concatArray(e){return this.throwIfDisposed(),new i(this.privList.concat(e))}isDisposed(){return this.privList==null}dispose(e){this.isDisposed()||(this.privDisposeReason=e,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new F_.ObjectDisposedError("List",this.privDisposeReason)}triggerSubscriptions(e){if(e)for(let t in e)t&&e[t]()}};js.List=qp});var Bp=p(Oe=>{"use strict";Object.defineProperty(Oe,"__esModule",{value:!0});Oe.marshalPromiseToCallbacks=Oe.Sink=Oe.Deferred=Oe.PromiseResultEventSource=Oe.PromiseResult=Oe.PromiseState=void 0;var Ut;(function(i){i[i.None=0]="None",i[i.Resolved=1]="Resolved",i[i.Rejected=2]="Rejected"})(Ut=Oe.PromiseState||(Oe.PromiseState={}));var zs=class{constructor(e){this.throwIfError=()=>{if(this.isError)throw this.error},e.on(t=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!1,this.privResult=t)},t=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!0,this.privError=t)})}get isCompleted(){return this.privIsCompleted}get isError(){return this.privIsError}get error(){return this.privError}get result(){return this.privResult}};Oe.PromiseResult=zs;var Ls=class{constructor(){this.setResult=e=>{this.privOnSetResult(e)},this.setError=e=>{this.privOnSetError(e)},this.on=(e,t)=>{this.privOnSetResult=e,this.privOnSetError=t}}};Oe.PromiseResultEventSource=Ls;var zp=class{constructor(){this.resolve=e=>(this.privResolve(e),this),this.reject=e=>(this.privReject(e),this),this.privPromise=new Promise((e,t)=>{this.privResolve=e,this.privReject=t})}get promise(){return this.privPromise}};Oe.Deferred=zp;var Lp=class{constructor(){this.privState=Ut.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.privPromiseResultEvents=new Ls,this.privPromiseResult=new zs(this.privPromiseResultEvents)}get state(){return this.privState}get result(){return this.privPromiseResult}resolve(e){if(this.privState!==Ut.None)throw new Error("'Cannot resolve a completed promise'");this.privState=Ut.Resolved,this.privPromiseResultEvents.setResult(e);for(let t=0;t<this.privSuccessHandlers.length;t++)this.executeSuccessCallback(e,this.privSuccessHandlers[t],this.privErrorHandlers[t]);this.detachHandlers()}reject(e){if(this.privState!==Ut.None)throw new Error("'Cannot reject a completed promise'");this.privState=Ut.Rejected,this.privPromiseResultEvents.setError(e);for(let t of this.privErrorHandlers)this.executeErrorCallback(e,t);this.detachHandlers()}on(e,t){e==null&&(e=()=>{}),this.privState===Ut.None?(this.privSuccessHandlers.push(e),this.privErrorHandlers.push(t)):(this.privState===Ut.Resolved?this.executeSuccessCallback(this.privPromiseResult.result,e,t):this.privState===Ut.Rejected&&this.executeErrorCallback(this.privPromiseResult.error,t),this.detachHandlers())}executeSuccessCallback(e,t,r){try{t(e)}catch(n){this.executeErrorCallback(`'Unhandled callback error: ${n}'`,r)}}executeErrorCallback(e,t){if(t)try{t(e)}catch(r){throw new Error(`'Unhandled callback error: ${r}. InnerError: ${e}'`)}else throw new Error(`'Unhandled error: ${e}'`)}detachHandlers(){this.privErrorHandlers=[],this.privSuccessHandlers=[]}};Oe.Sink=Lp;function V_(i,e,t){i.then(r=>{try{e&&e(r)}catch(n){if(t)try{if(n instanceof Error){let s=n;t(s.name+": "+s.message)}else t(n)}catch{}}},r=>{if(t)try{if(r instanceof Error){let n=r;t(n.name+": "+n.message)}else t(r)}catch{}})}Oe.marshalPromiseToCallbacks=V_});var Wp=p(Bs=>{"use strict";Object.defineProperty(Bs,"__esModule",{value:!0});Bs.Queue=void 0;var Fp=pt(),Vp=jp(),gm=Bp(),mn;(function(i){i[i.Dequeue=0]="Dequeue",i[i.Peek=1]="Peek"})(mn||(mn={}));var Up=class{constructor(e){this.privPromiseStore=new Vp.List,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=e||new Vp.List,this.privDetachables=[],this.privSubscribers=new Vp.List,this.privDetachables.push(this.privList.onAdded(()=>this.drain()))}enqueue(e){this.throwIfDispose(),this.enqueueFromPromise(new Promise(t=>t(e)))}enqueueFromPromise(e){this.throwIfDispose(),e.then(t=>{this.privList.add(t)},()=>{})}dequeue(){this.throwIfDispose();let e=new gm.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:mn.Dequeue}),this.drain()),e.promise}peek(){this.throwIfDispose();let e=new gm.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:mn.Peek}),this.drain()),e.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return this.privSubscribers==null}async drainAndDispose(e,t){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=t,this.privIsDisposing=!0;let r=this.privSubscribers;if(r){for(;r.length()>0;)r.removeFirst().deferral.resolve(void 0);this.privSubscribers===r&&(this.privSubscribers=r)}for(let n of this.privDetachables)await n.detach();if(this.privPromiseStore.length()>0&&e){let n=[];return this.privPromiseStore.toArray().forEach(s=>{n.push(s)}),Promise.all(n).finally(()=>{this.privSubscribers=null,this.privList.forEach(s=>{e(s)}),this.privList=null}).then()}else this.privSubscribers=null,this.privList=null}}async dispose(e){await this.drainAndDispose(null,e)}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;let e=this.privSubscribers,t=this.privList;if(e&&t){for(;t.length()>0&&e.length()>0&&!this.privIsDisposing;){let r=e.removeFirst();if(r.type===mn.Peek)r.deferral.resolve(t.first());else{let n=t.removeFirst();r.deferral.resolve(n)}}this.privSubscribers===e&&(this.privSubscribers=e),this.privList===t&&(this.privList=t)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed())throw this.privDisposeReason?new Fp.InvalidOperationError(this.privDisposeReason):new Fp.ObjectDisposedError("Queue");if(this.privIsDisposing)throw new Fp.InvalidOperationError("Queue disposing")}};Bs.Queue=Up});var mm=p(Vs=>{"use strict";Object.defineProperty(Vs,"__esModule",{value:!0});Vs.RawWebsocketMessage=void 0;var Fs=Tp(),yn=pt(),U_=ar(),Hp=class{constructor(e,t,r){if(this.privPayload=null,!t)throw new yn.ArgumentNullError("payload");if(e===Fs.MessageType.Binary&&Object.getPrototypeOf(t).constructor.name!=="ArrayBuffer")throw new yn.InvalidOperationError("Payload must be ArrayBuffer");if(e===Fs.MessageType.Text&&typeof t!="string")throw new yn.InvalidOperationError("Payload must be a string");this.privMessageType=e,this.privPayload=t,this.privId=r||U_.createNoDashGuid()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===Fs.MessageType.Binary)throw new yn.InvalidOperationError("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===Fs.MessageType.Text)throw new yn.InvalidOperationError("Not supported for text message");return this.privPayload}get id(){return this.privId}};Vs.RawWebsocketMessage=Hp});var ym=p(Us=>{"use strict";Object.defineProperty(Us,"__esModule",{value:!0});Us.RiffPcmEncoder=void 0;var Kp=class{constructor(e,t){this.privActualSampleRate=e,this.privDesiredSampleRate=t}encode(e){let t=this.downSampleAudioFrame(e,this.privActualSampleRate,this.privDesiredSampleRate);if(!t)return null;let r=t.length*2,n=new ArrayBuffer(r),s=new DataView(n);return this.floatTo16BitPCM(s,0,t),n}setString(e,t,r){for(let n=0;n<r.length;n++)e.setUint8(t+n,r.charCodeAt(n))}floatTo16BitPCM(e,t,r){for(let n=0;n<r.length;n++,t+=2){let s=Math.max(-1,Math.min(1,r[n]));e.setInt16(t,s<0?s*32768:s*32767,!0)}}downSampleAudioFrame(e,t,r){if(!e)return null;if(r===t||r>t)return e;let n=t/r,s=Math.round(e.length/n),o=new Float32Array(s),a=0,c=0;for(;c<s;){let u=Math.round((c+1)*n),l=0,h=0;for(;a<u&&a<e.length;)l+=e[a++],h++;o[c++]=l/h}return o}};Us.RiffPcmEncoder=Kp});var Pm=p(Ws=>{"use strict";Object.defineProperty(Ws,"__esModule",{value:!0});Ws.Stream=void 0;var Sm=pt(),W_=ar(),Cm=Wp(),Jp=class{constructor(e){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=e||W_.createNoDashGuid(),this.privReaderQueue=new Cm.Queue}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(e){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(e)}catch{}}read(){if(this.privIsReadEnded)throw new Sm.InvalidOperationError("Stream read has already finished");return this.privReaderQueue.dequeue().then(async e=>((e===void 0||e.isEnd)&&await this.privReaderQueue.dispose("End of stream reached"),e))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new Cm.Queue)}throwIfClosed(){if(this.privIsWriteEnded)throw new Sm.InvalidOperationError("Stream closed")}};Ws.Stream=Jp});var Hs=p(Sn=>{"use strict";Object.defineProperty(Sn,"__esModule",{value:!0});Sn.TranslationStatus=void 0;var H_;(function(i){i[i.Success=0]="Success",i[i.Error=1]="Error"})(H_=Sn.TranslationStatus||(Sn.TranslationStatus={}))});var Rm=p(Ks=>{"use strict";Object.defineProperty(Ks,"__esModule",{value:!0});Ks.ChunkedArrayBufferStream=void 0;var K_=P(),Gp=class extends K_.Stream{constructor(e,t){super(t),this.privTargetChunkSize=e,this.privNextBufferReadyBytes=0}writeStreamChunk(e){if(e.isEnd||this.privNextBufferReadyBytes===0&&e.buffer.byteLength===this.privTargetChunkSize){super.writeStreamChunk(e);return}let t=0;for(;t<e.buffer.byteLength;){this.privNextBufferToWrite===void 0&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=e.timeReceived);let r=Math.min(e.buffer.byteLength-t,this.privTargetChunkSize-this.privNextBufferReadyBytes),n=new Uint8Array(this.privNextBufferToWrite),s=new Uint8Array(e.buffer.slice(t,r+t));n.set(s,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=r,t+=r,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){this.privNextBufferReadyBytes!==0&&!this.isClosed&&super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}};Ks.ChunkedArrayBufferStream=Gp});var _m=p(Em=>{"use strict";Object.defineProperty(Em,"__esModule",{value:!0})});var Im=p(Js=>{"use strict";Object.defineProperty(Js,"__esModule",{value:!0});Js.Timeout=void 0;var Et=class i{static load(){let e=new Map([[0,()=>{}]]),t=new Map,n="data:text/javascript;base64,"+btoa(`!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error('There is no interval scheduled with the given id "'.concat(e,'".'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error('The given method "'.concat(e.method,'" is not supported'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);`),s=new Worker(n);return s.addEventListener("message",({data:c})=>{if(i.isCallNotification(c)){let{params:{timerId:u}}=c,l=e.get(u);if(typeof l=="number"){let h=t.get(l);if(h===void 0||h!==u)throw new Error("The timer is in an undefined state.")}else if(typeof l<"u")l(),e.delete(u);else throw new Error("The timer is in an undefined state.")}else if(i.isClearResponse(c)){let{id:u}=c,l=t.get(u);if(l===void 0)throw new Error("The timer is in an undefined state.");t.delete(u),e.delete(l)}else{let{error:{message:u}}=c;throw new Error(u)}}),{clearTimeout:c=>{let u=Math.random();t.set(u,c),e.set(c,u),s.postMessage({id:u,method:"clear",params:{timerId:c}})},setTimeout:(c,u)=>{let l=Math.random();return e.set(l,c),s.postMessage({id:null,method:"set",params:{delay:u,now:performance.now(),timerId:l}}),l}}}static loadWorkerTimers(){return()=>(i.workerTimers!==null||(i.workerTimers=i.load()),i.workerTimers)}static isCallNotification(e){return e.method!==void 0&&e.method==="call"}static isClearResponse(e){return e.error===null&&typeof e.id=="number"}};Js.Timeout=Et;Et.workerTimers=null;Et.clearTimeout=i=>Et.timers().clearTimeout(i);Et.setTimeout=(i,e)=>Et.timers().setTimeout(i,e);Et.timers=Et.loadWorkerTimers()});var wm=p(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});O.OCSPCacheUpdateErrorEvent=O.OCSPResponseRetrievedEvent=O.OCSPCacheFetchErrorEvent=O.OCSPVerificationFailedEvent=O.OCSPCacheHitEvent=O.OCSPCacheEntryNeedsRefreshEvent=O.OCSPCacheEntryExpiredEvent=O.OCSPWSUpgradeStartedEvent=O.OCSPStapleReceivedEvent=O.OCSPCacheUpdateCompleteEvent=O.OCSPDiskCacheStoreEvent=O.OCSPMemoryCacheStoreEvent=O.OCSPCacheUpdateNeededEvent=O.OCSPDiskCacheHitEvent=O.OCSPCacheMissEvent=O.OCSPMemoryCacheHitEvent=O.OCSPEvent=void 0;var he=yi(),ae=class extends he.PlatformEvent{constructor(e,t,r){super(e,t),this.privSignature=r}};O.OCSPEvent=ae;var $p=class extends ae{constructor(e){super("OCSPMemoryCacheHitEvent",he.EventType.Debug,e)}};O.OCSPMemoryCacheHitEvent=$p;var Qp=class extends ae{constructor(e){super("OCSPCacheMissEvent",he.EventType.Debug,e)}};O.OCSPCacheMissEvent=Qp;var Xp=class extends ae{constructor(e){super("OCSPDiskCacheHitEvent",he.EventType.Debug,e)}};O.OCSPDiskCacheHitEvent=Xp;var Zp=class extends ae{constructor(e){super("OCSPCacheUpdateNeededEvent",he.EventType.Debug,e)}};O.OCSPCacheUpdateNeededEvent=Zp;var Yp=class extends ae{constructor(e){super("OCSPMemoryCacheStoreEvent",he.EventType.Debug,e)}};O.OCSPMemoryCacheStoreEvent=Yp;var el=class extends ae{constructor(e){super("OCSPDiskCacheStoreEvent",he.EventType.Debug,e)}};O.OCSPDiskCacheStoreEvent=el;var tl=class extends ae{constructor(e){super("OCSPCacheUpdateCompleteEvent",he.EventType.Debug,e)}};O.OCSPCacheUpdateCompleteEvent=tl;var rl=class extends ae{constructor(){super("OCSPStapleReceivedEvent",he.EventType.Debug,"")}};O.OCSPStapleReceivedEvent=rl;var il=class extends ae{constructor(e){super("OCSPWSUpgradeStartedEvent",he.EventType.Debug,e)}};O.OCSPWSUpgradeStartedEvent=il;var nl=class extends ae{constructor(e,t){super("OCSPCacheEntryExpiredEvent",he.EventType.Debug,e),this.privExpireTime=t}};O.OCSPCacheEntryExpiredEvent=nl;var sl=class extends ae{constructor(e,t,r){super("OCSPCacheEntryNeedsRefreshEvent",he.EventType.Debug,e),this.privExpireTime=r,this.privStartTime=t}};O.OCSPCacheEntryNeedsRefreshEvent=sl;var ol=class extends ae{constructor(e,t,r){super("OCSPCacheHitEvent",he.EventType.Debug,e),this.privExpireTime=r,this.privExpireTimeString=new Date(r).toLocaleDateString(),this.privStartTime=t,this.privStartTimeString=new Date(t).toLocaleTimeString()}};O.OCSPCacheHitEvent=ol;var al=class extends ae{constructor(e,t){super("OCSPVerificationFailedEvent",he.EventType.Debug,e),this.privError=t}};O.OCSPVerificationFailedEvent=al;var cl=class extends ae{constructor(e,t){super("OCSPCacheFetchErrorEvent",he.EventType.Debug,e),this.privError=t}};O.OCSPCacheFetchErrorEvent=cl;var ul=class extends ae{constructor(e){super("OCSPResponseRetrievedEvent",he.EventType.Debug,e)}};O.OCSPResponseRetrievedEvent=ul;var pl=class extends ae{constructor(e,t){super("OCSPCacheUpdateErrorEvent",he.EventType.Debug,e),this.privError=t}};O.OCSPCacheUpdateErrorEvent=pl});var Am=p(Gs=>{"use strict";Object.defineProperty(Gs,"__esModule",{value:!0});Gs.BackgroundEvent=void 0;var bm=P(),ll=class extends bm.PlatformEvent{constructor(e){super("BackgroundEvent",bm.EventType.Error),this.privError=e}get error(){return this.privError}};Gs.BackgroundEvent=ll});var P=p(A=>{"use strict";var J_=A&&A.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t),Object.defineProperty(i,r,{enumerable:!0,get:function(){return e[t]}})}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),x=A&&A.__exportStar||function(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&J_(e,i,t)};Object.defineProperty(A,"__esModule",{value:!0});x(gp(),A);x(Kg(),A);x(Tp(),A);x(Jg(),A);x(Gg(),A);x(Dp(),A);x(pt(),A);x(Qg(),A);x(Np(),A);x(ar(),A);x(Zg(),A);x(Yg(),A);x(tm(),A);x(im(),A);x(sm(),A);x(am(),A);x(um(),A);x(lm(),A);x(dm(),A);x(fm(),A);x(jp(),A);x(yi(),A);x(Bp(),A);x(Wp(),A);x(mm(),A);x(ym(),A);x(Pm(),A);var G_=Hs();Object.defineProperty(A,"TranslationStatus",{enumerable:!0,get:function(){return G_.TranslationStatus}});x(Rm(),A);x(_m(),A);x(Im(),A);x(wm(),A);x(Am(),A)});var Ie=p($s=>{"use strict";Object.defineProperty($s,"__esModule",{value:!0});$s.HeaderNames=void 0;var Ve=class{};$s.HeaderNames=Ve;Ve.AuthKey="Ocp-Apim-Subscription-Key";Ve.Authorization="Authorization";Ve.SpIDAuthKey="Apim-Subscription-Id";Ve.ConnectionId="X-ConnectionId";Ve.ContentType="Content-Type";Ve.CustomCommandsAppId="X-CommandsAppId";Ve.Path="Path";Ve.RequestId="X-RequestId";Ve.RequestStreamId="X-StreamId";Ve.RequestTimestamp="X-Timestamp"});var Xs=p(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});Qs.AuthInfo=void 0;var hl=class{constructor(e,t){this.privHeaderName=e,this.privToken=t}get headerName(){return this.privHeaderName}get token(){return this.privToken}};Qs.AuthInfo=hl});var Tm=p(Zs=>{"use strict";Object.defineProperty(Zs,"__esModule",{value:!0});Zs.CognitiveSubscriptionKeyAuthentication=void 0;var $_=P(),Q_=Ie(),X_=Xs(),dl=class{constructor(e){if(!e)throw new $_.ArgumentNullError("subscriptionKey");this.privAuthInfo=new X_.AuthInfo(Q_.HeaderNames.AuthKey,e)}fetch(e){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(e){return Promise.resolve(this.privAuthInfo)}};Zs.CognitiveSubscriptionKeyAuthentication=dl});var Dm=p(eo=>{"use strict";Object.defineProperty(eo,"__esModule",{value:!0});eo.CognitiveTokenAuthentication=void 0;var Om=P(),km=Xs(),Mm=Ie(),Ys=class i{constructor(e,t){if(!e)throw new Om.ArgumentNullError("fetchCallback");if(!t)throw new Om.ArgumentNullError("fetchOnExpiryCallback");this.privFetchCallback=e,this.privFetchOnExpiryCallback=t}fetch(e){return this.privFetchCallback(e).then(t=>new km.AuthInfo(Mm.HeaderNames.Authorization,t===void 0?void 0:i.privTokenPrefix+t))}fetchOnExpiry(e){return this.privFetchOnExpiryCallback(e).then(t=>new km.AuthInfo(Mm.HeaderNames.Authorization,t===void 0?void 0:i.privTokenPrefix+t))}};eo.CognitiveTokenAuthentication=Ys;Ys.privTokenPrefix="Bearer "});var Nm=p(xm=>{"use strict";Object.defineProperty(xm,"__esModule",{value:!0})});var jm=p(qm=>{"use strict";Object.defineProperty(qm,"__esModule",{value:!0})});var vl=p(()=>{});var fl=p(to=>{"use strict";Object.defineProperty(to,"__esModule",{value:!0});to.LogLevel=void 0;var Z_=P();Object.defineProperty(to,"LogLevel",{enumerable:!0,get:function(){return Z_.EventType}})});var _=p(ro=>{"use strict";Object.defineProperty(ro,"__esModule",{value:!0});ro.Contracts=void 0;var gl=class i{static throwIfNullOrUndefined(e,t){if(e==null)throw new Error("throwIfNullOrUndefined:"+t)}static throwIfNull(e,t){if(e===null)throw new Error("throwIfNull:"+t)}static throwIfNullOrWhitespace(e,t){if(i.throwIfNullOrUndefined(e,t),(""+e).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+t)}static throwIfNullOrTooLong(e,t,r){if(i.throwIfNullOrUndefined(e,t),(""+e).length>r)throw new Error("throwIfNullOrTooLong:"+t+" (more than "+r.toString()+" characters)")}static throwIfNullOrTooShort(e,t,r){if(i.throwIfNullOrUndefined(e,t),(""+e).length<r)throw new Error("throwIfNullOrTooShort:"+t+" (less than "+r.toString()+" characters)")}static throwIfDisposed(e){if(e)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(e,t){if(i.throwIfNullOrUndefined(e,t),e.length===0)throw new Error("throwIfArrayEmptyOrWhitespace:"+t);for(let r of e)i.throwIfNullOrWhitespace(r,t)}static throwIfFileDoesNotExist(e,t){i.throwIfNullOrWhitespace(e,t)}static throwIfNotUndefined(e,t){if(e!==void 0)throw new Error("throwIfNotUndefined:"+t)}};ro.Contracts=gl});var Lm=p(_t=>{"use strict";var Y_=_t&&_t.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t),Object.defineProperty(i,r,{enumerable:!0,get:function(){return e[t]}})}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),eI=_t&&_t.__setModuleDefault||(Object.create?function(i,e){Object.defineProperty(i,"default",{enumerable:!0,value:e})}:function(i,e){i.default=e}),tI=_t&&_t.__importStar||function(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)t!=="default"&&Object.hasOwnProperty.call(i,t)&&Y_(e,i,t);return eI(e,i),e};Object.defineProperty(_t,"__esModule",{value:!0});_t.ConsoleLoggingListener=void 0;var zm=tI(vl()),Cn=fl(),rI=_(),ml=class{constructor(e=Cn.LogLevel.None){this.privLogPath=void 0,this.privEnableConsoleOutput=!0,this.privLogLevelFilter=e}set logPath(e){rI.Contracts.throwIfNullOrUndefined(zm.openSync,`
File System access not available`),this.privLogPath=e}set enableConsoleOutput(e){this.privEnableConsoleOutput=e}onEvent(e){if(e.eventType>=this.privLogLevelFilter){let t=this.toString(e);if(this.logCallback&&this.logCallback(t),this.privLogPath&&zm.writeFileSync(this.privLogPath,t+`
`,{flag:"a+"}),this.privEnableConsoleOutput)switch(e.eventType){case Cn.LogLevel.Debug:console.debug(t);break;case Cn.LogLevel.Info:console.info(t);break;case Cn.LogLevel.Warning:console.warn(t);break;case Cn.LogLevel.Error:console.error(t);break;default:console.log(t);break}}}toString(e){let t=[`${e.eventTime}`,`${e.name}`],r=e;for(let n in r)if(n&&e.hasOwnProperty(n)&&n!=="eventTime"&&n!=="eventType"&&n!=="eventId"&&n!=="name"&&n!=="constructor"){let s=r[n],o="<NULL>";s!=null&&(typeof s=="number"||typeof s=="string"?o=s.toString():o=JSON.stringify(s)),t.push(`${n}: ${o}`)}return t.join(" | ")}};_t.ConsoleLoggingListener=ml});var Fm=p(Bm=>{"use strict";Object.defineProperty(Bm,"__esModule",{value:!0})});var pr=p(Wt=>{"use strict";Object.defineProperty(Wt,"__esModule",{value:!0});Wt.AudioStreamFormatImpl=Wt.AudioStreamFormat=Wt.AudioFormatTag=void 0;var Pn;(function(i){i[i.PCM=1]="PCM",i[i.MuLaw=2]="MuLaw",i[i.Siren=3]="Siren",i[i.MP3=4]="MP3",i[i.SILKSkype=5]="SILKSkype",i[i.OGG_OPUS=6]="OGG_OPUS",i[i.WEBM_OPUS=7]="WEBM_OPUS",i[i.ALaw=8]="ALaw",i[i.FLAC=9]="FLAC",i[i.OPUS=10]="OPUS"})(Pn=Wt.AudioFormatTag||(Wt.AudioFormatTag={}));var io=class{static getDefaultInputFormat(){return Ci.getDefaultInputFormat()}static getWaveFormat(e,t,r,n){return new Ci(e,t,r,n)}static getWaveFormatPCM(e,t,r){return new Ci(e,t,r)}};Wt.AudioStreamFormat=io;var Ci=class i extends io{constructor(e=16e3,t=16,r=1,n=Pn.PCM){super();let s=!0;switch(n){case Pn.PCM:this.formatTag=1;break;case Pn.ALaw:this.formatTag=6;break;case Pn.MuLaw:this.formatTag=7;break;default:s=!1}if(this.bitsPerSample=t,this.samplesPerSec=e,this.channels=r,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),s){this.privHeader=new ArrayBuffer(44);let o=new DataView(this.privHeader);this.setString(o,0,"RIFF"),o.setUint32(4,0,!0),this.setString(o,8,"WAVEfmt "),o.setUint32(16,16,!0),o.setUint16(20,this.formatTag,!0),o.setUint16(22,this.channels,!0),o.setUint32(24,this.samplesPerSec,!0),o.setUint32(28,this.avgBytesPerSec,!0),o.setUint16(32,this.channels*(this.bitsPerSample/8),!0),o.setUint16(34,this.bitsPerSample,!0),this.setString(o,36,"data"),o.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new i}static getAudioContext(e){let t=window.AudioContext||window.webkitAudioContext||!1;if(t)return e!==void 0&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new t({sampleRate:e}):new t;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(e,t,r){for(let n=0;n<r.length;n++)e.setUint8(t+n,r.charCodeAt(n))}};Wt.AudioStreamFormatImpl=Ci});var Wm=p(zr=>{"use strict";Object.defineProperty(zr,"__esModule",{value:!0});zr.MicAudioSource=zr.AudioWorkletSourceURLPropertyName=void 0;var Vm=C(),de=P(),Um=pr();zr.AudioWorkletSourceURLPropertyName="MICROPHONE-WorkletSourceUrl";var no=class i{constructor(e,t,r,n){this.privRecorder=e,this.deviceId=t,this.privStreams={},this.privOutputChunkSize=i.AUDIOFORMAT.avgBytesPerSec/10,this.privId=r||de.createNoDashGuid(),this.privEvents=new de.EventSource,this.privMediaStream=n||null,this.privIsClosing=!1}get format(){return Promise.resolve(i.AUDIOFORMAT)}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new de.Deferred;try{this.createAudioContext()}catch(r){if(r instanceof Error){let n=r;this.privInitializeDeferral.reject(n.name+": "+n.message)}else this.privInitializeDeferral.reject(r);return this.privInitializeDeferral.promise}let e=window.navigator,t=e.getUserMedia||e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia;if(e.mediaDevices&&(t=(r,n,s)=>{e.mediaDevices.getUserMedia(r).then(n).catch(s)}),t){let r=()=>{this.onEvent(new de.AudioSourceInitializingEvent(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new de.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()):t({audio:this.deviceId?{deviceId:this.deviceId}:!0,video:!1},n=>{this.privMediaStream=n,this.onEvent(new de.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()},n=>{let s=`Error occurred during microphone initialization: ${n}`;this.privInitializeDeferral.reject(s),this.onEvent(new de.AudioSourceErrorEvent(this.privId,s))})};this.privContext.state==="suspended"?this.privContext.resume().then(r).catch(n=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${n}`)}):r()}else{let r="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(r),this.onEvent(new de.AudioSourceErrorEvent(r,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(e){return this.onEvent(new de.AudioStreamNodeAttachingEvent(this.privId,e)),this.listen(e).then(t=>(this.onEvent(new de.AudioStreamNodeAttachedEvent(this.privId,e)),{detach:async()=>(t.readEnded(),delete this.privStreams[e],this.onEvent(new de.AudioStreamNodeDetachedEvent(this.privId,e)),this.turnOff()),id:()=>e,read:()=>t.read()}))}detach(e){e&&this.privStreams[e]&&(this.privStreams[e].close(),delete this.privStreams[e],this.onEvent(new de.AudioStreamNodeDetachedEvent(this.privId,e)))}async turnOff(){for(let e in this.privStreams)if(e){let t=this.privStreams[e];t&&t.close()}this.onEvent(new de.AudioSourceOffEvent(this.privId)),this.privInitializeDeferral&&(await this.privInitializeDeferral,this.privInitializeDeferral=null),await this.destroyAudioContext()}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then(e=>({bitspersample:i.AUDIOFORMAT.bitsPerSample,channelcount:i.AUDIOFORMAT.channels,connectivity:Vm.connectivity.Unknown,manufacturer:"Speech SDK",model:e,samplerate:i.AUDIOFORMAT.samplesPerSec,type:Vm.type.Microphones}))}setProperty(e,t){if(e===zr.AudioWorkletSourceURLPropertyName)this.privRecorder.setWorkletUrl(t);else throw new Error("Property '"+e+"' is not supported on Microphone.")}getMicrophoneLabel(){let e="microphone";if(this.privMicrophoneLabel!==void 0)return Promise.resolve(this.privMicrophoneLabel);if(this.privMediaStream===void 0||!this.privMediaStream.active)return Promise.resolve(e);this.privMicrophoneLabel=e;let t=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(t===void 0)return Promise.resolve(this.privMicrophoneLabel);let r=new de.Deferred;return navigator.mediaDevices.enumerateDevices().then(n=>{for(let s of n)if(s.deviceId===t){this.privMicrophoneLabel=s.label;break}r.resolve(this.privMicrophoneLabel)},()=>r.resolve(this.privMicrophoneLabel)),r.promise}async listen(e){await this.turnOn();let t=new de.ChunkedArrayBufferStream(this.privOutputChunkSize,e);this.privStreams[e]=t;try{this.privRecorder.record(this.privContext,this.privMediaStream,t)}catch(n){throw this.onEvent(new de.AudioStreamNodeErrorEvent(this.privId,e,n)),n}return t}onEvent(e){this.privEvents.onEvent(e),de.Events.instance.onEvent(e)}createAudioContext(){this.privContext||(this.privContext=Um.AudioStreamFormatImpl.getAudioContext(i.AUDIOFORMAT.samplesPerSec))}async destroyAudioContext(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let e=!1;"close"in this.privContext&&(e=!0),e?this.privIsClosing||(this.privIsClosing=!0,await this.privContext.close(),this.privContext=null,this.privIsClosing=!1):this.privContext!==null&&this.privContext.state==="running"&&await this.privContext.suspend()}};zr.MicAudioSource=no;no.AUDIOFORMAT=Um.AudioStreamFormat.getDefaultInputFormat()});var Km=p(so=>{"use strict";Object.defineProperty(so,"__esModule",{value:!0});so.FileAudioSource=void 0;var Hm=C(),xe=P(),iI=pr(),yl=class{constructor(e,t,r){this.privStreams={},this.privHeaderEnd=44,this.privId=r||xe.createNoDashGuid(),this.privEvents=new xe.EventSource,this.privSource=e,typeof window<"u"&&typeof Blob<"u"&&this.privSource instanceof Blob?this.privFilename=e.name:this.privFilename=t||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){let e=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new xe.AudioSourceErrorEvent(e,"")),Promise.reject(e)}this.onEvent(new xe.AudioSourceInitializingEvent(this.privId)),this.onEvent(new xe.AudioSourceReadyEvent(this.privId))}id(){return this.privId}async attach(e){this.onEvent(new xe.AudioStreamNodeAttachingEvent(this.privId,e));let t=await this.upload(e);return this.onEvent(new xe.AudioStreamNodeAttachedEvent(this.privId,e)),Promise.resolve({detach:async()=>{t.readEnded(),delete this.privStreams[e],this.onEvent(new xe.AudioStreamNodeDetachedEvent(this.privId,e)),await this.turnOff()},id:()=>e,read:()=>t.read()})}detach(e){e&&this.privStreams[e]&&(this.privStreams[e].close(),delete this.privStreams[e],this.onEvent(new xe.AudioStreamNodeDetachedEvent(this.privId,e)))}turnOff(){for(let e in this.privStreams)if(e){let t=this.privStreams[e];t&&!t.isClosed&&t.close()}return this.onEvent(new xe.AudioSourceOffEvent(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then(e=>Promise.resolve({bitspersample:e.bitsPerSample,channelcount:e.channels,connectivity:Hm.connectivity.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:e.samplesPerSec,type:Hm.type.File}))}readHeader(){let t=this.privSource.slice(0,4296),r=new xe.Deferred,n=s=>{let o=new DataView(s),a=g=>String.fromCharCode(o.getUint8(g),o.getUint8(g+1),o.getUint8(g+2),o.getUint8(g+3));if(a(0)!=="RIFF"){r.reject("Invalid WAV header in file, RIFF was not found");return}if(a(8)!=="WAVE"||a(12)!=="fmt "){r.reject("Invalid WAV header in file, WAVEfmt was not found");return}let c=o.getInt32(16,!0),u=o.getUint16(22,!0),l=o.getUint32(24,!0),h=o.getUint16(34,!0),d=36+Math.max(c-16,0);for(;a(d)!=="data";d+=2)if(d>4288){r.reject("Invalid WAV header in file, data block was not found");return}this.privHeaderEnd=d+8,r.resolve(iI.AudioStreamFormat.getWaveFormatPCM(l,h,u))};if(typeof window<"u"&&typeof Blob<"u"&&t instanceof Blob){let s=new FileReader;s.onload=o=>{let a=o.target.result;n(a)},s.readAsArrayBuffer(t)}else{let s=t;n(s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength))}return r.promise}async upload(e){let t=r=>{let n=`Error occurred while processing '${this.privFilename}'. ${r}`;throw this.onEvent(new xe.AudioStreamNodeErrorEvent(this.privId,e,n)),new Error(n)};try{await this.turnOn();let r=await this.privAudioFormatPromise,n=new xe.ChunkedArrayBufferStream(r.avgBytesPerSec/10,e);this.privStreams[e]=n;let s=this.privSource.slice(this.privHeaderEnd),o=a=>{n.isClosed||(n.writeStreamChunk({buffer:a,isEnd:!1,timeReceived:Date.now()}),n.close())};if(typeof window<"u"&&typeof Blob<"u"&&s instanceof Blob){let a=new FileReader;a.onerror=c=>t(c.toString()),a.onload=c=>{let u=c.target.result;o(u)},a.readAsArrayBuffer(s)}else{let a=s;o(a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength))}return n}catch(r){t(r)}}onEvent(e){this.privEvents.onEvent(e),xe.Events.instance.onEvent(e)}};so.FileAudioSource=yl});var Jm=p(oo=>{"use strict";Object.defineProperty(oo,"__esModule",{value:!0});oo.PcmRecorder=void 0;var nI=P(),Sl=class{constructor(e){this.privStopInputOnRelease=e}record(e,t,r){let s=new nI.RiffPcmEncoder(e.sampleRate,16e3),o=e.createMediaStreamSource(t),a=()=>{let u=(()=>{let l=0;try{return e.createScriptProcessor(l,1,1)}catch{l=2048;let d=e.sampleRate;for(;l<16384&&d>=32e3;)l<<=1,d>>=1;return e.createScriptProcessor(l,1,1)}})();u.onaudioprocess=l=>{let h=l.inputBuffer.getChannelData(0);if(r&&!r.isClosed){let d=s.encode(h);d&&r.writeStreamChunk({buffer:d,isEnd:!1,timeReceived:Date.now()})}},o.connect(u),u.connect(e.destination),this.privMediaResources={scriptProcessorNode:u,source:o,stream:t}},c=!!this.privSpeechProcessorScript&&this.privSpeechProcessorScript.toLowerCase()==="ignore";if(e.audioWorklet&&!c){if(!this.privSpeechProcessorScript){let u=`class SP extends AudioWorkletProcessor {
                    constructor(options) {
                      super(options);
                    }
                    process(inputs, outputs) {
                      const input = inputs[0];
                      const output = [];
                      for (let channel = 0; channel < input.length; channel += 1) {
                        output[channel] = input[channel];
                      }
                      this.port.postMessage(output[0]);
                      return true;
                    }
                  }
                  registerProcessor('speech-processor', SP);`,l=new Blob([u],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(l)}e.audioWorklet.addModule(this.privSpeechProcessorScript).then(()=>{let u=new AudioWorkletNode(e,"speech-processor");u.port.onmessage=l=>{let h=l.data;if(r&&!r.isClosed){let d=s.encode(h);d&&r.writeStreamChunk({buffer:d,isEnd:!1,timeReceived:Date.now()})}},o.connect(u),u.connect(e.destination),this.privMediaResources={scriptProcessorNode:u,source:o,stream:t}}).catch(()=>{a()})}else try{a()}catch(u){throw new Error(`Unable to start audio worklet node for PCMRecorder: ${u}`)}}releaseMediaResources(e){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(e.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach(t=>t.stop()),this.privMediaResources.source=null))}setWorkletUrl(e){this.privSpeechProcessorScript=e}};oo.PcmRecorder=Sl});var Gm=p(()=>{});var $m=p(()=>{});var Qm=p(()=>{});var Xm=p(()=>{});var Zm=p(()=>{});var Pl=p($e=>{"use strict";var sI=$e&&$e.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t),Object.defineProperty(i,r,{enumerable:!0,get:function(){return e[t]}})}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),oI=$e&&$e.__setModuleDefault||(Object.create?function(i,e){Object.defineProperty(i,"default",{enumerable:!0,value:e})}:function(i,e){i.default=e}),Ym=$e&&$e.__importStar||function(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)t!=="default"&&Object.hasOwnProperty.call(i,t)&&sI(e,i,t);return oI(e,i),e},Cl=$e&&$e.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty($e,"__esModule",{value:!0});$e.WebsocketMessageAdapter=void 0;var aI=Ym(Gm()),cI=Ym($m()),uI=Cl(Qm()),pI=Cl(Xm()),lI=Cl(Zm()),hI=Ie(),w=P(),ao=class i{constructor(e,t,r,n,s,o){if(!e)throw new w.ArgumentNullError("uri");if(!r)throw new w.ArgumentNullError("messageFormatter");this.proxyInfo=n,this.privConnectionEvents=new w.EventSource,this.privConnectionId=t,this.privMessageFormatter=r,this.privConnectionState=w.ConnectionState.None,this.privUri=e,this.privHeaders=s,this.privEnableCompression=o,this.privHeaders[hI.HeaderNames.ConnectionId]=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===w.ConnectionState.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new w.Deferred,this.privCertificateValidatedDeferral=new w.Deferred,this.privConnectionState=w.ConnectionState.Connecting;try{if(typeof WebSocket<"u"&&!i.forceNpmWebSocket)this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);else{let e={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression};this.privCertificateValidatedDeferral.resolve(),e.agent=this.getAgent();let r=new URL(this.privUri).protocol;r?.toLocaleLowerCase()==="wss:"?r="https:":r?.toLocaleLowerCase()==="ws:"&&(r="http:"),e.agent.protocol=r,this.privWebsocketClient=new lI.default(this.privUri,e)}this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new w.Queue,this.privDisconnectDeferral=new w.Deferred,this.privSendMessageQueue=new w.Queue,this.processSendQueue().catch(e=>{w.Events.instance.onEvent(new w.BackgroundEvent(e))})}catch(e){return this.privConnectionEstablishDeferral.resolve(new w.ConnectionOpenResponse(500,e)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new w.ConnectionStartEvent(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then(()=>{this.privConnectionState=w.ConnectionState.Connected,this.onEvent(new w.ConnectionEstablishedEvent(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new w.ConnectionOpenResponse(200,""))},e=>{this.privConnectionEstablishDeferral.reject(e)})},this.privWebsocketClient.onerror=e=>{this.onEvent(new w.ConnectionErrorEvent(this.privConnectionId,e.message,e.type)),this.privLastErrorReceived=e.message},this.privWebsocketClient.onclose=e=>{this.privConnectionState===w.ConnectionState.Connecting?(this.privConnectionState=w.ConnectionState.Disconnected,this.privConnectionEstablishDeferral.resolve(new w.ConnectionOpenResponse(e.code,e.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=w.ConnectionState.Disconnected,this.privWebsocketClient=null,this.onEvent(new w.ConnectionClosedEvent(this.privConnectionId,e.code,e.reason))),this.onClose(e.code,e.reason).catch(t=>{w.Events.instance.onEvent(new w.BackgroundEvent(t))})},this.privWebsocketClient.onmessage=e=>{let t=new Date().toISOString();if(this.privConnectionState===w.ConnectionState.Connected){let r=new w.Deferred;if(this.privReceivingMessageQueue.enqueueFromPromise(r.promise),e.data instanceof ArrayBuffer){let n=new w.RawWebsocketMessage(w.MessageType.Binary,e.data);this.privMessageFormatter.toConnectionMessage(n).then(s=>{this.onEvent(new w.ConnectionMessageReceivedEvent(this.privConnectionId,t,s)),r.resolve(s)},s=>{r.reject(`Invalid binary message format. Error: ${s}`)})}else{let n=new w.RawWebsocketMessage(w.MessageType.Text,e.data);this.privMessageFormatter.toConnectionMessage(n).then(s=>{this.onEvent(new w.ConnectionMessageReceivedEvent(this.privConnectionId,t,s)),r.resolve(s)},s=>{r.reject(`Invalid text message format. Error: ${s}`)})}}},this.privConnectionEstablishDeferral.promise}send(e){if(this.privConnectionState!==w.ConnectionState.Connected)return Promise.reject(`Cannot send on connection that is in ${w.ConnectionState[this.privConnectionState]} state`);let t=new w.Deferred,r=new w.Deferred;return this.privSendMessageQueue.enqueueFromPromise(r.promise),this.privMessageFormatter.fromConnectionMessage(e).then(n=>{r.resolve({Message:e,RawWebsocketMessage:n,sendStatusDeferral:t})},n=>{r.reject(`Error formatting the message. ${n}`)}),t.promise}read(){return this.privConnectionState!==w.ConnectionState.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue()}close(e){if(this.privWebsocketClient)this.privConnectionState!==w.ConnectionState.Disconnected&&this.privWebsocketClient.close(1e3,e||"Normal closure by client");else return Promise.resolve();return this.privDisconnectDeferral.promise}get events(){return this.privConnectionEvents}sendRawMessage(e){try{if(!e)return Promise.resolve();if(this.onEvent(new w.ConnectionMessageSentEvent(this.privConnectionId,new Date().toISOString(),e.Message)),this.isWebsocketOpen)this.privWebsocketClient.send(e.RawWebsocketMessage.payload);else return Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+e.Message.id+" "+new Error().stack);return Promise.resolve()}catch(t){return Promise.reject(`websocket send error: ${t}`)}}async onClose(e,t){let r=`Connection closed. ${e}: ${t}`;this.privConnectionState=w.ConnectionState.Disconnected,this.privDisconnectDeferral.resolve(),await this.privReceivingMessageQueue.drainAndDispose(()=>{},r),await this.privSendMessageQueue.drainAndDispose(n=>{n.sendStatusDeferral.reject(r)},r)}async processSendQueue(){for(;;){let t=await this.privSendMessageQueue.dequeue();if(!t)return;try{await this.sendRawMessage(t),t.sendStatusDeferral.resolve()}catch(r){t.sendStatusDeferral.reject(r)}}}onEvent(e){this.privConnectionEvents.onEvent(e),w.Events.instance.onEvent(e)}getAgent(){let e=new uI.default.Agent(this.createConnection);return this.proxyInfo!==void 0&&this.proxyInfo.HostName!==void 0&&this.proxyInfo.Port>0&&(e.proxyInfo=this.proxyInfo),e}static GetProxyAgent(e){let t={host:e.HostName,port:e.Port};return e.UserName?t.headers={"Proxy-Authentication":"Basic "+new Buffer(`${e.UserName}:${e.Password===void 0?"":e.Password}`).toString("base64")}:t.headers={},t.headers.requestOCSP="true",new pI.default(t)}createConnection(e,t){let r;if(t={...t,requestOCSP:!0,servername:t.host},this.proxyInfo){let s=i.GetProxyAgent(this.proxyInfo);r=new Promise((o,a)=>{s.callback(e,t,(c,u)=>{c?a(c):o(u)})})}else t.secureEndpoint?r=Promise.resolve(cI.connect(t)):r=Promise.resolve(aI.connect(t));return r}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}};$e.WebsocketMessageAdapter=ao;ao.forceNpmWebSocket=!1});var ey=p(co=>{"use strict";Object.defineProperty(co,"__esModule",{value:!0});co.WebsocketConnection=void 0;var Rl=P(),dI=Pl(),El=class{constructor(e,t,r,n,s,o=!1,a){if(this.privIsDisposed=!1,!e)throw new Rl.ArgumentNullError("uri");if(!n)throw new Rl.ArgumentNullError("messageFormatter");this.privMessageFormatter=n;let c="",u=0;if(t){for(let l in t)if(l){c+=u===0&&e.indexOf("?")===-1?"?":"&";let h=encodeURIComponent(l);c+=h;let d=t[l];d&&(d=encodeURIComponent(d),c+=`=${d}`),u++}}if(r){for(let l in r)if(l){c+=u===0&&e.indexOf("?")===-1?"?":"&";let h=encodeURIComponent(r[l]);c+=`${l}=${h}`,u++}}this.privUri=e+c,this.privId=a||Rl.createNoDashGuid(),this.privConnectionMessageAdapter=new dI.WebsocketMessageAdapter(this.privUri,this.id,this.privMessageFormatter,s,r,o)}async dispose(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&await this.privConnectionMessageAdapter.close()}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(e){return this.privConnectionMessageAdapter.send(e)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}};co.WebsocketConnection=El});var ty=p(uo=>{"use strict";Object.defineProperty(uo,"__esModule",{value:!0});uo.ReplayableAudioNode=void 0;var _l=class{constructor(e,t){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=e,this.privBytesPerSecond=t}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&this.privBuffers.length!==0){let e=this.privReplayOffset-this.privBufferStartOffset,t=Math.round(e*this.privBytesPerSecond*1e-7);t%2!==0&&t++;let r=0;for(;r<this.privBuffers.length&&t>=this.privBuffers[r].chunk.buffer.byteLength;)t-=this.privBuffers[r++].chunk.buffer.byteLength;if(r<this.privBuffers.length){let n=this.privBuffers[r].chunk.buffer.slice(t);return this.privReplayOffset+=n.byteLength/this.privBytesPerSecond*1e7,r===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:n,isEnd:!1,timeReceived:this.privBuffers[r].chunk.timeReceived})}}return this.privAudioNode.read().then(e=>(e&&e.buffer&&(this.privBuffers.push(new Il(e,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=e.buffer.byteLength),e))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&this.privBuffers.length!==0&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(e){if(this.privBuffers===void 0||this.privBuffers.length===0)return;this.privLastShrinkOffset=e;let t=e-this.privBufferStartOffset,r=Math.round(t*this.privBytesPerSecond*1e-7),n=0;for(;n<this.privBuffers.length&&r>=this.privBuffers[n].chunk.buffer.byteLength;)r-=this.privBuffers[n++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(e-r/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(n)}findTimeAtOffset(e){if(e<this.privBufferStartOffset||this.privBuffers===void 0)return 0;for(let t of this.privBuffers){let r=t.byteOffset/this.privBytesPerSecond*1e7,n=r+t.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(e>=r&&e<=n)return t.chunk.timeReceived}return 0}};uo.ReplayableAudioNode=_l;var Il=class{constructor(e,t,r){this.chunk=e,this.serial=t,this.byteOffset=r}}});var Al=p(It=>{"use strict";var vI=It&&It.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t),Object.defineProperty(i,r,{enumerable:!0,get:function(){return e[t]}})}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),fI=It&&It.__setModuleDefault||(Object.create?function(i,e){Object.defineProperty(i,"default",{enumerable:!0,value:e})}:function(i,e){i.default=e}),gI=It&&It.__importStar||function(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)t!=="default"&&Object.hasOwnProperty.call(i,t)&&vI(e,i,t);return fI(e,i),e};Object.defineProperty(It,"__esModule",{value:!0});It.AudioFileWriter=void 0;var Rn=gI(vl()),wl=_(),bl=class{constructor(e){wl.Contracts.throwIfNullOrUndefined(Rn.openSync,`
File System access not available, please use Push or PullAudioOutputStream`),this.privFd=Rn.openSync(e,"w")}set format(e){wl.Contracts.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=e;let t=0;this.privAudioFormat.hasHeader&&(t=this.privAudioFormat.header.byteLength),this.privFd!==void 0&&(this.privWriteStream=Rn.createWriteStream("",{fd:this.privFd,start:t,autoClose:!1}))}write(e){wl.Contracts.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),this.privWriteStream!==void 0&&this.privWriteStream.write(new Uint8Array(e.slice(0)))}close(){this.privFd!==void 0&&(this.privWriteStream.on("finish",()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),Rn.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),Rn.closeSync(this.privFd),this.privFd=void 0}),this.privWriteStream.end())}id(){return this.privId}};It.AudioFileWriter=bl});var Tl=p(Qe=>{"use strict";Object.defineProperty(Qe,"__esModule",{value:!0});Qe.PullAudioInputStreamImpl=Qe.PullAudioInputStream=Qe.PushAudioInputStreamImpl=Qe.PushAudioInputStream=Qe.AudioInputStream=void 0;var po=C(),ve=P(),ry=ar(),mI=f(),yI=pr(),En=class{constructor(){}static createPushStream(e){return _n.create(e)}static createPullStream(e,t){return In.create(e,t)}};Qe.AudioInputStream=En;var _n=class extends En{static create(e){return new lo(e)}};Qe.PushAudioInputStream=_n;var lo=class extends _n{constructor(e){super(),e===void 0?this.privFormat=yI.AudioStreamFormatImpl.getDefaultInputFormat():this.privFormat=e,this.privEvents=new ve.EventSource,this.privId=ry.createNoDashGuid(),this.privStream=new ve.ChunkedArrayBufferStream(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(e){this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}turnOn(){this.onEvent(new ve.AudioSourceInitializingEvent(this.privId)),this.onEvent(new ve.AudioSourceReadyEvent(this.privId))}async attach(e){this.onEvent(new ve.AudioStreamNodeAttachingEvent(this.privId,e)),await this.turnOn();let t=this.privStream;return this.onEvent(new ve.AudioStreamNodeAttachedEvent(this.privId,e)),{detach:async()=>(this.onEvent(new ve.AudioStreamNodeDetachedEvent(this.privId,e)),this.turnOff()),id:()=>e,read:()=>t.read()}}detach(e){this.onEvent(new ve.AudioStreamNodeDetachedEvent(this.privId,e))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:po.connectivity.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:po.type.Stream})}onEvent(e){this.privEvents.onEvent(e),ve.Events.instance.onEvent(e)}toBuffer(e){let t=Buffer.alloc(e.byteLength),r=new Uint8Array(e);for(let n=0;n<t.length;++n)t[n]=r[n];return t}};Qe.PushAudioInputStreamImpl=lo;var In=class extends En{constructor(){super()}static create(e,t){return new ho(e,t)}};Qe.PullAudioInputStream=In;var ho=class extends In{constructor(e,t){super(),t===void 0?this.privFormat=mI.AudioStreamFormat.getDefaultInputFormat():this.privFormat=t,this.privEvents=new ve.EventSource,this.privId=ry.createNoDashGuid(),this.privCallback=e,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}turnOn(){this.onEvent(new ve.AudioSourceInitializingEvent(this.privId)),this.onEvent(new ve.AudioSourceReadyEvent(this.privId))}async attach(e){return this.onEvent(new ve.AudioStreamNodeAttachingEvent(this.privId,e)),await this.turnOn(),this.onEvent(new ve.AudioStreamNodeAttachedEvent(this.privId,e)),{detach:()=>(this.privCallback.close(),this.onEvent(new ve.AudioStreamNodeDetachedEvent(this.privId,e)),this.turnOff()),id:()=>e,read:()=>{let t=0,r;for(;t<this.privBufferSize;){let n=new ArrayBuffer(this.privBufferSize-t),s=this.privCallback.read(n);if(r===void 0?r=n:new Int8Array(r).set(new Int8Array(n),t),s===0)break;t+=s}return Promise.resolve({buffer:r.slice(0,t),isEnd:this.privIsClosed||t===0,timeReceived:Date.now()})}}}detach(e){this.onEvent(new ve.AudioStreamNodeDetachedEvent(this.privId,e))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:po.connectivity.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:po.type.Stream})}onEvent(e){this.privEvents.onEvent(e),ve.Events.instance.onEvent(e)}};Qe.PullAudioInputStreamImpl=ho});var Ol=p(wn=>{"use strict";Object.defineProperty(wn,"__esModule",{value:!0});wn.SpeechSynthesisOutputFormat=void 0;var SI;(function(i){i[i.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",i[i.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",i[i.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",i[i.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",i[i.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",i[i.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",i[i.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",i[i.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",i[i.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",i[i.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",i[i.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",i[i.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",i[i.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",i[i.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",i[i.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",i[i.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",i[i.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",i[i.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",i[i.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",i[i.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",i[i.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",i[i.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",i[i.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",i[i.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",i[i.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",i[i.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",i[i.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",i[i.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",i[i.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",i[i.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",i[i.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",i[i.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",i[i.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",i[i.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",i[i.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",i[i.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",i[i.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm"})(SI=wn.SpeechSynthesisOutputFormat||(wn.SpeechSynthesisOutputFormat={}))});var Pi=p(fo=>{"use strict";Object.defineProperty(fo,"__esModule",{value:!0});fo.AudioOutputFormatImpl=void 0;var T=Ol(),b=pr(),vo=class i extends b.AudioStreamFormatImpl{constructor(e,t,r,n,s,o,a,c,u){super(r,o,t,e),this.formatTag=e,this.avgBytesPerSec=n,this.blockAlign=s,this.priAudioFormatString=a,this.priRequestAudioFormatString=c,this.priHasHeader=u}static fromSpeechSynthesisOutputFormat(e){return e===void 0?i.getDefaultOutputFormat():i.fromSpeechSynthesisOutputFormatString(i.SpeechSynthesisOutputFormatToString[e])}static fromSpeechSynthesisOutputFormatString(e){switch(e){case"raw-8khz-8bit-mono-mulaw":return new i(b.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,e,e,!1);case"riff-16khz-16kbps-mono-siren":return new i(b.AudioFormatTag.Siren,1,16e3,2e3,40,0,e,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new i(b.AudioFormatTag.Siren,1,16e3,2e3,40,0,e,e,!1);case"audio-16khz-32kbitrate-mono-mp3":return new i(b.AudioFormatTag.MP3,1,16e3,4096,2,16,e,e,!1);case"audio-16khz-128kbitrate-mono-mp3":return new i(b.AudioFormatTag.MP3,1,16e3,16384,2,16,e,e,!1);case"audio-16khz-64kbitrate-mono-mp3":return new i(b.AudioFormatTag.MP3,1,16e3,8192,2,16,e,e,!1);case"audio-24khz-48kbitrate-mono-mp3":return new i(b.AudioFormatTag.MP3,1,24e3,6144,2,16,e,e,!1);case"audio-24khz-96kbitrate-mono-mp3":return new i(b.AudioFormatTag.MP3,1,24e3,12288,2,16,e,e,!1);case"audio-24khz-160kbitrate-mono-mp3":return new i(b.AudioFormatTag.MP3,1,24e3,20480,2,16,e,e,!1);case"raw-16khz-16bit-mono-truesilk":return new i(b.AudioFormatTag.SILKSkype,1,16e3,32e3,2,16,e,e,!1);case"riff-8khz-16bit-mono-pcm":return new i(b.AudioFormatTag.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new i(b.AudioFormatTag.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new i(b.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new i(b.AudioFormatTag.PCM,1,16e3,32e3,2,16,e,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new i(b.AudioFormatTag.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new i(b.AudioFormatTag.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new i(b.AudioFormatTag.OGG_OPUS,1,16e3,8192,2,16,e,e,!1);case"ogg-24khz-16bit-mono-opus":return new i(b.AudioFormatTag.OGG_OPUS,1,24e3,8192,2,16,e,e,!1);case"raw-48khz-16bit-mono-pcm":return new i(b.AudioFormatTag.PCM,1,48e3,96e3,2,16,e,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new i(b.AudioFormatTag.PCM,1,48e3,96e3,2,16,e,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new i(b.AudioFormatTag.MP3,1,48e3,12288,2,16,e,e,!1);case"audio-48khz-192kbitrate-mono-mp3":return new i(b.AudioFormatTag.MP3,1,48e3,24576,2,16,e,e,!1);case"ogg-48khz-16bit-mono-opus":return new i(b.AudioFormatTag.OGG_OPUS,1,48e3,12e3,2,16,e,e,!1);case"webm-16khz-16bit-mono-opus":return new i(b.AudioFormatTag.WEBM_OPUS,1,16e3,4e3,2,16,e,e,!1);case"webm-24khz-16bit-mono-opus":return new i(b.AudioFormatTag.WEBM_OPUS,1,24e3,6e3,2,16,e,e,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new i(b.AudioFormatTag.WEBM_OPUS,1,24e3,3e3,2,16,e,e,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new i(b.AudioFormatTag.OPUS,1,16e3,4e3,2,16,e,e,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new i(b.AudioFormatTag.OPUS,1,24e3,6e3,2,16,e,e,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new i(b.AudioFormatTag.OPUS,1,24e3,3e3,2,16,e,e,!1);case"audio-24khz-16bit-mono-flac":return new i(b.AudioFormatTag.FLAC,1,24e3,24e3,2,16,e,e,!1);case"audio-48khz-16bit-mono-flac":return new i(b.AudioFormatTag.FLAC,1,48e3,3e4,2,16,e,e,!1);case"raw-24khz-16bit-mono-truesilk":return new i(b.AudioFormatTag.SILKSkype,1,24e3,48e3,2,16,e,e,!1);case"raw-8khz-8bit-mono-alaw":return new i(b.AudioFormatTag.ALaw,1,8e3,8e3,1,8,e,e,!1);case"riff-8khz-8bit-mono-alaw":return new i(b.AudioFormatTag.ALaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new i(b.AudioFormatTag.PCM,1,22050,44100,2,16,e,e,!1);case"riff-22050hz-16bit-mono-pcm":return new i(b.AudioFormatTag.PCM,1,22050,44100,2,16,e,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new i(b.AudioFormatTag.PCM,1,44100,88200,2,16,e,e,!1);case"riff-44100hz-16bit-mono-pcm":return new i(b.AudioFormatTag.PCM,1,44100,88200,2,16,e,"raw-44100hz-16bit-mono-pcm",!0);case"riff-16khz-16bit-mono-pcm":default:return new i(b.AudioFormatTag.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return i.fromSpeechSynthesisOutputFormatString(typeof window<"u"?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(e){if(this.priHasHeader){let t=new DataView(this.privHeader);t.setUint32(4,e+this.privHeader.byteLength-8,!0),t.setUint32(40,e,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}addHeader(e){if(!this.hasHeader)return e;this.updateHeader(e.byteLength);let t=new Uint8Array(e.byteLength+this.header.byteLength);return t.set(new Uint8Array(this.header),0),t.set(new Uint8Array(e),this.header.byteLength),t.buffer}};fo.AudioOutputFormatImpl=vo;vo.SpeechSynthesisOutputFormatToString={[T.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[T.SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[T.SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[T.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[T.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[T.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[T.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[T.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[T.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[T.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[T.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[T.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[T.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[T.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[T.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[T.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[T.SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[T.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[T.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[T.SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[T.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[T.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[T.SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[T.SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[T.SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[T.SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[T.SpeechSynthesisOutputFormat.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[T.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[T.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[T.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[T.SpeechSynthesisOutputFormat.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[T.SpeechSynthesisOutputFormat.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[T.SpeechSynthesisOutputFormat.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[T.SpeechSynthesisOutputFormat.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[T.SpeechSynthesisOutputFormat.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[T.SpeechSynthesisOutputFormat.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[T.SpeechSynthesisOutputFormat.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm"}});var Lr=p(Xe=>{"use strict";Object.defineProperty(Xe,"__esModule",{value:!0});Xe.PushAudioOutputStreamImpl=Xe.PushAudioOutputStream=Xe.PullAudioOutputStreamImpl=Xe.PullAudioOutputStream=Xe.AudioOutputStream=void 0;var kl=P(),CI=_(),PI=Pi(),bn=class{constructor(){}static createPullStream(){return An.create()}};Xe.AudioOutputStream=bn;var An=class extends bn{static create(){return new go}};Xe.PullAudioOutputStream=An;var go=class extends An{constructor(){super(),this.privId=kl.createNoDashGuid(),this.privStream=new kl.Stream}set format(e){e==null&&(this.privFormat=PI.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privFormat=e}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}async read(e){let t=new Int8Array(e),r=0;if(this.privLastChunkView!==void 0){if(this.privLastChunkView.length>e.byteLength)return t.set(this.privLastChunkView.slice(0,e.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(e.byteLength),Promise.resolve(e.byteLength);t.set(this.privLastChunkView),r=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;r<e.byteLength&&!this.privStream.isReadEnded;){let n=await this.privStream.read();if(n!==void 0&&!n.isEnd){let s;n.buffer.byteLength>e.byteLength-r?(s=n.buffer.slice(0,e.byteLength-r),this.privLastChunkView=new Int8Array(n.buffer.slice(e.byteLength-r))):s=n.buffer,t.set(new Int8Array(s),r),r+=s.byteLength}else this.privStream.readEnded()}return r}write(e){CI.Contracts.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}};Xe.PullAudioOutputStreamImpl=go;var mo=class extends bn{constructor(){super()}static create(e){return new yo(e)}};Xe.PushAudioOutputStream=mo;var yo=class extends mo{constructor(e){super(),this.privId=kl.createNoDashGuid(),this.privCallback=e}set format(e){}write(e){this.privCallback.write&&this.privCallback.write(e)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}};Xe.PushAudioOutputStreamImpl=yo});var Ml=p(lr=>{"use strict";Object.defineProperty(lr,"__esModule",{value:!0});lr.AudioOutputConfigImpl=lr.AudioConfigImpl=lr.AudioConfig=void 0;var Br=ce(),RI=_(),Fr=f(),EI=Al(),_I=Tl(),II=Lr(),Tn=class i{static fromDefaultMicrophoneInput(){let e=new Br.PcmRecorder(!0);return new Ht(new Br.MicAudioSource(e))}static fromMicrophoneInput(e){let t=new Br.PcmRecorder(!0);return new Ht(new Br.MicAudioSource(t,e))}static fromWavFileInput(e,t="unnamedBuffer.wav"){return new Ht(new Br.FileAudioSource(e,t))}static fromStreamInput(e){if(e instanceof Fr.PullAudioInputStreamCallback)return new Ht(new _I.PullAudioInputStreamImpl(e));if(e instanceof Fr.AudioInputStream)return new Ht(e);if(typeof MediaStream<"u"&&e instanceof MediaStream){let t=new Br.PcmRecorder(!1);return new Ht(new Br.MicAudioSource(t,null,null,e))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new Kt(new Fr.SpeakerAudioDestination)}static fromSpeakerOutput(e){if(e===void 0)return i.fromDefaultSpeakerOutput();if(e instanceof Fr.SpeakerAudioDestination)return new Kt(e);throw new Error("Not Supported Type")}static fromAudioFileOutput(e){return new Kt(new EI.AudioFileWriter(e))}static fromStreamOutput(e){if(e instanceof Fr.PushAudioOutputStreamCallback)return new Kt(new II.PushAudioOutputStreamImpl(e));if(e instanceof Fr.PushAudioOutputStream)return new Kt(e);if(e instanceof Fr.PullAudioOutputStream)return new Kt(e);throw new Error("Not Supported Type")}};lr.AudioConfig=Tn;var Ht=class extends Tn{constructor(e){super(),this.privSource=e}get format(){return this.privSource.format}close(e,t){this.privSource.turnOff().then(()=>{e&&e()},r=>{t&&t(r)})}id(){return this.privSource.id()}turnOn(){return this.privSource.turnOn()}attach(e){return this.privSource.attach(e)}detach(e){return this.privSource.detach(e)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(e,t){if(RI.Contracts.throwIfNull(t,"value"),this.privSource.setProperty!==void 0)this.privSource.setProperty(e,t);else throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(e,t){if(this.privSource.getProperty!==void 0)return this.privSource.getProperty(e,t);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}};lr.AudioConfigImpl=Ht;var Kt=class extends Tn{constructor(e){super(),this.privDestination=e}set format(e){this.privDestination.format=e}write(e){this.privDestination.write(e)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}};lr.AudioOutputConfigImpl=Kt});var iy=p(On=>{"use strict";Object.defineProperty(On,"__esModule",{value:!0});On.CancellationReason=void 0;var wI;(function(i){i[i.Error=0]="Error",i[i.EndOfStream=1]="EndOfStream"})(wI=On.CancellationReason||(On.CancellationReason={}))});var ny=p(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0});So.PullAudioInputStreamCallback=void 0;var Dl=class{};So.PullAudioInputStreamCallback=Dl});var sy=p(Co=>{"use strict";Object.defineProperty(Co,"__esModule",{value:!0});Co.PushAudioOutputStreamCallback=void 0;var xl=class{};Co.PushAudioOutputStreamCallback=xl});var ay=p(Po=>{"use strict";Object.defineProperty(Po,"__esModule",{value:!0});Po.KeywordRecognitionModel=void 0;var oy=_(),Nl=class{constructor(){this.privDisposed=!1}static fromFile(e){throw oy.Contracts.throwIfFileDoesNotExist(e,"fileName"),new Error("Not yet implemented.")}static fromStream(e){throw oy.Contracts.throwIfNull(e,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}};Po.KeywordRecognitionModel=Nl});var cy=p(Ro=>{"use strict";Object.defineProperty(Ro,"__esModule",{value:!0});Ro.SessionEventArgs=void 0;var ql=class{constructor(e){this.privSessionId=e}get sessionId(){return this.privSessionId}};Ro.SessionEventArgs=ql});var uy=p(Eo=>{"use strict";Object.defineProperty(Eo,"__esModule",{value:!0});Eo.RecognitionEventArgs=void 0;var bI=f(),jl=class extends bI.SessionEventArgs{constructor(e,t){super(t),this.privOffset=e}get offset(){return this.privOffset}};Eo.RecognitionEventArgs=jl});var py=p(kn=>{"use strict";Object.defineProperty(kn,"__esModule",{value:!0});kn.OutputFormat=void 0;var AI;(function(i){i[i.Simple=0]="Simple",i[i.Detailed=1]="Detailed"})(AI=kn.OutputFormat||(kn.OutputFormat={}))});var ly=p(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});_o.IntentRecognitionEventArgs=void 0;var TI=f(),zl=class extends TI.RecognitionEventArgs{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}};_o.IntentRecognitionEventArgs=zl});var hy=p(Io=>{"use strict";Object.defineProperty(Io,"__esModule",{value:!0});Io.RecognitionResult=void 0;var Ll=class{constructor(e,t,r,n,s,o,a,c,u,l){this.privResultId=e,this.privReason=t,this.privText=r,this.privDuration=n,this.privOffset=s,this.privLanguage=o,this.privLanguageDetectionConfidence=a,this.privErrorDetails=c,this.privJson=u,this.privProperties=l}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}};Io.RecognitionResult=Ll});var dy=p(wo=>{"use strict";Object.defineProperty(wo,"__esModule",{value:!0});wo.SpeechRecognitionResult=void 0;var OI=f(),Bl=class extends OI.RecognitionResult{constructor(e,t,r,n,s,o,a,c,u,l,h){super(e,t,r,n,s,o,a,u,l,h),this.privSpeakerId=c}get speakerId(){return this.privSpeakerId}};wo.SpeechRecognitionResult=Bl});var vy=p(bo=>{"use strict";Object.defineProperty(bo,"__esModule",{value:!0});bo.IntentRecognitionResult=void 0;var kI=f(),Fl=class extends kI.SpeechRecognitionResult{constructor(e,t,r,n,s,o,a,c,u,l,h){super(t,r,n,s,o,a,c,void 0,u,l,h),this.privIntentId=e}get intentId(){return this.privIntentId}};bo.IntentRecognitionResult=Fl});var fy=p(_i=>{"use strict";Object.defineProperty(_i,"__esModule",{value:!0});_i.LanguageUnderstandingModelImpl=_i.LanguageUnderstandingModel=void 0;var Ri=_(),Ao=class{constructor(){}static fromEndpoint(e){Ri.Contracts.throwIfNull(e,"uri"),Ri.Contracts.throwIfNullOrWhitespace(e.hostname,"uri");let t=new Ei,r=e.host.indexOf(".");if(r===-1)throw new Error("Could not determine region from endpoint");t.region=e.host.substr(0,r);let n=e.pathname.lastIndexOf("/")+1;if(n===-1)throw new Error("Could not determine appId from endpoint");if(t.appId=e.pathname.substr(n),t.subscriptionKey=e.searchParams.get("subscription-key"),t.subscriptionKey===void 0)throw new Error("Could not determine subscription key from endpoint");return t}static fromAppId(e){Ri.Contracts.throwIfNullOrWhitespace(e,"appId");let t=new Ei;return t.appId=e,t}static fromSubscription(e,t,r){Ri.Contracts.throwIfNullOrWhitespace(e,"subscriptionKey"),Ri.Contracts.throwIfNullOrWhitespace(t,"appId"),Ri.Contracts.throwIfNullOrWhitespace(r,"region");let n=new Ei;return n.appId=t,n.region=r,n.subscriptionKey=e,n}};_i.LanguageUnderstandingModel=Ao;var Ei=class extends Ao{};_i.LanguageUnderstandingModelImpl=Ei});var my=p(hr=>{"use strict";Object.defineProperty(hr,"__esModule",{value:!0});hr.MeetingTranscriptionEventArgs=hr.ConversationTranscriptionEventArgs=hr.SpeechRecognitionEventArgs=void 0;var gy=f(),To=class extends gy.RecognitionEventArgs{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}};hr.SpeechRecognitionEventArgs=To;var Vl=class extends gy.RecognitionEventArgs{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}};hr.ConversationTranscriptionEventArgs=Vl;var Ul=class extends To{};hr.MeetingTranscriptionEventArgs=Ul});var Ii=p(Oo=>{"use strict";Object.defineProperty(Oo,"__esModule",{value:!0});Oo.CancellationEventArgsBase=void 0;var MI=f(),Wl=class extends MI.RecognitionEventArgs{constructor(e,t,r,n,s){super(n,s),this.privReason=e,this.privErrorDetails=t,this.privErrorCode=r}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};Oo.CancellationEventArgsBase=Wl});var yy=p(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.SpeechRecognitionCanceledEventArgs=void 0;var DI=Ii(),Hl=class extends DI.CancellationEventArgsBase{};ko.SpeechRecognitionCanceledEventArgs=Hl});var Sy=p(Mo=>{"use strict";Object.defineProperty(Mo,"__esModule",{value:!0});Mo.TranslationRecognitionEventArgs=void 0;var xI=f(),Kl=class extends xI.RecognitionEventArgs{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}};Mo.TranslationRecognitionEventArgs=Kl});var Cy=p(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});Do.TranslationSynthesisEventArgs=void 0;var NI=f(),Jl=class extends NI.SessionEventArgs{constructor(e,t){super(t),this.privResult=e}get result(){return this.privResult}};Do.TranslationSynthesisEventArgs=Jl});var $l=p(xo=>{"use strict";Object.defineProperty(xo,"__esModule",{value:!0});xo.TranslationRecognitionResult=void 0;var qI=f(),Gl=class i extends qI.SpeechRecognitionResult{constructor(e,t,r,n,s,o,a,c,u,l,h){super(t,r,n,s,o,a,c,void 0,u,l,h),this.privTranslations=e}static fromSpeechRecognitionResult(e){return new i(void 0,e.resultId,e.reason,e.text,e.duration,e.offset,e.language,e.languageDetectionConfidence,e.errorDetails,e.json,e.properties)}get translations(){return this.privTranslations}};xo.TranslationRecognitionResult=Gl});var Py=p(No=>{"use strict";Object.defineProperty(No,"__esModule",{value:!0});No.TranslationSynthesisResult=void 0;var Ql=class{constructor(e,t){this.privReason=e,this.privAudio=t}get audio(){return this.privAudio}get reason(){return this.privReason}};No.TranslationSynthesisResult=Ql});var Ry=p(Mn=>{"use strict";Object.defineProperty(Mn,"__esModule",{value:!0});Mn.ResultReason=void 0;var jI;(function(i){i[i.NoMatch=0]="NoMatch",i[i.Canceled=1]="Canceled",i[i.RecognizingSpeech=2]="RecognizingSpeech",i[i.RecognizedSpeech=3]="RecognizedSpeech",i[i.RecognizedKeyword=4]="RecognizedKeyword",i[i.RecognizingIntent=5]="RecognizingIntent",i[i.RecognizedIntent=6]="RecognizedIntent",i[i.TranslatingSpeech=7]="TranslatingSpeech",i[i.TranslatedSpeech=8]="TranslatedSpeech",i[i.SynthesizingAudio=9]="SynthesizingAudio",i[i.SynthesizingAudioCompleted=10]="SynthesizingAudioCompleted",i[i.SynthesizingAudioStarted=11]="SynthesizingAudioStarted",i[i.EnrollingVoiceProfile=12]="EnrollingVoiceProfile",i[i.EnrolledVoiceProfile=13]="EnrolledVoiceProfile",i[i.RecognizedSpeakers=14]="RecognizedSpeakers",i[i.RecognizedSpeaker=15]="RecognizedSpeaker",i[i.ResetVoiceProfile=16]="ResetVoiceProfile",i[i.DeletedVoiceProfile=17]="DeletedVoiceProfile",i[i.VoicesListRetrieved=18]="VoicesListRetrieved",i[i.TranslatingParticipantSpeech=19]="TranslatingParticipantSpeech",i[i.TranslatedParticipantSpeech=20]="TranslatedParticipantSpeech",i[i.TranslatedInstantMessage=21]="TranslatedInstantMessage",i[i.TranslatedParticipantInstantMessage=22]="TranslatedParticipantInstantMessage"})(jI=Mn.ResultReason||(Mn.ResultReason={}))});var Ey=p(wi=>{"use strict";Object.defineProperty(wi,"__esModule",{value:!0});wi.SpeechConfigImpl=wi.SpeechConfig=void 0;var Dn=C(),Vr=_(),I=f(),qo=class{constructor(){}static fromSubscription(e,t){Vr.Contracts.throwIfNullOrWhitespace(e,"subscriptionKey"),Vr.Contracts.throwIfNullOrWhitespace(t,"region");let r=new Ur;return r.setProperty(I.PropertyId.SpeechServiceConnection_Region,t),r.setProperty(I.PropertyId.SpeechServiceConnection_IntentRegion,t),r.setProperty(I.PropertyId.SpeechServiceConnection_Key,e),r}static fromEndpoint(e,t){Vr.Contracts.throwIfNull(e,"endpoint");let r=new Ur;return r.setProperty(I.PropertyId.SpeechServiceConnection_Endpoint,e.href),t!==void 0&&r.setProperty(I.PropertyId.SpeechServiceConnection_Key,t),r}static fromHost(e,t){Vr.Contracts.throwIfNull(e,"hostName");let r=new Ur;return r.setProperty(I.PropertyId.SpeechServiceConnection_Host,e.protocol+"//"+e.hostname+(e.port===""?"":":"+e.port)),t!==void 0&&r.setProperty(I.PropertyId.SpeechServiceConnection_Key,t),r}static fromAuthorizationToken(e,t){Vr.Contracts.throwIfNull(e,"authorizationToken"),Vr.Contracts.throwIfNullOrWhitespace(t,"region");let r=new Ur;return r.setProperty(I.PropertyId.SpeechServiceConnection_Region,t),r.setProperty(I.PropertyId.SpeechServiceConnection_IntentRegion,t),r.authorizationToken=e,r}close(){}};wi.SpeechConfig=qo;var Ur=class i extends qo{constructor(){super(),this.privProperties=new I.PropertyCollection,this.speechRecognitionLanguage="en-US",this.outputFormat=I.OutputFormat.Simple}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(I.PropertyId.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(I.PropertyId.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(I.PropertyId.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(I.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.privProperties.setProperty(I.PropertyId.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return this.privProperties.getProperty(I.PropertyId.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(e){this.privProperties.setProperty(I.PropertyId.SpeechServiceConnection_RecoLanguage,e)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(I.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(e){this.privProperties.setProperty(I.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,e)}get outputFormat(){return I.OutputFormat[this.privProperties.getProperty(Dn.OutputFormatPropertyName,void 0)]}set outputFormat(e){this.privProperties.setProperty(Dn.OutputFormatPropertyName,I.OutputFormat[e])}get endpointId(){return this.privProperties.getProperty(I.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(e){this.privProperties.setProperty(I.PropertyId.SpeechServiceConnection_EndpointId,e)}setProperty(e,t){Vr.Contracts.throwIfNull(t,"value"),this.privProperties.setProperty(e,t)}getProperty(e,t){return this.privProperties.getProperty(e,t)}setProxy(e,t,r,n){this.setProperty(I.PropertyId[I.PropertyId.SpeechServiceConnection_ProxyHostName],e),this.setProperty(I.PropertyId[I.PropertyId.SpeechServiceConnection_ProxyPort],t),this.setProperty(I.PropertyId[I.PropertyId.SpeechServiceConnection_ProxyUserName],r),this.setProperty(I.PropertyId[I.PropertyId.SpeechServiceConnection_ProxyPassword],n)}setServiceProperty(e,t){let r=JSON.parse(this.privProperties.getProperty(Dn.ServicePropertiesPropertyName,"{}"));r[e]=t,this.privProperties.setProperty(Dn.ServicePropertiesPropertyName,JSON.stringify(r))}setProfanity(e){this.privProperties.setProperty(I.PropertyId.SpeechServiceResponse_ProfanityOption,I.ProfanityOption[e])}enableAudioLogging(){this.privProperties.setProperty(I.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(I.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privProperties.setProperty(Dn.ForceDictationPropertyName,"true")}clone(){let e=new i;return e.privProperties=this.privProperties.clone(),e}get speechSynthesisLanguage(){return this.privProperties.getProperty(I.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(e){this.privProperties.setProperty(I.PropertyId.SpeechServiceConnection_SynthLanguage,e)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(I.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(e){this.privProperties.setProperty(I.PropertyId.SpeechServiceConnection_SynthVoice,e)}get speechSynthesisOutputFormat(){return I.SpeechSynthesisOutputFormat[this.privProperties.getProperty(I.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(e){this.privProperties.setProperty(I.PropertyId.SpeechServiceConnection_SynthOutputFormat,I.SpeechSynthesisOutputFormat[e])}};wi.SpeechConfigImpl=Ur});var _y=p(bi=>{"use strict";Object.defineProperty(bi,"__esModule",{value:!0});bi.SpeechTranslationConfigImpl=bi.SpeechTranslationConfig=void 0;var xn=C(),lt=_(),E=f(),jo=class extends E.SpeechConfig{constructor(){super()}static fromSubscription(e,t){lt.Contracts.throwIfNullOrWhitespace(e,"subscriptionKey"),lt.Contracts.throwIfNullOrWhitespace(t,"region");let r=new Wr;return r.properties.setProperty(E.PropertyId.SpeechServiceConnection_Key,e),r.properties.setProperty(E.PropertyId.SpeechServiceConnection_Region,t),r}static fromAuthorizationToken(e,t){lt.Contracts.throwIfNullOrWhitespace(e,"authorizationToken"),lt.Contracts.throwIfNullOrWhitespace(t,"region");let r=new Wr;return r.properties.setProperty(E.PropertyId.SpeechServiceAuthorization_Token,e),r.properties.setProperty(E.PropertyId.SpeechServiceConnection_Region,t),r}static fromHost(e,t){lt.Contracts.throwIfNull(e,"hostName");let r=new Wr;return r.setProperty(E.PropertyId.SpeechServiceConnection_Host,e.protocol+"//"+e.hostname+(e.port===""?"":":"+e.port)),t!==void 0&&r.setProperty(E.PropertyId.SpeechServiceConnection_Key,t),r}static fromEndpoint(e,t){lt.Contracts.throwIfNull(e,"endpoint"),lt.Contracts.throwIfNull(t,"subscriptionKey");let r=new Wr;return r.properties.setProperty(E.PropertyId.SpeechServiceConnection_Endpoint,e.href),r.properties.setProperty(E.PropertyId.SpeechServiceConnection_Key,t),r}};bi.SpeechTranslationConfig=jo;var Wr=class extends jo{constructor(){super(),this.privSpeechProperties=new E.PropertyCollection,this.outputFormat=E.OutputFormat.Simple}set authorizationToken(e){lt.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(E.PropertyId.SpeechServiceAuthorization_Token,e)}set speechRecognitionLanguage(e){lt.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(E.PropertyId.SpeechServiceConnection_RecoLanguage,e)}get speechRecognitionLanguage(){return this.privSpeechProperties.getProperty(E.PropertyId[E.PropertyId.SpeechServiceConnection_RecoLanguage])}get subscriptionKey(){return this.privSpeechProperties.getProperty(E.PropertyId[E.PropertyId.SpeechServiceConnection_Key])}get outputFormat(){return E.OutputFormat[this.privSpeechProperties.getProperty(xn.OutputFormatPropertyName,void 0)]}set outputFormat(e){this.privSpeechProperties.setProperty(xn.OutputFormatPropertyName,E.OutputFormat[e])}get endpointId(){return this.privSpeechProperties.getProperty(E.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(e){this.privSpeechProperties.setProperty(E.PropertyId.SpeechServiceConnection_EndpointId,e)}addTargetLanguage(e){lt.Contracts.throwIfNullOrWhitespace(e,"value");let t=this.targetLanguages;t.includes(e)||(t.push(e),this.privSpeechProperties.setProperty(E.PropertyId.SpeechServiceConnection_TranslationToLanguages,t.join(",")))}get targetLanguages(){return this.privSpeechProperties.getProperty(E.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?this.privSpeechProperties.getProperty(E.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(E.PropertyId[E.PropertyId.SpeechServiceConnection_TranslationVoice])}set voiceName(e){lt.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(E.PropertyId.SpeechServiceConnection_TranslationVoice,e)}get region(){return this.privSpeechProperties.getProperty(E.PropertyId.SpeechServiceConnection_Region)}setProxy(e,t,r,n){this.setProperty(E.PropertyId[E.PropertyId.SpeechServiceConnection_ProxyHostName],e),this.setProperty(E.PropertyId[E.PropertyId.SpeechServiceConnection_ProxyPort],t),this.setProperty(E.PropertyId[E.PropertyId.SpeechServiceConnection_ProxyUserName],r),this.setProperty(E.PropertyId[E.PropertyId.SpeechServiceConnection_ProxyPassword],n)}getProperty(e,t){return this.privSpeechProperties.getProperty(e,t)}setProperty(e,t){this.privSpeechProperties.setProperty(e,t)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(e,t){let r=JSON.parse(this.privSpeechProperties.getProperty(xn.ServicePropertiesPropertyName,"{}"));r[e]=t,this.privSpeechProperties.setProperty(xn.ServicePropertiesPropertyName,JSON.stringify(r))}setProfanity(e){this.privSpeechProperties.setProperty(E.PropertyId.SpeechServiceResponse_ProfanityOption,E.ProfanityOption[e])}enableAudioLogging(){this.privSpeechProperties.setProperty(E.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(E.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(xn.ForceDictationPropertyName,"true")}get speechSynthesisLanguage(){return this.privSpeechProperties.getProperty(E.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(e){this.privSpeechProperties.setProperty(E.PropertyId.SpeechServiceConnection_SynthLanguage,e)}get speechSynthesisVoiceName(){return this.privSpeechProperties.getProperty(E.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(e){this.privSpeechProperties.setProperty(E.PropertyId.SpeechServiceConnection_SynthVoice,e)}get speechSynthesisOutputFormat(){return E.SpeechSynthesisOutputFormat[this.privSpeechProperties.getProperty(E.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(e){this.privSpeechProperties.setProperty(E.PropertyId.SpeechServiceConnection_SynthOutputFormat,E.SpeechSynthesisOutputFormat[e])}};bi.SpeechTranslationConfigImpl=Wr});var Zl=p(zo=>{"use strict";Object.defineProperty(zo,"__esModule",{value:!0});zo.PropertyCollection=void 0;var Iy=f(),Xl=class i{constructor(){this.privKeys=[],this.privValues=[]}getProperty(e,t){let r;typeof e=="string"?r=e:r=Iy.PropertyId[e];for(let n=0;n<this.privKeys.length;n++)if(this.privKeys[n]===r)return this.privValues[n];if(t!==void 0)return String(t)}setProperty(e,t){let r;typeof e=="string"?r=e:r=Iy.PropertyId[e];for(let n=0;n<this.privKeys.length;n++)if(this.privKeys[n]===r){this.privValues[n]=t;return}this.privKeys.push(r),this.privValues.push(t)}clone(){let e=new i;for(let t=0;t<this.privKeys.length;t++)e.privKeys.push(this.privKeys[t]),e.privValues.push(this.privValues[t]);return e}mergeTo(e){this.privKeys.forEach(t=>{if(e.getProperty(t,void 0)===void 0){let r=this.getProperty(t);e.setProperty(t,r)}})}get keys(){return this.privKeys}};zo.PropertyCollection=Xl});var Lo=p(Nn=>{"use strict";Object.defineProperty(Nn,"__esModule",{value:!0});Nn.PropertyId=void 0;var zI;(function(i){i[i.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",i[i.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",i[i.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",i[i.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",i[i.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",i[i.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",i[i.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",i[i.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",i[i.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",i[i.SpeechServiceConnection_IntentRegion=9]="SpeechServiceConnection_IntentRegion",i[i.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",i[i.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",i[i.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",i[i.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",i[i.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",i[i.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",i[i.Speech_SessionId=16]="Speech_SessionId",i[i.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",i[i.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",i[i.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",i[i.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",i[i.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",i[i.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",i[i.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",i[i.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",i[i.CancellationDetails_Reason=25]="CancellationDetails_Reason",i[i.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",i[i.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",i[i.LanguageUnderstandingServiceResponse_JsonResult=28]="LanguageUnderstandingServiceResponse_JsonResult",i[i.SpeechServiceConnection_Url=29]="SpeechServiceConnection_Url",i[i.SpeechServiceConnection_InitialSilenceTimeoutMs=30]="SpeechServiceConnection_InitialSilenceTimeoutMs",i[i.SpeechServiceConnection_EndSilenceTimeoutMs=31]="SpeechServiceConnection_EndSilenceTimeoutMs",i[i.Speech_SegmentationSilenceTimeoutMs=32]="Speech_SegmentationSilenceTimeoutMs",i[i.SpeechServiceConnection_EnableAudioLogging=33]="SpeechServiceConnection_EnableAudioLogging",i[i.SpeechServiceConnection_LanguageIdMode=34]="SpeechServiceConnection_LanguageIdMode",i[i.SpeechServiceConnection_RecognitionEndpointVersion=35]="SpeechServiceConnection_RecognitionEndpointVersion",i[i.SpeechServiceConnection_SpeakerIdMode=36]="SpeechServiceConnection_SpeakerIdMode",i[i.SpeechServiceResponse_ProfanityOption=37]="SpeechServiceResponse_ProfanityOption",i[i.SpeechServiceResponse_PostProcessingOption=38]="SpeechServiceResponse_PostProcessingOption",i[i.SpeechServiceResponse_RequestWordLevelTimestamps=39]="SpeechServiceResponse_RequestWordLevelTimestamps",i[i.SpeechServiceResponse_StablePartialResultThreshold=40]="SpeechServiceResponse_StablePartialResultThreshold",i[i.SpeechServiceResponse_OutputFormatOption=41]="SpeechServiceResponse_OutputFormatOption",i[i.SpeechServiceResponse_TranslationRequestStablePartialResult=42]="SpeechServiceResponse_TranslationRequestStablePartialResult",i[i.SpeechServiceResponse_RequestWordBoundary=43]="SpeechServiceResponse_RequestWordBoundary",i[i.SpeechServiceResponse_RequestPunctuationBoundary=44]="SpeechServiceResponse_RequestPunctuationBoundary",i[i.SpeechServiceResponse_RequestSentenceBoundary=45]="SpeechServiceResponse_RequestSentenceBoundary",i[i.Conversation_ApplicationId=46]="Conversation_ApplicationId",i[i.Conversation_DialogType=47]="Conversation_DialogType",i[i.Conversation_Initial_Silence_Timeout=48]="Conversation_Initial_Silence_Timeout",i[i.Conversation_From_Id=49]="Conversation_From_Id",i[i.Conversation_Conversation_Id=50]="Conversation_Conversation_Id",i[i.Conversation_Custom_Voice_Deployment_Ids=51]="Conversation_Custom_Voice_Deployment_Ids",i[i.Conversation_Speech_Activity_Template=52]="Conversation_Speech_Activity_Template",i[i.Conversation_Request_Bot_Status_Messages=53]="Conversation_Request_Bot_Status_Messages",i[i.Conversation_Agent_Connection_Id=54]="Conversation_Agent_Connection_Id",i[i.SpeechServiceConnection_Host=55]="SpeechServiceConnection_Host",i[i.ConversationTranslator_Host=56]="ConversationTranslator_Host",i[i.ConversationTranslator_Name=57]="ConversationTranslator_Name",i[i.ConversationTranslator_CorrelationId=58]="ConversationTranslator_CorrelationId",i[i.ConversationTranslator_Token=59]="ConversationTranslator_Token",i[i.PronunciationAssessment_ReferenceText=60]="PronunciationAssessment_ReferenceText",i[i.PronunciationAssessment_GradingSystem=61]="PronunciationAssessment_GradingSystem",i[i.PronunciationAssessment_Granularity=62]="PronunciationAssessment_Granularity",i[i.PronunciationAssessment_EnableMiscue=63]="PronunciationAssessment_EnableMiscue",i[i.PronunciationAssessment_Json=64]="PronunciationAssessment_Json",i[i.PronunciationAssessment_Params=65]="PronunciationAssessment_Params",i[i.SpeakerRecognition_Api_Version=66]="SpeakerRecognition_Api_Version",i[i.WebWorkerLoadType=67]="WebWorkerLoadType",i[i.TalkingAvatarService_WebRTC_SDP=68]="TalkingAvatarService_WebRTC_SDP"})(zI=Nn.PropertyId||(Nn.PropertyId={}))});var by=p(Vo=>{"use strict";Object.defineProperty(Vo,"__esModule",{value:!0});Vo.Recognizer=void 0;var Hr=C(),wy=P(),Bo=_(),Fo=f(),Yl=class i{constructor(e,t,r){this.audioConfig=e!==void 0?e:Fo.AudioConfig.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=t.clone(),this.privConnectionFactory=r,this.implCommonRecognizerSetup()}close(e,t){Bo.Contracts.throwIfDisposed(this.privDisposed),wy.marshalPromiseToCallbacks(this.dispose(!0),e,t)}get internalData(){return this.privReco}async dispose(e){this.privDisposed||(this.privDisposed=!0,e&&this.privReco&&(await this.privReco.audioSource.turnOff(),await this.privReco.dispose()))}static get telemetryEnabled(){return Hr.ServiceRecognizerBase.telemetryDataEnabled}static enableTelemetry(e){Hr.ServiceRecognizerBase.telemetryDataEnabled=e}implCommonRecognizerSetup(){let e=typeof window<"u"?"Browser":"Node",t="unknown",r="unknown";typeof navigator<"u"&&(e=e+"/"+navigator.platform,t=navigator.userAgent,r=navigator.appVersion);let n=this.createRecognizerConfig(new Hr.SpeechServiceConfig(new Hr.Context(new Hr.OS(e,t,r))));this.privReco=this.createServiceRecognizer(i.getAuthFromProperties(this.privProperties),this.privConnectionFactory,this.audioConfig,n)}async recognizeOnceAsyncImpl(e){Bo.Contracts.throwIfDisposed(this.privDisposed);let t=new wy.Deferred;await this.implRecognizerStop(),await this.privReco.recognize(e,t.resolve,t.reject);let r=await t.promise;return await this.implRecognizerStop(),r}async startContinuousRecognitionAsyncImpl(e){Bo.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop(),await this.privReco.recognize(e,void 0,void 0)}async stopContinuousRecognitionAsyncImpl(){Bo.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop()}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}static getAuthFromProperties(e){let t=e.getProperty(Fo.PropertyId.SpeechServiceConnection_Key,void 0);return t&&t!==""?new Hr.CognitiveSubscriptionKeyAuthentication(t):new Hr.CognitiveTokenAuthentication(()=>{let n=e.getProperty(Fo.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(n)},()=>{let n=e.getProperty(Fo.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(n)})}};Vo.Recognizer=Yl});var Ay=p(Wo=>{"use strict";Object.defineProperty(Wo,"__esModule",{value:!0});Wo.SpeechRecognizer=void 0;var Ai=C(),Uo=P(),dr=_(),Ne=f(),eh=class i extends Ne.Recognizer{constructor(e,t){let r=e;dr.Contracts.throwIfNull(r,"speechConfig"),dr.Contracts.throwIfNullOrWhitespace(r.properties.getProperty(Ne.PropertyId.SpeechServiceConnection_RecoLanguage),Ne.PropertyId[Ne.PropertyId.SpeechServiceConnection_RecoLanguage]),super(t,r.properties,new Ai.SpeechConnectionFactory),this.privDisposedRecognizer=!1}static FromConfig(e,t,r){let n=e;return t.properties.mergeTo(n.properties),new i(e,r)}get endpointId(){return dr.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Ne.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(Ne.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){dr.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Ne.PropertyId.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return dr.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Ne.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return dr.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Ai.OutputFormatPropertyName,Ne.OutputFormat[Ne.OutputFormat.Simple])===Ne.OutputFormat[Ne.OutputFormat.Simple]?Ne.OutputFormat.Simple:Ne.OutputFormat.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(e,t){Uo.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(Ai.RecognitionMode.Interactive),e,t)}startContinuousRecognitionAsync(e,t){Uo.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(Ai.RecognitionMode.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){Uo.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),e,t)}startKeywordRecognitionAsync(e,t,r){dr.Contracts.throwIfNull(e,"model"),r&&r("Not yet implemented.")}stopKeywordRecognitionAsync(e){e&&e()}close(e,t){dr.Contracts.throwIfDisposed(this.privDisposedRecognizer),Uo.marshalPromiseToCallbacks(this.dispose(!0),e,t)}async dispose(e){this.privDisposedRecognizer||(e&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(e))}createRecognizerConfig(e){return new Ai.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,r,n){let s=r;return new Ai.SpeechServiceRecognizer(e,t,s,n,this)}};Wo.SpeechRecognizer=eh});var Ty=p(Ko=>{"use strict";Object.defineProperty(Ko,"__esModule",{value:!0});Ko.IntentRecognizer=void 0;var Kr=C(),Ho=P(),we=_(),Jt=f(),th=class extends Jt.Recognizer{constructor(e,t){we.Contracts.throwIfNullOrUndefined(e,"speechConfig");let r=e;we.Contracts.throwIfNullOrUndefined(r,"speechConfig"),super(t,r.properties,new Kr.IntentConnectionFactory),this.privAddedIntents=[],this.privAddedLmIntents={},this.privDisposedIntentRecognizer=!1,this.privProperties=r.properties,we.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(Jt.PropertyId.SpeechServiceConnection_RecoLanguage),Jt.PropertyId[Jt.PropertyId.SpeechServiceConnection_RecoLanguage])}get speechRecognitionLanguage(){return we.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),this.properties.getProperty(Jt.PropertyId.SpeechServiceConnection_RecoLanguage)}get authorizationToken(){return this.properties.getProperty(Jt.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.properties.setProperty(Jt.PropertyId.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}recognizeOnceAsync(e,t){if(we.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){let r=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",r.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(r.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}Ho.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(Kr.RecognitionMode.Interactive),e,t)}startContinuousRecognitionAsync(e,t){if(Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){let r=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",r.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(r.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}Ho.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(Kr.RecognitionMode.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){Ho.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),e,t)}startKeywordRecognitionAsync(e,t,r){we.Contracts.throwIfNull(e,"model"),r&&r("Not yet implemented.")}stopKeywordRecognitionAsync(e,t){if(e)try{e()}catch(r){t&&t(r)}}addIntent(e,t){we.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),we.Contracts.throwIfNullOrWhitespace(t,"intentId"),we.Contracts.throwIfNullOrWhitespace(e,"simplePhrase"),this.privAddedIntents.push([t,e])}addIntentWithLanguageModel(e,t,r){we.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),we.Contracts.throwIfNullOrWhitespace(e,"intentId"),we.Contracts.throwIfNull(t,"model");let n=t;we.Contracts.throwIfNullOrWhitespace(n.appId,"model.appId"),this.privAddedLmIntents[e]=new Kr.AddedLmIntent(n,r)}addAllIntents(e,t){we.Contracts.throwIfNull(e,"model");let r=e;we.Contracts.throwIfNullOrWhitespace(r.appId,"model.appId"),this.privUmbrellaIntent=new Kr.AddedLmIntent(r,t)}close(e,t){we.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),Ho.marshalPromiseToCallbacks(this.dispose(!0),e,t)}createRecognizerConfig(e){return new Kr.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,r,n){let s=r;return new Kr.IntentServiceRecognizer(e,t,s,n,this)}async dispose(e){this.privDisposedIntentRecognizer||e&&(this.privDisposedIntentRecognizer=!0,await super.dispose(e))}buildSpeechContext(){let e,t,r,n=[];this.privUmbrellaIntent!==void 0&&(e=this.privUmbrellaIntent.modelImpl.appId,t=this.privUmbrellaIntent.modelImpl.region,r=this.privUmbrellaIntent.modelImpl.subscriptionKey);for(let s of Object.keys(this.privAddedLmIntents)){let o=this.privAddedLmIntents[s];if(e===void 0)e=o.modelImpl.appId;else if(e!==o.modelImpl.appId)throw new Error("Intents must all be from the same LUIS model");if(t===void 0)t=o.modelImpl.region;else if(t!==o.modelImpl.region)throw new Error("Intents must all be from the same LUIS model in a single region");if(r===void 0)r=o.modelImpl.subscriptionKey;else if(r!==o.modelImpl.subscriptionKey)throw new Error("Intents must all use the same subscription key");let a="luis/"+e+"-PRODUCTION#"+s;n.push(a)}return{Intent:{id:e,key:r===void 0?this.privProperties.getProperty(Jt.PropertyId[Jt.PropertyId.SpeechServiceConnection_Key]):r,provider:"LUIS"},ReferenceGrammars:this.privUmbrellaIntent===void 0?n:["luis/"+e+"-PRODUCTION"]}}};Ko.IntentRecognizer=th});var Oy=p(qn=>{"use strict";Object.defineProperty(qn,"__esModule",{value:!0});qn.VoiceProfileType=void 0;var LI;(function(i){i[i.TextIndependentIdentification=0]="TextIndependentIdentification",i[i.TextDependentVerification=1]="TextDependentVerification",i[i.TextIndependentVerification=2]="TextIndependentVerification"})(LI=qn.VoiceProfileType||(qn.VoiceProfileType={}))});var nh=p(Ti=>{"use strict";Object.defineProperty(Ti,"__esModule",{value:!0});Ti.ConnectionMessageImpl=Ti.ConnectionMessage=void 0;var ky=Ie(),My=P(),BI=Zl(),FI=Lo(),rh=class{};Ti.ConnectionMessage=rh;var ih=class{constructor(e){this.privConnectionMessage=e,this.privProperties=new BI.PropertyCollection,this.privConnectionMessage.headers[ky.HeaderNames.ConnectionId]&&this.privProperties.setProperty(FI.PropertyId.Speech_SessionId,this.privConnectionMessage.headers[ky.HeaderNames.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach(t=>{this.privProperties.setProperty(t,this.privConnectionMessage.headers[t])})}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find(e=>e.toLowerCase()==="path".toLowerCase())]}get isTextMessage(){return this.privConnectionMessage.messageType===My.MessageType.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===My.MessageType.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}};Ti.ConnectionMessageImpl=ih});var ch=p(Jo=>{"use strict";Object.defineProperty(Jo,"__esModule",{value:!0});Jo.Connection=void 0;var sh=C(),oh=P(),Dy=nh(),VI=_(),jn=f(),ah=class i{static fromRecognizer(e){let t=e.internalData,r=new i;return r.privInternalData=t,r.setupEvents(),r}static fromSynthesizer(e){let t=e.internalData,r=new i;return r.privInternalData=t,r.setupEvents(),r}openConnection(e,t){oh.marshalPromiseToCallbacks(this.privInternalData.connect(),e,t)}closeConnection(e,t){if(this.privInternalData instanceof sh.SynthesisAdapterBase)throw new Error("Disconnecting a synthesizer's connection is currently not supported");oh.marshalPromiseToCallbacks(this.privInternalData.disconnect(),e,t)}setMessageProperty(e,t,r){if(VI.Contracts.throwIfNullOrWhitespace(t,"propertyName"),this.privInternalData instanceof sh.ServiceRecognizerBase){if(e.toLowerCase()!=="speech.context")throw new Error("Only speech.context message property sets are currently supported for recognizer");this.privInternalData.speechContext.setSection(t,r)}else if(this.privInternalData instanceof sh.SynthesisAdapterBase){if(e.toLowerCase()!=="synthesis.context")throw new Error("Only synthesis.context message property sets are currently supported for synthesizer");this.privInternalData.synthesisContext.setSection(t,r)}}sendMessageAsync(e,t,r,n){oh.marshalPromiseToCallbacks(this.privInternalData.sendNetworkMessage(e,t),r,n)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach(e=>{e.name==="ConnectionEstablishedEvent"?this.connected&&this.connected(new jn.ConnectionEventArgs(e.connectionId)):e.name==="ConnectionClosedEvent"?this.disconnected&&this.disconnected(new jn.ConnectionEventArgs(e.connectionId)):e.name==="ConnectionMessageSentEvent"?this.messageSent&&this.messageSent(new jn.ConnectionMessageEventArgs(new Dy.ConnectionMessageImpl(e.message))):e.name==="ConnectionMessageReceivedEvent"&&this.messageReceived&&this.messageReceived(new jn.ConnectionMessageEventArgs(new Dy.ConnectionMessageImpl(e.message)))}),this.privServiceEventListener=this.privInternalData.serviceEvents.attach(e=>{this.receivedServiceMessage&&this.receivedServiceMessage(new jn.ServiceEventArgs(e.jsonString,e.name))})}};Jo.Connection=ah});var xy=p($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});$o.TranslationRecognizer=void 0;var zn=C(),Go=P(),UI=ch(),ht=_(),J=f(),uh=class i extends J.Recognizer{constructor(e,t,r){let n=e;ht.Contracts.throwIfNull(n,"speechConfig"),super(t,n.properties,r||new zn.TranslationConnectionFactory),this.privDisposedTranslationRecognizer=!1,this.properties.getProperty(J.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&ht.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(J.PropertyId.SpeechServiceConnection_TranslationVoice),J.PropertyId[J.PropertyId.SpeechServiceConnection_TranslationVoice]),ht.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(J.PropertyId.SpeechServiceConnection_TranslationToLanguages),J.PropertyId[J.PropertyId.SpeechServiceConnection_TranslationToLanguages]),ht.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(J.PropertyId.SpeechServiceConnection_RecoLanguage),J.PropertyId[J.PropertyId.SpeechServiceConnection_RecoLanguage])}static FromConfig(e,t,r){let n=e;return t.properties.mergeTo(n.properties),new i(e,r)}get speechRecognitionLanguage(){return ht.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(J.PropertyId.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return ht.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(J.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return ht.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(J.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(J.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.properties.setProperty(J.PropertyId.SpeechServiceAuthorization_Token,e)}recognizeOnceAsync(e,t){ht.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),Go.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(zn.RecognitionMode.Interactive),e,t)}startContinuousRecognitionAsync(e,t){Go.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(zn.RecognitionMode.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){Go.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),e,t)}removeTargetLanguage(e){if(ht.Contracts.throwIfNullOrUndefined(e,"language to be removed"),this.properties.getProperty(J.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0){let t=this.properties.getProperty(J.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),r=t.indexOf(e);r>-1&&(t.splice(r,1),this.properties.setProperty(J.PropertyId.SpeechServiceConnection_TranslationToLanguages,t.join(",")),this.updateLanguages(t))}}addTargetLanguage(e){ht.Contracts.throwIfNullOrUndefined(e,"language to be added");let t=[];this.properties.getProperty(J.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?(t=this.properties.getProperty(J.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),t.includes(e)||(t.push(e),this.properties.setProperty(J.PropertyId.SpeechServiceConnection_TranslationToLanguages,t.join(",")))):(this.properties.setProperty(J.PropertyId.SpeechServiceConnection_TranslationToLanguages,e),t=[e]),this.updateLanguages(t)}close(e,t){ht.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),Go.marshalPromiseToCallbacks(this.dispose(!0),e,t)}onConnection(){}async dispose(e){this.privDisposedTranslationRecognizer||(this.privDisposedTranslationRecognizer=!0,e&&(await this.implRecognizerStop(),await super.dispose(e)))}createRecognizerConfig(e){return new zn.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,r,n){let s=r;return new zn.TranslationServiceRecognizer(e,t,s,n,this)}updateLanguages(e){let t=UI.Connection.fromRecognizer(this);t&&(t.setMessageProperty("speech.context","translationcontext",{to:e}),t.sendMessageAsync("event",JSON.stringify({id:"translation",name:"updateLanguage",to:e})))}};$o.TranslationRecognizer=uh});var Ny=p(Qo=>{"use strict";Object.defineProperty(Qo,"__esModule",{value:!0});Qo.Translations=void 0;var WI=f(),ph=class{constructor(){this.privMap=new WI.PropertyCollection}get languages(){return this.privMap.keys}get(e,t){return this.privMap.getProperty(e,t)}set(e,t){this.privMap.setProperty(e,t)}};Qo.Translations=ph});var qy=p(Ln=>{"use strict";Object.defineProperty(Ln,"__esModule",{value:!0});Ln.NoMatchReason=void 0;var HI;(function(i){i[i.NotRecognized=0]="NotRecognized",i[i.InitialSilenceTimeout=1]="InitialSilenceTimeout",i[i.InitialBabbleTimeout=2]="InitialBabbleTimeout"})(HI=Ln.NoMatchReason||(Ln.NoMatchReason={}))});var jy=p(Zo=>{"use strict";Object.defineProperty(Zo,"__esModule",{value:!0});Zo.NoMatchDetails=void 0;var lh=C(),Xo=f(),hh=class i{constructor(e){this.privReason=e}static fromResult(e){let t=lh.SimpleSpeechPhrase.fromJSON(e.json),r=Xo.NoMatchReason.NotRecognized;switch(t.RecognitionStatus){case lh.RecognitionStatus.BabbleTimeout:r=Xo.NoMatchReason.InitialBabbleTimeout;break;case lh.RecognitionStatus.InitialSilenceTimeout:r=Xo.NoMatchReason.InitialSilenceTimeout;break;default:r=Xo.NoMatchReason.NotRecognized;break}return new i(r)}get reason(){return this.privReason}};Zo.NoMatchDetails=hh});var zy=p(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});Yo.TranslationRecognitionCanceledEventArgs=void 0;var dh=class{constructor(e,t,r,n,s){this.privCancelReason=t,this.privErrorDetails=r,this.privResult=s,this.privSessionId=e,this.privErrorCode=n}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};Yo.TranslationRecognitionCanceledEventArgs=dh});var Ly=p(ea=>{"use strict";Object.defineProperty(ea,"__esModule",{value:!0});ea.IntentRecognitionCanceledEventArgs=void 0;var KI=f(),vh=class extends KI.IntentRecognitionEventArgs{constructor(e,t,r,n,s,o){super(n,s,o),this.privReason=e,this.privErrorDetails=t,this.privErrorCode=r}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};ea.IntentRecognitionCanceledEventArgs=vh});var gh=p(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});ta.CancellationDetailsBase=void 0;var fh=class{constructor(e,t,r){this.privReason=e,this.privErrorDetails=t,this.privErrorCode=r}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}};ta.CancellationDetailsBase=fh});var By=p(ia=>{"use strict";Object.defineProperty(ia,"__esModule",{value:!0});ia.CancellationDetails=void 0;var ra=C(),JI=gh(),Oi=f(),mh=class i extends JI.CancellationDetailsBase{constructor(e,t,r){super(e,t,r)}static fromResult(e){let t=Oi.CancellationReason.Error,r=Oi.CancellationErrorCode.NoError;if(e instanceof Oi.RecognitionResult&&e.json){let n=ra.SimpleSpeechPhrase.fromJSON(e.json);t=ra.EnumTranslation.implTranslateCancelResult(n.RecognitionStatus)}return e.properties&&(r=Oi.CancellationErrorCode[e.properties.getProperty(ra.CancellationErrorCodePropertyName,Oi.CancellationErrorCode[Oi.CancellationErrorCode.NoError])]),new i(t,e.errorDetails||ra.EnumTranslation.implTranslateErrorDetails(r),r)}};ia.CancellationDetails=mh});var Fy=p(Bn=>{"use strict";Object.defineProperty(Bn,"__esModule",{value:!0});Bn.CancellationErrorCode=void 0;var GI;(function(i){i[i.NoError=0]="NoError",i[i.AuthenticationFailure=1]="AuthenticationFailure",i[i.BadRequestParameters=2]="BadRequestParameters",i[i.TooManyRequests=3]="TooManyRequests",i[i.ConnectionFailure=4]="ConnectionFailure",i[i.ServiceTimeout=5]="ServiceTimeout",i[i.ServiceError=6]="ServiceError",i[i.RuntimeError=7]="RuntimeError",i[i.Forbidden=8]="Forbidden"})(GI=Bn.CancellationErrorCode||(Bn.CancellationErrorCode={}))});var Vy=p(na=>{"use strict";Object.defineProperty(na,"__esModule",{value:!0});na.ConnectionEventArgs=void 0;var $I=f(),yh=class extends $I.SessionEventArgs{};na.ConnectionEventArgs=yh});var Uy=p(sa=>{"use strict";Object.defineProperty(sa,"__esModule",{value:!0});sa.ServiceEventArgs=void 0;var QI=f(),Sh=class extends QI.SessionEventArgs{constructor(e,t,r){super(r),this.privJsonResult=e,this.privEventName=t}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}};sa.ServiceEventArgs=Sh});var Wy=p(oa=>{"use strict";Object.defineProperty(oa,"__esModule",{value:!0});oa.PhraseListGrammar=void 0;var Ch=class i{constructor(e){this.privGrammerBuilder=e.dynamicGrammar}static fromRecognizer(e){let t=e.internalData;return new i(t)}addPhrase(e){this.privGrammerBuilder.addPhrase(e)}addPhrases(e){this.privGrammerBuilder.addPhrase(e)}clear(){this.privGrammerBuilder.clearPhrases()}};oa.PhraseListGrammar=Ch});var ca=p(ki=>{"use strict";Object.defineProperty(ki,"__esModule",{value:!0});ki.DialogServiceConfigImpl=ki.DialogServiceConfig=void 0;var XI=_(),Fn=f(),aa=class{constructor(){}set applicationId(e){}static get DialogTypes(){return{BotFramework:"bot_framework",CustomCommands:"custom_commands"}}};ki.DialogServiceConfig=aa;var Ph=class extends aa{constructor(){super(),this.privSpeechConfig=new Fn.SpeechConfigImpl}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(e){XI.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechConfig.speechRecognitionLanguage=e}get outputFormat(){return this.privSpeechConfig.outputFormat}set outputFormat(e){this.privSpeechConfig.outputFormat=e}setProperty(e,t){this.privSpeechConfig.setProperty(e,t)}getProperty(e,t){return this.privSpeechConfig.getProperty(e)}setProxy(e,t,r,n){this.setProperty(Fn.PropertyId.SpeechServiceConnection_ProxyHostName,e),this.setProperty(Fn.PropertyId.SpeechServiceConnection_ProxyPort,`${t}`),r&&this.setProperty(Fn.PropertyId.SpeechServiceConnection_ProxyUserName,r),n&&this.setProperty(Fn.PropertyId.SpeechServiceConnection_ProxyPassword,n)}setServiceProperty(e,t,r){this.privSpeechConfig.setServiceProperty(e,t)}close(){}};ki.DialogServiceConfigImpl=Ph});var Hy=p(ua=>{"use strict";Object.defineProperty(ua,"__esModule",{value:!0});ua.BotFrameworkConfig=void 0;var Jr=_(),Gt=ca(),qe=f(),Rh=class extends Gt.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(e,t,r){Jr.Contracts.throwIfNullOrWhitespace(e,"subscription"),Jr.Contracts.throwIfNullOrWhitespace(t,"region");let n=new Gt.DialogServiceConfigImpl;return n.setProperty(qe.PropertyId.Conversation_DialogType,Gt.DialogServiceConfig.DialogTypes.BotFramework),n.setProperty(qe.PropertyId.SpeechServiceConnection_Key,e),n.setProperty(qe.PropertyId.SpeechServiceConnection_Region,t),r&&n.setProperty(qe.PropertyId.Conversation_ApplicationId,r),n}static fromAuthorizationToken(e,t,r){Jr.Contracts.throwIfNullOrWhitespace(e,"authorizationToken"),Jr.Contracts.throwIfNullOrWhitespace(t,"region");let n=new Gt.DialogServiceConfigImpl;return n.setProperty(qe.PropertyId.Conversation_DialogType,Gt.DialogServiceConfig.DialogTypes.BotFramework),n.setProperty(qe.PropertyId.SpeechServiceAuthorization_Token,e),n.setProperty(qe.PropertyId.SpeechServiceConnection_Region,t),r&&n.setProperty(qe.PropertyId.Conversation_ApplicationId,r),n}static fromHost(e,t,r){Jr.Contracts.throwIfNullOrUndefined(e,"host");let n=e instanceof URL?e:new URL(`wss://${e}.convai.speech.azure.us`);Jr.Contracts.throwIfNullOrUndefined(n,"resolvedHost");let s=new Gt.DialogServiceConfigImpl;return s.setProperty(qe.PropertyId.Conversation_DialogType,Gt.DialogServiceConfig.DialogTypes.BotFramework),s.setProperty(qe.PropertyId.SpeechServiceConnection_Host,n.toString()),t!==void 0&&s.setProperty(qe.PropertyId.SpeechServiceConnection_Key,t),s}static fromEndpoint(e,t){Jr.Contracts.throwIfNull(e,"endpoint");let r=new Gt.DialogServiceConfigImpl;return r.setProperty(qe.PropertyId.Conversation_DialogType,Gt.DialogServiceConfig.DialogTypes.BotFramework),r.setProperty(qe.PropertyId.SpeechServiceConnection_Endpoint,e.toString()),t!==void 0&&r.setProperty(qe.PropertyId.SpeechServiceConnection_Key,t),r}};ua.BotFrameworkConfig=Rh});var Ky=p(pa=>{"use strict";Object.defineProperty(pa,"__esModule",{value:!0});pa.CustomCommandsConfig=void 0;var Gr=_(),Vn=ca(),wt=f(),Eh=class extends Vn.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(e,t,r){Gr.Contracts.throwIfNullOrWhitespace(e,"applicationId"),Gr.Contracts.throwIfNullOrWhitespace(t,"subscription"),Gr.Contracts.throwIfNullOrWhitespace(r,"region");let n=new Vn.DialogServiceConfigImpl;return n.setProperty(wt.PropertyId.Conversation_DialogType,Vn.DialogServiceConfig.DialogTypes.CustomCommands),n.setProperty(wt.PropertyId.Conversation_ApplicationId,e),n.setProperty(wt.PropertyId.SpeechServiceConnection_Key,t),n.setProperty(wt.PropertyId.SpeechServiceConnection_Region,r),n}static fromAuthorizationToken(e,t,r){Gr.Contracts.throwIfNullOrWhitespace(e,"applicationId"),Gr.Contracts.throwIfNullOrWhitespace(t,"authorizationToken"),Gr.Contracts.throwIfNullOrWhitespace(r,"region");let n=new Vn.DialogServiceConfigImpl;return n.setProperty(wt.PropertyId.Conversation_DialogType,Vn.DialogServiceConfig.DialogTypes.CustomCommands),n.setProperty(wt.PropertyId.Conversation_ApplicationId,e),n.setProperty(wt.PropertyId.SpeechServiceAuthorization_Token,t),n.setProperty(wt.PropertyId.SpeechServiceConnection_Region,r),n}set applicationId(e){Gr.Contracts.throwIfNullOrWhitespace(e,"value"),this.setProperty(wt.PropertyId.Conversation_ApplicationId,e)}get applicationId(){return this.getProperty(wt.PropertyId.Conversation_ApplicationId)}};pa.CustomCommandsConfig=Eh});var $t=p(la=>{"use strict";Object.defineProperty(la,"__esModule",{value:!0});la.QueryParameterNames=void 0;var W=class{};la.QueryParameterNames=W;W.BotId="botid";W.CustomSpeechDeploymentId="cid";W.CustomVoiceDeploymentId="deploymentId";W.EnableAudioLogging="storeAudio";W.EnableLanguageId="lidEnabled";W.EnableWordLevelTimestamps="wordLevelTimestamps";W.EndSilenceTimeoutMs="endSilenceTimeoutMs";W.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs";W.Format="format";W.InitialSilenceTimeoutMs="initialSilenceTimeoutMs";W.Language="language";W.Profanity="profanity";W.RequestBotStatusMessages="enableBotMessageStatus";W.StableIntermediateThreshold="stableIntermediateThreshold";W.StableTranslation="stableTranslation";W.TestHooks="testhooks";W.Postprocessing="postprocessing";W.CtsMeetingId="meetingId";W.CtsDeviceId="deviceId";W.CtsIsParticipant="isParticipant";W.EnableAvatar="enableTalkingAvatar"});var Ze=p(ha=>{"use strict";Object.defineProperty(ha,"__esModule",{value:!0});ha.ConnectionFactoryBase=void 0;var ZI=C(),vr=f(),fr=$t(),_h=class{static getHostSuffix(e){if(e){if(e.toLowerCase().startsWith("china"))return".azure.cn";if(e.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(e,t,r){new Map([[vr.PropertyId.Speech_SegmentationSilenceTimeoutMs,fr.QueryParameterNames.SegmentationSilenceTimeoutMs],[vr.PropertyId.SpeechServiceConnection_EnableAudioLogging,fr.QueryParameterNames.EnableAudioLogging],[vr.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,fr.QueryParameterNames.EndSilenceTimeoutMs],[vr.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,fr.QueryParameterNames.InitialSilenceTimeoutMs],[vr.PropertyId.SpeechServiceResponse_PostProcessingOption,fr.QueryParameterNames.Postprocessing],[vr.PropertyId.SpeechServiceResponse_ProfanityOption,fr.QueryParameterNames.Profanity],[vr.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,fr.QueryParameterNames.EnableWordLevelTimestamps],[vr.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,fr.QueryParameterNames.StableIntermediateThreshold]]).forEach((o,a)=>{this.setUrlParameter(a,o,e,t,r)});let s=JSON.parse(e.parameters.getProperty(ZI.ServicePropertiesPropertyName,"{}"));Object.keys(s).forEach(o=>{t[o]=s[o]})}setUrlParameter(e,t,r,n,s){let o=r.parameters.getProperty(e,void 0);o&&(!s||s.search(t)===-1)&&(n[t]=o.toLocaleLowerCase())}};ha.ConnectionFactoryBase=_h});var Qy=p(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});va.DialogConnectionFactory=void 0;var Jy=ce(),YI=C(),Ue=f(),Gy=Ze(),ew=C(),$y=Ie(),da=$t(),Un=class i extends Gy.ConnectionFactoryBase{create(e,t,r){let n=e.parameters.getProperty(Ue.PropertyId.Conversation_ApplicationId,""),s=e.parameters.getProperty(Ue.PropertyId.Conversation_DialogType),o=e.parameters.getProperty(Ue.PropertyId.SpeechServiceConnection_Region),a=e.parameters.getProperty(Ue.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),c=e.parameters.getProperty(Ue.PropertyId.Conversation_Request_Bot_Status_Messages,"true"),u={};u[$y.HeaderNames.ConnectionId]=r,u[da.QueryParameterNames.Format]=e.parameters.getProperty(YI.OutputFormatPropertyName,Ue.OutputFormat[Ue.OutputFormat.Simple]).toLowerCase(),u[da.QueryParameterNames.Language]=a,u[da.QueryParameterNames.RequestBotStatusMessages]=c,n&&(u[da.QueryParameterNames.BotId]=n,s===Ue.DialogServiceConfig.DialogTypes.CustomCommands&&(u[$y.HeaderNames.CustomCommandsAppId]=n));let l=s===Ue.DialogServiceConfig.DialogTypes.CustomCommands?"commands/":"",h=s===Ue.DialogServiceConfig.DialogTypes.CustomCommands?"v1":s===Ue.DialogServiceConfig.DialogTypes.BotFramework?"v3":"v0",d={};t.token!=null&&t.token!==""&&(d[t.headerName]=t.token);let g=e.parameters.getProperty(Ue.PropertyId.SpeechServiceConnection_Endpoint,"");if(!g){let D=Gy.ConnectionFactoryBase.getHostSuffix(o),oe=e.parameters.getProperty(Ue.PropertyId.SpeechServiceConnection_Host,`wss://${o}.${i.BaseUrl}${D}`);g=`${oe.endsWith("/")?oe:oe+"/"}${l}${i.ApiKey}/${h}`}this.setCommonUrlParams(e,u,g);let M=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new Jy.WebsocketConnection(g,u,d,new ew.WebsocketMessageFormatter,Jy.ProxyInfo.fromRecognizerConfig(e),M,r)}};va.DialogConnectionFactory=Un;Un.ApiKey="api";Un.BaseUrl="convai.speech"});var Xy=p(ga=>{"use strict";Object.defineProperty(ga,"__esModule",{value:!0});ga.DialogServiceConnector=void 0;var tw=Qy(),Ih=C(),Mi=P(),fa=_(),rw=f(),gr=Lo(),wh=class extends rw.Recognizer{constructor(e,t){let r=e;fa.Contracts.throwIfNull(e,"dialogConfig"),super(t,r.properties,new tw.DialogConnectionFactory),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=r.properties.clone();let n=this.buildAgentConfig();this.privReco.agentConfig.set(n)}connect(e,t){Mi.marshalPromiseToCallbacks(this.privReco.connect(),e,t)}disconnect(e,t){Mi.marshalPromiseToCallbacks(this.privReco.disconnect(),e,t)}get authorizationToken(){return this.properties.getProperty(gr.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){fa.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(gr.PropertyId.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(gr.PropertyId.Conversation_Speech_Activity_Template)}set speechActivityTemplate(e){this.properties.setProperty(gr.PropertyId.Conversation_Speech_Activity_Template,e)}listenOnceAsync(e,t){if(this.isTurnComplete){fa.Contracts.throwIfDisposed(this.privIsDisposed);let n=(async()=>{await this.privReco.connect(),await this.implRecognizerStop(),this.isTurnComplete=!1;let s=new Mi.Deferred;await this.privReco.recognize(Ih.RecognitionMode.Conversation,s.resolve,s.reject);let o=await s.promise;return await this.implRecognizerStop(),o})();n.catch(()=>{this.dispose(!0).catch(()=>{})}),Mi.marshalPromiseToCallbacks(n.finally(()=>{this.isTurnComplete=!0}),e,t)}}sendActivityAsync(e,t,r){Mi.marshalPromiseToCallbacks(this.privReco.sendMessage(e),t,r)}close(e,t){fa.Contracts.throwIfDisposed(this.privIsDisposed),Mi.marshalPromiseToCallbacks(this.dispose(!0),e,t)}async dispose(e){this.privIsDisposed||e&&(this.privIsDisposed=!0,await this.implRecognizerStop(),await super.dispose(e))}createRecognizerConfig(e){return new Ih.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,r,n){let s=r;return new Ih.DialogServiceAdapter(e,t,s,n,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(gr.PropertyId.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(gr.PropertyId.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(gr.PropertyId.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(gr.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}}};ga.DialogServiceConnector=wh});var Zy=p(ma=>{"use strict";Object.defineProperty(ma,"__esModule",{value:!0});ma.ActivityReceivedEventArgs=void 0;var bh=class{constructor(e,t){this.privActivity=e,this.privAudioStream=t}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}};ma.ActivityReceivedEventArgs=bh});var Yy=p(ya=>{"use strict";Object.defineProperty(ya,"__esModule",{value:!0});ya.TurnStatusResponsePayload=void 0;var Ah=class i{constructor(e){this.privMessageStatusResponse=JSON.parse(e)}static fromJSON(e){return new i(e)}get interactionId(){return this.privMessageStatusResponse.interactionId}get conversationId(){return this.privMessageStatusResponse.conversationId}get statusCode(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}}};ya.TurnStatusResponsePayload=Ah});var eS=p(Sa=>{"use strict";Object.defineProperty(Sa,"__esModule",{value:!0});Sa.TurnStatusReceivedEventArgs=void 0;var iw=Yy(),Th=class{constructor(e){this.privTurnStatus=iw.TurnStatusResponsePayload.fromJSON(e)}get interactionId(){return this.privTurnStatus.interactionId}get conversationId(){return this.privTurnStatus.conversationId}get statusCode(){return this.privTurnStatus.statusCode}};Sa.TurnStatusReceivedEventArgs=Th});var tS=p(Wn=>{"use strict";Object.defineProperty(Wn,"__esModule",{value:!0});Wn.ServicePropertyChannel=void 0;var nw;(function(i){i[i.UriQueryParameter=0]="UriQueryParameter"})(nw=Wn.ServicePropertyChannel||(Wn.ServicePropertyChannel={}))});var rS=p(Hn=>{"use strict";Object.defineProperty(Hn,"__esModule",{value:!0});Hn.ProfanityOption=void 0;var sw;(function(i){i[i.Masked=0]="Masked",i[i.Removed=1]="Removed",i[i.Raw=2]="Raw"})(sw=Hn.ProfanityOption||(Hn.ProfanityOption={}))});var iS=p(Ca=>{"use strict";Object.defineProperty(Ca,"__esModule",{value:!0});Ca.BaseAudioPlayer=void 0;var ow=pt(),aw=f(),cw=pr(),Oh=class{constructor(e){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,e===void 0&&(e=aw.AudioStreamFormat.getDefaultInputFormat()),this.init(e)}playAudioSample(e,t,r){try{this.ensureInitializedContext();let n=this.formatAudioData(e),s=new Float32Array(this.samples.length+n.length);s.set(this.samples,0),s.set(n,this.samples.length),this.samples=s,t&&t()}catch(n){r&&r(n)}}stopAudio(e,t){this.audioContext!==null&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close().then(()=>{e&&e()},r=>{t&&t(r)}),this.audioContext=null)}init(e){this.audioFormat=e,this.samples=new Float32Array}ensureInitializedContext(){if(this.audioContext===null){this.createAudioContext();let e=200;this.autoUpdateBufferTimer=setInterval(()=>{this.updateAudioBuffer()},e)}}createAudioContext(){this.audioContext=cw.AudioStreamFormatImpl.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(e){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(e),128);case 16:return this.formatArrayBuffer(new Int16Array(e),32768);case 32:return this.formatArrayBuffer(new Int32Array(e),2147483648);default:throw new ow.InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(e,t){let r=new Float32Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]/t;return r}updateAudioBuffer(){if(this.samples.length===0)return;let e=this.audioFormat.channels,t=this.audioContext.createBufferSource(),r=this.samples.length/e,n=this.audioContext.createBuffer(e,r,this.audioFormat.samplesPerSec);for(let s=0;s<e;s++){let o=s,a=n.getChannelData(s);for(let c=0;c<this.samples.length;c++,o+=e)a[c]=this.samples[o]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),t.buffer=n,t.connect(this.gainNode),t.start(this.startTime),this.startTime+=n.duration,this.samples=new Float32Array}async playAudio(e){this.audioContext===null&&this.createAudioContext();let t=this.audioContext.createBufferSource(),r=this.audioContext.destination;await this.audioContext.decodeAudioData(e,n=>{t.buffer=n,t.connect(r),t.start(0)})}};Ca.BaseAudioPlayer=Oh});var nS=p(Pa=>{"use strict";Object.defineProperty(Pa,"__esModule",{value:!0});Pa.ConnectionMessageEventArgs=void 0;var kh=class{constructor(e){this.privConnectionMessage=e}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}};Pa.ConnectionMessageEventArgs=kh});var sS=p(Ra=>{"use strict";Object.defineProperty(Ra,"__esModule",{value:!0});Ra.VoiceProfile=void 0;var Mh=class{constructor(e,t){this.privId=e,this.privProfileType=t}get profileId(){return this.privId}get profileType(){return this.privProfileType}};Ra.VoiceProfile=Mh});var aS=p(Di=>{"use strict";Object.defineProperty(Di,"__esModule",{value:!0});Di.VoiceProfileEnrollmentCancellationDetails=Di.VoiceProfileEnrollmentResult=void 0;var oS=C(),fe=f(),Dh=class i{constructor(e,t,r){this.privReason=e,this.privProperties=new fe.PropertyCollection,this.privReason!==fe.ResultReason.Canceled?t&&(this.privDetails=JSON.parse(t),this.privDetails.enrollmentStatus.toLowerCase()==="enrolling"&&(this.privReason=fe.ResultReason.EnrollingVoiceProfile)):(this.privErrorDetails=r,this.privProperties.setProperty(oS.CancellationErrorCodePropertyName,fe.CancellationErrorCode[fe.CancellationErrorCode.ServiceError]))}get reason(){return this.privReason}get enrollmentsCount(){return this.privDetails.enrollmentsCount}get enrollmentsLength(){return this.privDetails.enrollmentsLength}get properties(){return this.privProperties}get enrollmentResultDetails(){return this.privDetails}get errorDetails(){return this.privErrorDetails}static FromIdentificationProfileList(e){let t=[];for(let r of e.value){let n=r.enrollmentStatus.toLowerCase()==="enrolling"?fe.ResultReason.EnrollingVoiceProfile:r.enrollmentStatus.toLowerCase()==="enrolled"?fe.ResultReason.EnrolledVoiceProfile:fe.ResultReason.Canceled,s=new i(n,null,null);s.privDetails=this.getIdentificationDetails(r),t.push(s)}return t}static FromVerificationProfileList(e){let t=[];for(let r of e.value){let n=r.enrollmentStatus.toLowerCase()==="enrolling"?fe.ResultReason.EnrollingVoiceProfile:r.enrollmentStatus.toLowerCase()==="enrolled"?fe.ResultReason.EnrolledVoiceProfile:fe.ResultReason.Canceled,s=new i(n,null,null);s.privDetails=this.getVerificationDetails(r),t.push(s)}return t}static getIdentificationDetails(e){return{audioLength:e.audioLength?parseFloat(e.audioLength):0,audioSpeechLength:e.audioSpeechLength?parseFloat(e.audioSpeechLength):0,enrollmentStatus:e.enrollmentStatus,enrollmentsCount:e.enrollmentsCount||0,enrollmentsLength:e.enrollmentsLength?parseFloat(e.enrollmentsLength):0,enrollmentsSpeechLength:e.enrollmentsSpeechLength?parseFloat(e.enrollmentsSpeechLength):0,profileId:e.profileId||e.identificationProfileId,remainingEnrollmentsSpeechLength:e.remainingEnrollmentsSpeechLength?parseFloat(e.remainingEnrollmentsSpeechLength):0}}static getVerificationDetails(e){return{audioLength:e.audioLength?parseFloat(e.audioLength):0,audioSpeechLength:e.audioSpeechLength?parseFloat(e.audioSpeechLength):0,enrollmentStatus:e.enrollmentStatus,enrollmentsCount:e.enrollmentsCount,enrollmentsLength:e.enrollmentsLength?parseFloat(e.enrollmentsLength):0,enrollmentsSpeechLength:e.enrollmentsSpeechLength?parseFloat(e.enrollmentsSpeechLength):0,profileId:e.profileId||e.verificationProfileId,remainingEnrollmentsCount:e.remainingEnrollments||e.remainingEnrollmentsCount,remainingEnrollmentsSpeechLength:e.remainingEnrollmentsSpeechLength?parseFloat(e.remainingEnrollmentsSpeechLength):0}}};Di.VoiceProfileEnrollmentResult=Dh;var xh=class i extends fe.CancellationDetailsBase{constructor(e,t,r){super(e,t,r)}static fromResult(e){let t=fe.CancellationReason.Error,r=fe.CancellationErrorCode.NoError;return e.properties&&(r=fe.CancellationErrorCode[e.properties.getProperty(oS.CancellationErrorCodePropertyName,fe.CancellationErrorCode[fe.CancellationErrorCode.NoError])]),new i(t,e.errorDetails,r)}};Di.VoiceProfileEnrollmentCancellationDetails=xh});var uS=p(xi=>{"use strict";Object.defineProperty(xi,"__esModule",{value:!0});xi.VoiceProfileCancellationDetails=xi.VoiceProfileResult=void 0;var cS=C(),uw=_(),bt=f(),Nh=class{constructor(e,t){this.privReason=e,this.privProperties=new bt.PropertyCollection,e===bt.ResultReason.Canceled&&(uw.Contracts.throwIfNullOrUndefined(t,"statusText"),this.privErrorDetails=t,this.privProperties.setProperty(cS.CancellationErrorCodePropertyName,bt.CancellationErrorCode[bt.CancellationErrorCode.ServiceError]))}get reason(){return this.privReason}get properties(){return this.privProperties}get errorDetails(){return this.privErrorDetails}};xi.VoiceProfileResult=Nh;var qh=class i extends bt.CancellationDetailsBase{constructor(e,t,r){super(e,t,r)}static fromResult(e){let t=bt.CancellationReason.Error,r=bt.CancellationErrorCode.NoError;return e.properties&&(r=bt.CancellationErrorCode[e.properties.getProperty(cS.CancellationErrorCodePropertyName,bt.CancellationErrorCode[bt.CancellationErrorCode.NoError])]),new i(t,e.errorDetails,r)}};xi.VoiceProfileCancellationDetails=qh});var pS=p(Ea=>{"use strict";Object.defineProperty(Ea,"__esModule",{value:!0});Ea.VoiceProfilePhraseResult=void 0;var pw=_(),lw=f(),jh=class extends lw.VoiceProfileResult{constructor(e,t,r,n){super(e,t),this.privPhrases=[],pw.Contracts.throwIfNullOrUndefined(n,"phrase array"),this.privType=r,n&&n[0]&&(this.privPhrases=n)}get phrases(){return this.privPhrases}get type(){return this.privType}};Ea.VoiceProfilePhraseResult=jh});var lS=p(Ia=>{"use strict";Object.defineProperty(Ia,"__esModule",{value:!0});Ia.VoiceProfileClient=void 0;var zh=C(),hw=Ml(),_a=_(),$r=f(),Lh=class extends $r.Recognizer{constructor(e){_a.Contracts.throwIfNullOrUndefined(e,"speechConfig");let t=e;_a.Contracts.throwIfNull(t,"speechConfig"),super(hw.AudioConfig.fromStreamInput($r.AudioInputStream.createPushStream()),t.properties,new zh.VoiceProfileConnectionFactory),this.privProperties=t.properties.clone(),this.privVoiceAdapter=this.privReco,this.privDisposedVoiceAdapter=!1}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty($r.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){_a.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty($r.PropertyId.SpeechServiceAuthorization_Token,e)}async createProfileAsync(e,t){let r=await this.privVoiceAdapter.createProfile(e,t);return new $r.VoiceProfile(r[0],e)}async retrieveEnrollmentResultAsync(e){return this.privVoiceAdapter.retrieveEnrollmentResult(e)}async getAllProfilesAsync(e){return this.privVoiceAdapter.getAllProfiles(e)}async getActivationPhrasesAsync(e,t){return this.privVoiceAdapter.getActivationPhrases(e,t)}async enrollProfileAsync(e,t){let r=t;return _a.Contracts.throwIfNullOrUndefined(r,"audioConfig"),this.audioConfig=t,this.privVoiceAdapter.SpeakerAudioSource=r,this.privVoiceAdapter.enrollProfile(e)}async deleteProfileAsync(e){return this.privVoiceAdapter.deleteProfile(e)}async resetProfileAsync(e){return this.privVoiceAdapter.resetProfile(e)}async close(){await this.dispose(!0)}createServiceRecognizer(e,t,r,n){let s=r;return new zh.VoiceServiceRecognizer(e,t,s,n,this)}async dispose(e){this.privDisposedVoiceAdapter||(this.privDisposedVoiceAdapter=!0,e&&await super.dispose(e))}createRecognizerConfig(e){return new zh.RecognizerConfig(e,this.properties)}getResult(e,t){return new $r.VoiceProfileResult(e.ok?t:$r.ResultReason.Canceled,e.statusText)}};Ia.VoiceProfileClient=Lh});var hS=p(wa=>{"use strict";Object.defineProperty(wa,"__esModule",{value:!0});wa.SpeakerRecognizer=void 0;var Bh=C(),Qr=_(),Fh=f(),Vh=class extends Fh.Recognizer{constructor(e,t){Qr.Contracts.throwIfNullOrUndefined(e,"speechConfig");let r=e;Qr.Contracts.throwIfNullOrUndefined(r,"speechConfig"),super(t,r.properties,new Bh.SpeakerRecognitionConnectionFactory),this.privAudioConfigImpl=t,Qr.Contracts.throwIfNull(this.privAudioConfigImpl,"audioConfig"),this.privDisposedSpeakerRecognizer=!1,this.privProperties=r.properties}get authorizationToken(){return this.properties.getProperty(Fh.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){Qr.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Fh.PropertyId.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}async recognizeOnceAsync(e){return Qr.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),this.recognizeSpeakerOnceAsyncImpl(e)}async close(){Qr.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),await this.dispose(!0)}async recognizeSpeakerOnceAsyncImpl(e){Qr.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),await this.implRecognizerStop();let t=await this.privReco.recognizeSpeaker(e);return await this.implRecognizerStop(),t}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}createRecognizerConfig(e){return new Bh.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,r,n){let s=r;return new Bh.SpeakerServiceRecognizer(e,t,s,n,this)}async dispose(e){this.privDisposedSpeakerRecognizer||e&&(this.privDisposedSpeakerRecognizer=!0,await super.dispose(e))}};wa.SpeakerRecognizer=Vh});var dS=p(ba=>{"use strict";Object.defineProperty(ba,"__esModule",{value:!0});ba.SpeakerIdentificationModel=void 0;var dw=_(),vw=f(),Uh=class i{constructor(e){if(this.privVoiceProfiles=[],this.privProfileIds=[],dw.Contracts.throwIfNullOrUndefined(e,"VoiceProfiles"),e.length===0)throw new Error("Empty Voice Profiles array");for(let t of e){if(t.profileType!==vw.VoiceProfileType.TextIndependentIdentification)throw new Error("Identification model can only be created from Identification profile: "+t.profileId);this.privVoiceProfiles.push(t),this.privProfileIds.push(t.profileId)}}static fromProfiles(e){return new i(e)}get voiceProfileIds(){return this.privProfileIds.join(",")}get profileIds(){return this.privProfileIds}get scenario(){return"TextIndependentIdentification"}};ba.SpeakerIdentificationModel=Uh});var fS=p(Aa=>{"use strict";Object.defineProperty(Aa,"__esModule",{value:!0});Aa.SpeakerVerificationModel=void 0;var fw=_(),vS=f(),Wh=class i{constructor(e){if(fw.Contracts.throwIfNullOrUndefined(e,"VoiceProfile"),e.profileType===vS.VoiceProfileType.TextIndependentIdentification)throw new Error("Verification model cannot be created from Identification profile");this.privVoiceProfile=e}static fromProfile(e){return new i(e)}get voiceProfile(){return this.privVoiceProfile}get profileIds(){return[this.voiceProfile.profileId]}get scenario(){return this.voiceProfile.profileType===vS.VoiceProfileType.TextDependentVerification?"TextDependentVerification":"TextIndependentVerification"}};Aa.SpeakerVerificationModel=Wh});var Hh=p(Kn=>{"use strict";Object.defineProperty(Kn,"__esModule",{value:!0});Kn.LanguageIdMode=void 0;var gw;(function(i){i[i.AtStart=0]="AtStart",i[i.Continuous=1]="Continuous"})(gw=Kn.LanguageIdMode||(Kn.LanguageIdMode={}))});var mS=p(Ta=>{"use strict";Object.defineProperty(Ta,"__esModule",{value:!0});Ta.AutoDetectSourceLanguageConfig=void 0;var mw=C(),yw=_(),At=f(),gS=Hh(),Kh=class i{constructor(){this.privProperties=new At.PropertyCollection,this.privProperties.setProperty(At.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart"),this.privLanguageIdMode=gS.LanguageIdMode.AtStart}static fromOpenRange(){let e=new i;return e.properties.setProperty(At.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,mw.AutoDetectSourceLanguagesOpenRangeOptionName),e}static fromLanguages(e){yw.Contracts.throwIfArrayEmptyOrWhitespace(e,"languages");let t=new i;return t.properties.setProperty(At.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,e.join()),t}static fromSourceLanguageConfigs(e){if(e.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");let t=new i,r=[];return e.forEach(n=>{if(r.push(n.language),n.endpointId!==void 0&&n.endpointId!==""){let s=n.language+At.PropertyId.SpeechServiceConnection_EndpointId.toString();t.properties.setProperty(s,n.endpointId)}}),t.properties.setProperty(At.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,r.join()),t}get properties(){return this.privProperties}set mode(e){e===gS.LanguageIdMode.Continuous?(this.privProperties.setProperty(At.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privProperties.setProperty(At.PropertyId.SpeechServiceConnection_LanguageIdMode,"Continuous")):(this.privProperties.setProperty(At.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),this.privProperties.setProperty(At.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart")),this.privLanguageIdMode=e}};Ta.AutoDetectSourceLanguageConfig=Kh});var SS=p(Oa=>{"use strict";Object.defineProperty(Oa,"__esModule",{value:!0});Oa.AutoDetectSourceLanguageResult=void 0;var yS=_(),Jh=class i{constructor(e,t){yS.Contracts.throwIfNullOrUndefined(e,"language"),yS.Contracts.throwIfNullOrUndefined(t,"languageDetectionConfidence"),this.privLanguage=e,this.privLanguageDetectionConfidence=t}static fromResult(e){return new i(e.language,e.languageDetectionConfidence)}static fromConversationTranscriptionResult(e){return new i(e.language,e.languageDetectionConfidence)}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}};Oa.AutoDetectSourceLanguageResult=Jh});var CS=p(ka=>{"use strict";Object.defineProperty(ka,"__esModule",{value:!0});ka.SourceLanguageConfig=void 0;var Sw=_(),Gh=class i{constructor(e,t){Sw.Contracts.throwIfNullOrUndefined(e,"language"),this.privLanguage=e,this.privEndpointId=t}static fromLanguage(e,t){return new i(e,t)}get language(){return this.privLanguage}get endpointId(){return this.privEndpointId}};ka.SourceLanguageConfig=Gh});var RS=p(Qt=>{"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});Qt.SpeakerRecognitionCancellationDetails=Qt.SpeakerRecognitionResult=Qt.SpeakerRecognitionResultType=void 0;var PS=C(),je=f(),Ma;(function(i){i[i.Verify=0]="Verify",i[i.Identify=1]="Identify"})(Ma=Qt.SpeakerRecognitionResultType||(Qt.SpeakerRecognitionResultType={}));var $h=class{constructor(e,t=je.ResultReason.RecognizedSpeaker,r=je.CancellationErrorCode.NoError,n=""){this.privProperties=new je.PropertyCollection;let s=e.scenario==="TextIndependentIdentification"?Ma.Identify:Ma.Verify;this.privReason=t,this.privReason!==je.ResultReason.Canceled?s===Ma.Identify?(this.privProfileId=e.identificationResult.identifiedProfile.profileId,this.privScore=e.identificationResult.identifiedProfile.score,this.privReason=je.ResultReason.RecognizedSpeakers):(this.privScore=e.verificationResult.score,e.verificationResult.recognitionResult.toLowerCase()!=="accept"&&(this.privReason=je.ResultReason.NoMatch),e.verificationResult.profileId!==void 0&&e.verificationResult.profileId!==""&&(this.privProfileId=e.verificationResult.profileId)):(this.privErrorDetails=n,this.privProperties.setProperty(PS.CancellationErrorCodePropertyName,je.CancellationErrorCode[r])),this.privProperties.setProperty(je.PropertyId.SpeechServiceResponse_JsonResult,JSON.stringify(e))}get properties(){return this.privProperties}get reason(){return this.privReason}get profileId(){return this.privProfileId}get errorDetails(){return this.privErrorDetails}get score(){return this.privScore}};Qt.SpeakerRecognitionResult=$h;var Qh=class i extends je.CancellationDetailsBase{constructor(e,t,r){super(e,t,r)}static fromResult(e){let t=je.CancellationReason.Error,r=je.CancellationErrorCode.NoError;return e.properties&&(r=je.CancellationErrorCode[e.properties.getProperty(PS.CancellationErrorCodePropertyName,je.CancellationErrorCode[je.CancellationErrorCode.NoError])]),new i(t,e.errorDetails,r)}};Qt.SpeakerRecognitionCancellationDetails=Qh});var Xh=p(Ni=>{"use strict";Object.defineProperty(Ni,"__esModule",{value:!0});Ni.ConversationImpl=Ni.Conversation=void 0;var q=C(),Jn=P(),y=_(),N=f(),Da=class{constructor(){}static createConversationAsync(e,t,r,n){y.Contracts.throwIfNullOrUndefined(e,q.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),y.Contracts.throwIfNullOrUndefined(e.region,q.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),!e.subscriptionKey&&!e.getProperty(N.PropertyId[N.PropertyId.SpeechServiceAuthorization_Token])&&y.Contracts.throwIfNullOrUndefined(e.subscriptionKey,q.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));let s,o,a;return typeof t=="string"?(s=new Gn(e,t),Jn.marshalPromiseToCallbacks((async()=>{})(),r,n)):(s=new Gn(e),o=t,a=r,s.createConversationAsync(()=>{o&&o()},c=>{a&&a(c)})),s}};Ni.Conversation=Da;var Gn=class extends Da{constructor(e,t){if(super(),this.privErrors=q.ConversationConnectionConfig.restErrors,this.onConnected=s=>{this.privIsConnected=!0;try{this.privConversationTranslator?.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,s)}catch{}},this.onDisconnected=s=>{try{this.privConversationTranslator?.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,s)}catch{}finally{this.close(!1)}},this.onCanceled=(s,o)=>{try{this.privConversationTranslator?.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,o)}catch{}},this.onParticipantUpdateCommandReceived=(s,o)=>{try{let a=this.privParticipants.getParticipant(o.id);if(a!==void 0){switch(o.key){case q.ConversationTranslatorCommandTypes.changeNickname:a.displayName=o.value;break;case q.ConversationTranslatorCommandTypes.setUseTTS:a.isUsingTts=o.value;break;case q.ConversationTranslatorCommandTypes.setProfanityFiltering:a.profanity=o.value;break;case q.ConversationTranslatorCommandTypes.setMute:a.isMuted=o.value;break;case q.ConversationTranslatorCommandTypes.setTranslateToLanguages:a.translateToLanguages=o.value;break}this.privParticipants.addOrUpdateParticipant(a),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new N.ConversationParticipantsChangedEventArgs(N.ParticipantChangedReason.Updated,[this.toParticipant(a)],o.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(s,o)=>{try{this.privParticipants.participants.forEach(a=>a.isMuted=a.isHost?!1:o.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new N.ConversationParticipantsChangedEventArgs(N.ParticipantChangedReason.Updated,this.toParticipants(!1),o.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(s,o)=>{try{let a=this.privParticipants.addOrUpdateParticipant(o.participant);a!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new N.ConversationParticipantsChangedEventArgs(N.ParticipantChangedReason.JoinedConversation,[this.toParticipant(a)],o.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(s,o)=>{try{let a=this.privParticipants.getParticipant(o.participant.id);a!==void 0&&(this.privParticipants.deleteParticipant(o.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new N.ConversationParticipantsChangedEventArgs(N.ParticipantChangedReason.LeftConversation,[this.toParticipant(a)],o.sessionId)))}catch{}},this.onTranslationReceived=(s,o)=>{try{switch(o.command){case q.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new N.ConversationTranslationEventArgs(o.payload,void 0,o.sessionId));break;case q.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new N.ConversationTranslationEventArgs(o.payload,void 0,o.sessionId));break;case q.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new N.ConversationTranslationEventArgs(o.payload,void 0,o.sessionId));break}}catch{}},this.onParticipantsListReceived=(s,o)=>{try{if(o.sessionToken!==void 0&&o.sessionToken!==null&&(this.privRoom.token=o.sessionToken),this.privParticipants.participants=[...o.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new N.ConversationParticipantsChangedEventArgs(N.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),o.sessionId)),this.me.isHost){let a=this.privConversationTranslator?.properties.getProperty(N.PropertyId.ConversationTranslator_Name);a!==void 0&&a.length>0&&a!==this.me.displayName&&this.changeNicknameAsync(a)}}catch{}},this.onConversationExpiration=(s,o)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,o)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new N.PropertyCollection,this.privManager=new q.ConversationManager,e.getProperty(N.PropertyId[N.PropertyId.SpeechServiceConnection_RecoLanguage])||e.setProperty(N.PropertyId[N.PropertyId.SpeechServiceConnection_RecoLanguage],q.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=e.getProperty(N.PropertyId[N.PropertyId.SpeechServiceConnection_RecoLanguage]),t)this.privConversationId=t;else{e.targetLanguages.length===0&&e.addTargetLanguage(this.privLanguage),e.getProperty(N.PropertyId[N.PropertyId.SpeechServiceResponse_ProfanityOption])||e.setProfanity(N.ProfanityOption.Masked);let o=e.getProperty(N.PropertyId[N.PropertyId.ConversationTranslator_Name]);o==null&&(o="Host"),y.Contracts.throwIfNullOrTooLong(o,"nickname",50),y.Contracts.throwIfNullOrTooShort(o,"nickname",2),e.setProperty(N.PropertyId[N.PropertyId.ConversationTranslator_Name],o)}this.privConfig=e;let n=e;y.Contracts.throwIfNull(n,"speechConfig"),this.privProperties=n.properties.clone(),this.privIsConnected=!1,this.privParticipants=new q.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get conversationId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){return this.privParticipants.me?.isHost?!1:this.privParticipants.me?.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get conversationInfo(){let e=this.conversationId,t=this.participants.map(s=>({id:s.id,preferredLanguage:s.preferredLanguage,voice:s.voice})),r={};for(let s of q.ConversationConnectionConfig.transcriptionEventKeys){let o=this.properties.getProperty(s,"");o!==""&&(r[s]=o)}return{id:e,participants:t,conversationProperties:r}}get canSend(){return this.privIsConnected&&!this.privParticipants.me?.isMuted}get canSendAsHost(){return this.privIsConnected&&this.privParticipants.me?.isHost}get authorizationToken(){return this.privToken}set authorizationToken(e){y.Contracts.throwIfNullOrWhitespace(e,"authorizationToken"),this.privToken=e}set conversationTranslator(e){this.privConversationTranslator=e}onToken(e){this.privConversationTranslator.onToken(e)}createConversationAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),this.privManager.createOrJoin(this.privProperties,void 0,r=>{r||this.handleError(new Error(this.privErrors.permissionDeniedConnect),t),this.privRoom=r,this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}startConversationAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),y.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=q.ConversationRecognizerFactory.fromConfig(this,this.privConfig),this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}addParticipantAsync(e,t,r){y.Contracts.throwIfNullOrUndefined(e,"Participant"),Jn.marshalPromiseToCallbacks(this.addParticipantImplAsync(e),t,r)}joinConversationAsync(e,t,r,n,s){try{y.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","conversationId")),y.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),y.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,e,o=>{y.Contracts.throwIfNullOrUndefined(o,this.privErrors.permissionDeniedConnect),this.privRoom=o,this.privConfig.authorizationToken=o.cognitiveSpeechAuthToken,n&&n(o.cognitiveSpeechAuthToken)},o=>{this.handleError(o,s)})}catch(o){this.handleError(o,s)}}deleteConversationAsync(e,t){Jn.marshalPromiseToCallbacks(this.deleteConversationImplAsync(),e,t)}async deleteConversationImplAsync(){y.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),y.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endConversationAsync(e,t){Jn.marshalPromiseToCallbacks(this.endConversationImplAsync(),e,t)}endConversationImplAsync(){return this.close(!0)}lockConversationAsync(e,t){try{y.Contracts.throwIfDisposed(this.privIsDisposed),y.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),y.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}muteAllParticipantsAsync(e,t){try{y.Contracts.throwIfDisposed(this.privIsDisposed),y.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),y.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),y.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}muteParticipantAsync(e,t,r){try{y.Contracts.throwIfDisposed(this.privIsDisposed),y.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),y.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),y.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),!this.me.isHost&&this.me.id!==e&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),r),this.privParticipants.getParticipantIndex(e)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!0),()=>{this.handleCallback(t,r)},s=>{this.handleError(s,r)})}catch(n){this.handleError(n,r)}}removeParticipantAsync(e,t,r){try{if(y.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&e.hasOwnProperty("id"))Jn.marshalPromiseToCallbacks(this.removeParticipantImplAsync(e),t,r);else{y.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),y.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),r);let n="";typeof e=="string"?n=e:e.hasOwnProperty("id")?n=e.id:e.hasOwnProperty("userId")&&(n=e.userId),y.Contracts.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(o=>o.id===n)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(n),()=>{this.handleCallback(t,r)},o=>{this.handleError(o,r)})}}catch(n){this.handleError(n,r)}}unlockConversationAsync(e,t){try{y.Contracts.throwIfDisposed(this.privIsDisposed),y.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),y.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}unmuteAllParticipantsAsync(e,t){try{y.Contracts.throwIfDisposed(this.privIsDisposed),y.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),y.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}unmuteParticipantAsync(e,t,r){try{y.Contracts.throwIfDisposed(this.privIsDisposed),y.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),y.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),y.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),!this.me.isHost&&this.me.id!==e&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),r),this.privParticipants.getParticipantIndex(e)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!1),()=>{this.handleCallback(t,r)},s=>{this.handleError(s,r)})}catch(n){this.handleError(n,r)}}sendTextMessageAsync(e,t,r){try{y.Contracts.throwIfDisposed(this.privIsDisposed),y.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),y.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","message")),y.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),e.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(e),()=>{this.handleCallback(t,r)},n=>{this.handleError(n,r)})}catch(n){this.handleError(n,r)}}setTranslatedLanguagesAsync(e,t,r){try{y.Contracts.throwIfDisposed(this.privIsDisposed),y.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),y.Contracts.throwIfArrayEmptyOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","languages")),y.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(e),()=>{this.handleCallback(t,r)},n=>{this.handleError(n,r)})}catch(n){this.handleError(n,r)}}changeNicknameAsync(e,t,r){try{y.Contracts.throwIfDisposed(this.privIsDisposed),y.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),y.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","nickname")),y.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(e),()=>{this.handleCallback(t,r)},n=>{this.handleError(n,r)})}catch(n){this.handleError(n,r)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(e){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await e.enforceAudioGating(),this.privTranscriberRecognizer=e,this.privTranscriberRecognizer.conversation=this}getKeepAlive(){let e=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:e,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:q.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(e){if(this.privParticipants.addOrUpdateParticipant(e)!==void 0&&this.privTranscriberRecognizer){let r=this.conversationInfo;return r.participants=[e],this.privTranscriberRecognizer.pushConversationEvent(r,"join")}}removeParticipantImplAsync(e){this.privParticipants.deleteParticipant(e.id);let t=this.conversationInfo;return t.participants=[e],this.privTranscriberRecognizer.pushConversationEvent(t,"leave")}async close(e){try{this.privIsConnected=!1,await this.privConversationRecognizer?.close(),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(t){throw t}e&&this.dispose()}handleCallback(e,t){if(e){try{e()}catch(r){t&&t(r)}e=void 0}}handleError(e,t){if(t)if(e instanceof Error){let r=e;t(r.name+": "+r.message)}else t(e)}toParticipants(e){let t=this.privParticipants.participants.map(r=>this.toParticipant(r));return e?t:t.filter(r=>r.isHost===!1)}toParticipant(e){return new N.Participant(e.id,e.avatar,e.displayName,e.isHost,e.isMuted,e.isUsingTts,e.preferredLanguage,e.voice)}getMuteAllCommand(e){return y.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),y.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:q.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:q.ConversationTranslatorMessageTypes.participantCommand,value:e})}getMuteCommand(e,t){return y.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),y.Contracts.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:q.ConversationTranslatorCommandTypes.setMute,participantId:e,roomid:this.privRoom.roomId,type:q.ConversationTranslatorMessageTypes.participantCommand,value:t})}getLockCommand(e){return y.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),y.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:q.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:q.ConversationTranslatorMessageTypes.participantCommand,value:e})}getEjectCommand(e){return y.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),y.Contracts.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:q.ConversationTranslatorCommandTypes.ejectParticipant,participantId:e,roomid:this.privRoom.roomId,type:q.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(e){return y.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),y.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:q.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:q.ConversationTranslatorMessageTypes.participantCommand,value:e})}getChangeNicknameCommand(e){return y.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),y.Contracts.throwIfNullOrWhitespace(e,"nickname"),y.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:q.ConversationTranslatorCommandTypes.changeNickname,nickname:e,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:q.ConversationTranslatorMessageTypes.participantCommand,value:e})}getMessageCommand(e){return y.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),y.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),y.Contracts.throwIfNullOrWhitespace(e,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:e,type:q.ConversationTranslatorMessageTypes.instantMessage})}};Ni.ConversationImpl=Gn});var ES=p(xa=>{"use strict";Object.defineProperty(xa,"__esModule",{value:!0});xa.ConversationCommon=void 0;var Zh=class{constructor(e){this.privAudioConfig=e}handleCallback(e,t){if(e){try{e()}catch(r){t&&t(r)}e=void 0}}handleError(e,t){if(t)if(e instanceof Error){let r=e;t(r.name+": "+r.message)}else t(e)}};xa.ConversationCommon=Zh});var _S=p(Na=>{"use strict";Object.defineProperty(Na,"__esModule",{value:!0});Na.ConversationExpirationEventArgs=void 0;var Cw=f(),Yh=class extends Cw.SessionEventArgs{constructor(e,t){super(t),this.privExpirationTime=e}get expirationTime(){return this.privExpirationTime}};Na.ConversationExpirationEventArgs=Yh});var IS=p(qa=>{"use strict";Object.defineProperty(qa,"__esModule",{value:!0});qa.ConversationParticipantsChangedEventArgs=void 0;var Pw=f(),ed=class extends Pw.SessionEventArgs{constructor(e,t,r){super(r),this.privReason=e,this.privParticipant=t}get reason(){return this.privReason}get participants(){return this.privParticipant}};qa.ConversationParticipantsChangedEventArgs=ed});var wS=p(ja=>{"use strict";Object.defineProperty(ja,"__esModule",{value:!0});ja.ConversationTranslationCanceledEventArgs=void 0;var Rw=Ii(),td=class extends Rw.CancellationEventArgsBase{};ja.ConversationTranslationCanceledEventArgs=td});var bS=p(za=>{"use strict";Object.defineProperty(za,"__esModule",{value:!0});za.ConversationTranslationEventArgs=void 0;var Ew=f(),rd=class extends Ew.RecognitionEventArgs{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}};za.ConversationTranslationEventArgs=rd});var AS=p(La=>{"use strict";Object.defineProperty(La,"__esModule",{value:!0});La.ConversationTranslationResult=void 0;var _w=$l(),id=class extends _w.TranslationRecognitionResult{constructor(e,t,r,n,s,o,a,c,u,l,h){super(t,n,s,o,a,c,void 0,void 0,u,l,h),this.privId=e,this.privOrigLang=r}get participantId(){return this.privId}get originalLang(){return this.privOrigLang}};La.ConversationTranslationResult=id});var sd=p(Ba=>{"use strict";Object.defineProperty(Ba,"__esModule",{value:!0});Ba.StringUtils=void 0;var nd=class{static formatString(e,t){if(!e)return"";if(!t)return e;let r="",n="",s=c=>{r+=c},o=c=>{n+=c},a=s;for(let c=0;c<e.length;c++){let u=e[c],l=c+1<e.length?e[c+1]:"";switch(u){case"{":l==="{"?(a("{"),c++):a=o;break;case"}":l==="}"?(a("}"),c++):(t.hasOwnProperty(n)&&(r+=t[n]),a=s,n="");break;default:a(u);break}}return r}};Ba.StringUtils=nd});var kS=p(Ua=>{"use strict";Object.defineProperty(Ua,"__esModule",{value:!0});Ua.ConversationTranslatorConnectionFactory=void 0;var od=ce(),TS=sd(),Iw=_(),Fa=f(),ww=Ie(),Ye=$t(),OS=Ze(),ad=C(),Va=class i extends OS.ConnectionFactoryBase{constructor(e){super(),Iw.Contracts.throwIfNullOrUndefined(e,"convGetter"),this.privConvGetter=e}create(e,t,r){let n=e.parameters.getProperty("ConversationTranslator_MultiChannelAudio","").toUpperCase()==="TRUE",s=this.privConvGetter().room,o=s.cognitiveSpeechRegion||e.parameters.getProperty(Fa.PropertyId.SpeechServiceConnection_Region,""),a={hostSuffix:OS.ConnectionFactoryBase.getHostSuffix(o),path:i.CTS_VIRT_MIC_PATH,region:encodeURIComponent(o)};a[Ye.QueryParameterNames.Language]=encodeURIComponent(e.parameters.getProperty(Fa.PropertyId.SpeechServiceConnection_RecoLanguage,"")),a[Ye.QueryParameterNames.CtsMeetingId]=encodeURIComponent(s.roomId),a[Ye.QueryParameterNames.CtsDeviceId]=encodeURIComponent(s.participantId),a[Ye.QueryParameterNames.CtsIsParticipant]=s.isHost?"":"&"+Ye.QueryParameterNames.CtsIsParticipant;let c="",u={},l={};if(n){c=e.parameters.getProperty(Fa.PropertyId.SpeechServiceConnection_Endpoint),c||(c="wss://"+e.parameters.getProperty(Fa.PropertyId.SpeechServiceConnection_Host,"transcribe.{region}.cts.speech{hostSuffix}")+"{path}"),c=TS.StringUtils.formatString(c,a);let d=new URL(c);d.searchParams.forEach((M,D)=>{u[D]=M}),new ad.TranscriberConnectionFactory().setQueryParams(u,e,c),u[Ye.QueryParameterNames.CtsMeetingId]=a[Ye.QueryParameterNames.CtsMeetingId],u[Ye.QueryParameterNames.CtsDeviceId]=a[Ye.QueryParameterNames.CtsDeviceId],s.isHost||(u[Ye.QueryParameterNames.CtsIsParticipant]=""),Ye.QueryParameterNames.Format in u||(u[Ye.QueryParameterNames.Format]="simple"),d.searchParams.forEach((M,D)=>{d.searchParams.set(D,u[D]),delete u[D]}),c=d.toString()}else{let d=new ad.TranslationConnectionFactory;c=d.getEndpointUrl(e,!0),c=TS.StringUtils.formatString(c,a),d.setQueryParams(u,e,c)}l[ww.HeaderNames.ConnectionId]=r,l[od.RestConfigBase.configParams.token]=s.token,t.token&&(l[t.headerName]=t.token);let h=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","").toUpperCase()==="TRUE";return new od.WebsocketConnection(c,u,l,new ad.WebsocketMessageFormatter,od.ProxyInfo.fromRecognizerConfig(e),h,r)}};Ua.ConversationTranslatorConnectionFactory=Va;Va.CTS_VIRT_MIC_PATH="/speech/recognition/dynamicaudio"});var DS=p(Xr=>{"use strict";Object.defineProperty(Xr,"__esModule",{value:!0});Xr.ConversationTranslator=Xr.SpeechState=void 0;var $n=C(),bw=kS(),Wa=P(),dt=_(),V=f(),Aw=Xh(),MS=Ha(),vt;(function(i){i[i.Inactive=0]="Inactive",i[i.Connecting=1]="Connecting",i[i.Connected=2]="Connected"})(vt=Xr.SpeechState||(Xr.SpeechState={}));var cd=class extends V.TranslationRecognizer{constructor(e,t,r,n){super(e,t,new bw.ConversationTranslatorConnectionFactory(n)),this.privSpeechState=vt.Inactive,r&&(this.privTranslator=r,this.sessionStarted=()=>{this.privSpeechState=vt.Connected},this.sessionStopped=()=>{this.privSpeechState=vt.Inactive},this.recognizing=(s,o)=>{this.privTranslator.recognizing&&this.privTranslator.recognizing(this.privTranslator,o)},this.recognized=async(s,o)=>{o.result?.errorDetails?(await this.cancelSpeech(),this.fireCancelEvent(o.result.errorDetails)):this.privTranslator.recognized&&this.privTranslator.recognized(this.privTranslator,o)},this.canceled=async()=>{if(this.privSpeechState!==vt.Inactive)try{await this.cancelSpeech()}catch{this.privSpeechState=vt.Inactive}})}get state(){return this.privSpeechState}set state(e){this.privSpeechState=e}set authentication(e){this.privReco.authentication=e}onConnection(){this.privSpeechState=vt.Connected}async onCancelSpeech(){this.privSpeechState=vt.Inactive,await this.cancelSpeech()}fireCancelEvent(e){try{if(this.privTranslator.canceled){let t=new MS.ConversationTranslationCanceledEventArgs(V.CancellationReason.Error,e,V.CancellationErrorCode.RuntimeError);this.privTranslator.canceled(this.privTranslator,t)}}catch{}}async cancelSpeech(){try{this.stopContinuousRecognitionAsync(),await this.privReco?.disconnect(),this.privSpeechState=vt.Inactive}catch{}}},ud=class extends MS.ConversationCommon{constructor(e){super(e),this.privErrors=$n.ConversationConnectionConfig.restErrors,this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.privProperties=new V.PropertyCollection}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get participants(){return this.privConversation?.participants}get canSpeak(){return!(!this.privConversation.isConnected||!this.privCTRecognizer||this.privIsSpeaking||this.privCTRecognizer.state===vt.Connected||this.privCTRecognizer.state===vt.Connecting||this.privConversation.isMutedByHost)}onToken(e){this.privCTRecognizer.authentication=e}setServiceProperty(e,t){let r=JSON.parse(this.privProperties.getProperty($n.ServicePropertiesPropertyName,"{}"));r[e]=t,this.privProperties.setProperty($n.ServicePropertiesPropertyName,JSON.stringify(r))}joinConversationAsync(e,t,r,n,s){try{if(typeof e=="string"){dt.Contracts.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","conversation id")),dt.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),s);let o=r;(o==null||o==="")&&(o=$n.ConversationConnectionConfig.defaultLanguageCode),this.privSpeechTranslationConfig=V.SpeechTranslationConfig.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(V.ProfanityOption.Masked),this.privSpeechTranslationConfig.addTargetLanguage(o),this.privSpeechTranslationConfig.setProperty(V.PropertyId[V.PropertyId.SpeechServiceConnection_RecoLanguage],o),this.privSpeechTranslationConfig.setProperty(V.PropertyId[V.PropertyId.ConversationTranslator_Name],t);let a=[V.PropertyId.SpeechServiceConnection_Host,V.PropertyId.ConversationTranslator_Host,V.PropertyId.SpeechServiceConnection_Endpoint,V.PropertyId.SpeechServiceConnection_ProxyHostName,V.PropertyId.SpeechServiceConnection_ProxyPassword,V.PropertyId.SpeechServiceConnection_ProxyPort,V.PropertyId.SpeechServiceConnection_ProxyUserName,"ConversationTranslator_MultiChannelAudio","ConversationTranslator_Region"];for(let u of a){let l=this.privProperties.getProperty(u);if(l){let h=typeof u=="string"?u:V.PropertyId[u];this.privSpeechTranslationConfig.setProperty(h,l)}}let c=JSON.parse(this.privProperties.getProperty($n.ServicePropertiesPropertyName,"{}"));for(let u of Object.keys(c))this.privSpeechTranslationConfig.setServiceProperty(u,c[u],V.ServicePropertyChannel.UriQueryParameter);this.privConversation=new Aw.ConversationImpl(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(e,t,o,u=>{u||this.handleError(new Error(this.privErrors.permissionDeniedConnect),s),this.privSpeechTranslationConfig.authorizationToken=u,this.privConversation.room.isHost=!1,this.privConversation.startConversationAsync(()=>{this.handleCallback(n,s)},l=>{this.handleError(l,s)})},u=>{this.handleError(u,s)})}else typeof e=="object"?(dt.Contracts.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","conversation id")),dt.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(V.PropertyId.ConversationTranslator_Name,t),this.privConversation=e,this.privConversation.conversationTranslator=this,this.privConversation.room.isHost=!0,dt.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),dt.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=e.config,this.handleCallback(r,n)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),n)}catch(o){this.handleError(o,typeof r=="string"?s:n)}}leaveConversationAsync(e,t){Wa.marshalPromiseToCallbacks((async()=>{await this.cancelSpeech(),await this.privConversation.endConversationImplAsync(),await this.privConversation.deleteConversationImplAsync(),this.dispose()})(),e,t)}sendTextMessageAsync(e,t,r){try{dt.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),dt.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}",e)),this.privConversation.sendTextMessageAsync(e,t,r)}catch(n){this.handleError(n,r)}}startTranscribingAsync(e,t){Wa.marshalPromiseToCallbacks((async()=>{try{dt.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),dt.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privCTRecognizer===void 0&&await this.connectTranslatorRecognizer(),dt.Contracts.throwIfNullOrUndefined(this.privCTRecognizer,this.privErrors.permissionDeniedSend),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),t),await this.startContinuousRecognition(),this.privIsSpeaking=!0}catch(r){throw this.privIsSpeaking=!1,await this.cancelSpeech(),r}})(),e,t)}stopTranscribingAsync(e,t){Wa.marshalPromiseToCallbacks((async()=>{try{if(!this.privIsSpeaking){await this.cancelSpeech();return}this.privIsSpeaking=!1,await new Promise((r,n)=>{this.privCTRecognizer.stopContinuousRecognitionAsync(r,n)})}catch{await this.cancelSpeech()}})(),e,t)}isDisposed(){return this.privIsDisposed}dispose(e,t,r){Wa.marshalPromiseToCallbacks((async()=>{this.isDisposed&&!this.privIsSpeaking||(await this.cancelSpeech(),this.privIsDisposed=!0,this.privSpeechTranslationConfig.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,this.privConversation.dispose(),this.privConversation=void 0)})(),t,r)}async cancelSpeech(){try{this.privIsSpeaking=!1,await this.privCTRecognizer?.onCancelSpeech(),this.privCTRecognizer=void 0}catch{}}async connectTranslatorRecognizer(){try{this.privAudioConfig===void 0&&(this.privAudioConfig=V.AudioConfig.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(V.PropertyId[V.PropertyId.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(V.PropertyId[V.PropertyId.SpeechServiceConnection_Key],"");let e=()=>this.privConversation;this.privCTRecognizer=new cd(this.privSpeechTranslationConfig,this.privAudioConfig,this,e)}catch(e){throw await this.cancelSpeech(),e}}startContinuousRecognition(){return new Promise((e,t)=>{this.privCTRecognizer.startContinuousRecognitionAsync(e,t)})}};Xr.ConversationTranslator=ud});var xS=p(Ka=>{"use strict";Object.defineProperty(Ka,"__esModule",{value:!0});Ka.ConversationTranscriber=void 0;var Qn=C(),pd=P(),Zr=_(),ke=f(),ld=class i extends ke.Recognizer{constructor(e,t){let r=e;Zr.Contracts.throwIfNull(r,"speechConfig"),Zr.Contracts.throwIfNullOrWhitespace(r.properties.getProperty(ke.PropertyId.SpeechServiceConnection_RecoLanguage),ke.PropertyId[ke.PropertyId.SpeechServiceConnection_RecoLanguage]),super(t,r.properties,new Qn.ConversationTranscriberConnectionFactory),this.privProperties.setProperty(ke.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privDisposedRecognizer=!1}static FromConfig(e,t,r){let n=e;return t.properties.mergeTo(n.properties),new i(e,r)}get endpointId(){return Zr.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(ke.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(ke.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){Zr.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(ke.PropertyId.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return Zr.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(ke.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return Zr.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Qn.OutputFormatPropertyName,ke.OutputFormat[ke.OutputFormat.Simple])===ke.OutputFormat[ke.OutputFormat.Simple]?ke.OutputFormat.Simple:ke.OutputFormat.Detailed}get properties(){return this.privProperties}startTranscribingAsync(e,t){pd.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(Qn.RecognitionMode.Conversation),e,t)}stopTranscribingAsync(e,t){pd.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),e,t)}close(e,t){Zr.Contracts.throwIfDisposed(this.privDisposedRecognizer),pd.marshalPromiseToCallbacks(this.dispose(!0),e,t)}async dispose(e){this.privDisposedRecognizer||(e&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(e))}createRecognizerConfig(e){return new Qn.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,r,n){let s=r;return n.isSpeakerDiarizationEnabled=!0,new Qn.ConversationTranscriptionServiceRecognizer(e,t,s,n,this)}};Ka.ConversationTranscriber=ld});var NS=p(qi=>{"use strict";Object.defineProperty(qi,"__esModule",{value:!0});qi.Participant=qi.User=void 0;var Tw=f(),hd=class{constructor(e){this.privUserId=e}get userId(){return this.privUserId}};qi.User=hd;var dd=class i{constructor(e,t,r,n,s,o,a,c){this.privId=e,this.privAvatar=t,this.privDisplayName=r,this.privIsHost=n,this.privIsMuted=s,this.privIsUsingTts=o,this.privPreferredLanguage=a,this.privVoice=c,this.privProperties=new Tw.PropertyCollection}get avatar(){return this.privAvatar}get displayName(){return this.privDisplayName}get id(){return this.privId}get preferredLanguage(){return this.privPreferredLanguage}get isHost(){return this.privIsHost}get isMuted(){return this.privIsMuted}get isUsingTts(){return this.privIsUsingTts}get voice(){return this.privVoice}get properties(){return this.privProperties}static From(e,t,r){return new i(e,"",e,!1,!1,!1,t,r)}};qi.Participant=dd});var qS=p(Xn=>{"use strict";Object.defineProperty(Xn,"__esModule",{value:!0});Xn.ParticipantChangedReason=void 0;var Ow;(function(i){i[i.JoinedConversation=0]="JoinedConversation",i[i.LeftConversation=1]="LeftConversation",i[i.Updated=2]="Updated"})(Ow=Xn.ParticipantChangedReason||(Xn.ParticipantChangedReason={}))});var jS=p(ji=>{"use strict";Object.defineProperty(ji,"__esModule",{value:!0});ji.MeetingImpl=ji.Meeting=void 0;var z=C(),Zn=P(),S=_(),H=f(),Ja=class{constructor(){}static createMeetingAsync(e,t,r,n){if(S.Contracts.throwIfNullOrUndefined(e,z.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),S.Contracts.throwIfNullOrUndefined(e.region,z.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),S.Contracts.throwIfNull(t,"meetingId"),t.length===0)throw new Error("meetingId cannot be empty");!e.subscriptionKey&&!e.getProperty(H.PropertyId[H.PropertyId.SpeechServiceAuthorization_Token])&&S.Contracts.throwIfNullOrUndefined(e.subscriptionKey,z.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));let s=new Ga(e,t);return Zn.marshalPromiseToCallbacks((async()=>{})(),r,n),s}};ji.Meeting=Ja;var Ga=class extends Ja{constructor(e,t){super(),this.privErrors=z.ConversationConnectionConfig.restErrors,this.onConnected=s=>{this.privIsConnected=!0;try{this.privConversationTranslator?.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,s)}catch{}},this.onDisconnected=s=>{try{this.privConversationTranslator?.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,s)}catch{}finally{this.close(!1)}},this.onCanceled=(s,o)=>{try{this.privConversationTranslator?.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,o)}catch{}},this.onParticipantUpdateCommandReceived=(s,o)=>{try{let a=this.privParticipants.getParticipant(o.id);if(a!==void 0){switch(o.key){case z.ConversationTranslatorCommandTypes.changeNickname:a.displayName=o.value;break;case z.ConversationTranslatorCommandTypes.setUseTTS:a.isUsingTts=o.value;break;case z.ConversationTranslatorCommandTypes.setProfanityFiltering:a.profanity=o.value;break;case z.ConversationTranslatorCommandTypes.setMute:a.isMuted=o.value;break;case z.ConversationTranslatorCommandTypes.setTranslateToLanguages:a.translateToLanguages=o.value;break}this.privParticipants.addOrUpdateParticipant(a),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new H.ConversationParticipantsChangedEventArgs(H.ParticipantChangedReason.Updated,[this.toParticipant(a)],o.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(s,o)=>{try{this.privParticipants.participants.forEach(a=>a.isMuted=a.isHost?!1:o.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new H.ConversationParticipantsChangedEventArgs(H.ParticipantChangedReason.Updated,this.toParticipants(!1),o.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(s,o)=>{try{let a=this.privParticipants.addOrUpdateParticipant(o.participant);a!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new H.ConversationParticipantsChangedEventArgs(H.ParticipantChangedReason.JoinedConversation,[this.toParticipant(a)],o.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(s,o)=>{try{let a=this.privParticipants.getParticipant(o.participant.id);a!==void 0&&(this.privParticipants.deleteParticipant(o.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new H.ConversationParticipantsChangedEventArgs(H.ParticipantChangedReason.LeftConversation,[this.toParticipant(a)],o.sessionId)))}catch{}},this.onTranslationReceived=(s,o)=>{try{switch(o.command){case z.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new H.ConversationTranslationEventArgs(o.payload,void 0,o.sessionId));break;case z.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new H.ConversationTranslationEventArgs(o.payload,void 0,o.sessionId));break;case z.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new H.ConversationTranslationEventArgs(o.payload,void 0,o.sessionId));break}}catch{}},this.onParticipantsListReceived=(s,o)=>{try{if(o.sessionToken!==void 0&&o.sessionToken!==null&&(this.privRoom.token=o.sessionToken),this.privParticipants.participants=[...o.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new H.ConversationParticipantsChangedEventArgs(H.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),o.sessionId)),this.me.isHost){let a=this.privConversationTranslator?.properties.getProperty(H.PropertyId.ConversationTranslator_Name);a!==void 0&&a.length>0&&a!==this.me.displayName&&this.changeNicknameAsync(a)}}catch{}},this.onConversationExpiration=(s,o)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,o)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new H.PropertyCollection,this.privManager=new z.ConversationManager,e.getProperty(H.PropertyId[H.PropertyId.SpeechServiceConnection_RecoLanguage])||e.setProperty(H.PropertyId[H.PropertyId.SpeechServiceConnection_RecoLanguage],z.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=e.getProperty(H.PropertyId[H.PropertyId.SpeechServiceConnection_RecoLanguage]),this.privConversationId=t,this.privConfig=e;let n=e;S.Contracts.throwIfNull(n,"speechConfig"),this.privProperties=n.properties.clone(),this.privIsConnected=!1,this.privParticipants=new z.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get meetingId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){return this.privParticipants.me?.isHost?!1:this.privParticipants.me?.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get meetingInfo(){let e=this.meetingId,t=this.participants.map(s=>({id:s.id,preferredLanguage:s.preferredLanguage,voice:s.voice})),r={};for(let s of z.ConversationConnectionConfig.transcriptionEventKeys){let o=this.properties.getProperty(s,"");o!==""&&(r[s]=o)}return{id:e,participants:t,meetingProperties:r}}get canSend(){return this.privIsConnected&&!this.privParticipants.me?.isMuted}get canSendAsHost(){return this.privIsConnected&&this.privParticipants.me?.isHost}get authorizationToken(){return this.privToken}set authorizationToken(e){S.Contracts.throwIfNullOrWhitespace(e,"authorizationToken"),this.privToken=e}createMeetingAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),this.privManager.createOrJoin(this.privProperties,void 0,r=>{r||this.handleError(new Error(this.privErrors.permissionDeniedConnect),t),this.privRoom=r,this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}startMeetingAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),S.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}addParticipantAsync(e,t,r){S.Contracts.throwIfNullOrUndefined(e,"Participant"),Zn.marshalPromiseToCallbacks(this.addParticipantImplAsync(e),t,r)}joinMeetingAsync(e,t,r,n,s){try{S.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","conversationId")),S.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),S.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,e,o=>{S.Contracts.throwIfNullOrUndefined(o,this.privErrors.permissionDeniedConnect),this.privRoom=o,this.privConfig.authorizationToken=o.cognitiveSpeechAuthToken,n&&n(o.cognitiveSpeechAuthToken)},o=>{this.handleError(o,s)})}catch(o){this.handleError(o,s)}}deleteMeetingAsync(e,t){Zn.marshalPromiseToCallbacks(this.deleteMeetingImplAsync(),e,t)}async deleteMeetingImplAsync(){S.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),S.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endMeetingAsync(e,t){Zn.marshalPromiseToCallbacks(this.endMeetingImplAsync(),e,t)}endMeetingImplAsync(){return this.close(!0)}lockMeetingAsync(e,t){try{S.Contracts.throwIfDisposed(this.privIsDisposed),S.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),S.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}muteAllParticipantsAsync(e,t){try{S.Contracts.throwIfDisposed(this.privIsDisposed),S.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),S.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),S.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}muteParticipantAsync(e,t,r){try{S.Contracts.throwIfDisposed(this.privIsDisposed),S.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),S.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),S.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),!this.me.isHost&&this.me.id!==e&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),r),this.privParticipants.getParticipantIndex(e)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!0),()=>{this.handleCallback(t,r)},s=>{this.handleError(s,r)})}catch(n){this.handleError(n,r)}}removeParticipantAsync(e,t,r){try{if(S.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&e.hasOwnProperty("id"))Zn.marshalPromiseToCallbacks(this.removeParticipantImplAsync(e),t,r);else{S.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),S.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),r);let n="";typeof e=="string"?n=e:e.hasOwnProperty("id")?n=e.id:e.hasOwnProperty("userId")&&(n=e.userId),S.Contracts.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(o=>o.id===n)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(n),()=>{this.handleCallback(t,r)},o=>{this.handleError(o,r)})}}catch(n){this.handleError(n,r)}}unlockMeetingAsync(e,t){try{S.Contracts.throwIfDisposed(this.privIsDisposed),S.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),S.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}unmuteAllParticipantsAsync(e,t){try{S.Contracts.throwIfDisposed(this.privIsDisposed),S.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),S.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}unmuteParticipantAsync(e,t,r){try{S.Contracts.throwIfDisposed(this.privIsDisposed),S.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),S.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),S.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),!this.me.isHost&&this.me.id!==e&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),r),this.privParticipants.getParticipantIndex(e)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!1),()=>{this.handleCallback(t,r)},s=>{this.handleError(s,r)})}catch(n){this.handleError(n,r)}}sendTextMessageAsync(e,t,r){try{S.Contracts.throwIfDisposed(this.privIsDisposed),S.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),S.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","message")),S.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),e.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(e),()=>{this.handleCallback(t,r)},n=>{this.handleError(n,r)})}catch(n){this.handleError(n,r)}}setTranslatedLanguagesAsync(e,t,r){try{S.Contracts.throwIfDisposed(this.privIsDisposed),S.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),S.Contracts.throwIfArrayEmptyOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","languages")),S.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(e),()=>{this.handleCallback(t,r)},n=>{this.handleError(n,r)})}catch(n){this.handleError(n,r)}}changeNicknameAsync(e,t,r){try{S.Contracts.throwIfDisposed(this.privIsDisposed),S.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),S.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","nickname")),S.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(e),()=>{this.handleCallback(t,r)},n=>{this.handleError(n,r)})}catch(n){this.handleError(n,r)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(e){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await e.enforceAudioGating(),this.privTranscriberRecognizer=e,this.privTranscriberRecognizer.meeting=this}getKeepAlive(){let e=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:e,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:z.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(e){if(this.privParticipants.addOrUpdateParticipant(e)!==void 0&&this.privTranscriberRecognizer){let r=this.meetingInfo;return r.participants=[e],this.privTranscriberRecognizer.pushMeetingEvent(r,"join")}}removeParticipantImplAsync(e){this.privParticipants.deleteParticipant(e.id);let t=this.meetingInfo;return t.participants=[e],this.privTranscriberRecognizer.pushMeetingEvent(t,"leave")}async close(e){try{this.privIsConnected=!1,await this.privConversationRecognizer?.close(),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(t){throw t}e&&this.dispose()}handleCallback(e,t){if(e){try{e()}catch(r){t&&t(r)}e=void 0}}handleError(e,t){if(t)if(e instanceof Error){let r=e;t(r.name+": "+r.message)}else t(e)}toParticipants(e){let t=this.privParticipants.participants.map(r=>this.toParticipant(r));return e?t:t.filter(r=>r.isHost===!1)}toParticipant(e){return new H.Participant(e.id,e.avatar,e.displayName,e.isHost,e.isMuted,e.isUsingTts,e.preferredLanguage,e.voice)}getMuteAllCommand(e){return S.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingd"),S.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:z.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:z.ConversationTranslatorMessageTypes.participantCommand,value:e})}getMuteCommand(e,t){return S.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),S.Contracts.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:z.ConversationTranslatorCommandTypes.setMute,participantId:e,roomid:this.privRoom.roomId,type:z.ConversationTranslatorMessageTypes.participantCommand,value:t})}getLockCommand(e){return S.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),S.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:z.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:z.ConversationTranslatorMessageTypes.participantCommand,value:e})}getEjectCommand(e){return S.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),S.Contracts.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:z.ConversationTranslatorCommandTypes.ejectParticipant,participantId:e,roomid:this.privRoom.roomId,type:z.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(e){return S.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),S.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:z.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:z.ConversationTranslatorMessageTypes.participantCommand,value:e})}getChangeNicknameCommand(e){return S.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),S.Contracts.throwIfNullOrWhitespace(e,"nickname"),S.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:z.ConversationTranslatorCommandTypes.changeNickname,nickname:e,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:z.ConversationTranslatorMessageTypes.participantCommand,value:e})}getMessageCommand(e){return S.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),S.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),S.Contracts.throwIfNullOrWhitespace(e,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:e,type:z.ConversationTranslatorMessageTypes.instantMessage})}};ji.MeetingImpl=Ga});var zS=p($a=>{"use strict";Object.defineProperty($a,"__esModule",{value:!0});$a.MeetingTranscriptionCanceledEventArgs=void 0;var kw=Ii(),vd=class extends kw.CancellationEventArgsBase{};$a.MeetingTranscriptionCanceledEventArgs=vd});var LS=p(Qa=>{"use strict";Object.defineProperty(Qa,"__esModule",{value:!0});Qa.MeetingTranscriber=void 0;var Mw=C(),fd=P(),Yn=_(),es=f(),Dw=Ha(),gd=class{constructor(e){this.privAudioConfig=e,this.privProperties=new es.PropertyCollection,this.privRecognizer=void 0,this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return Yn.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(es.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get internalData(){return this.privRecognizer.internalData}get connection(){return es.Connection.fromRecognizer(this.privRecognizer)}get authorizationToken(){return this.properties.getProperty(es.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){Yn.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(es.PropertyId.SpeechServiceAuthorization_Token,e)}joinMeetingAsync(e,t,r){let n=e;Yn.Contracts.throwIfNullOrUndefined(Dw.MeetingImpl,"Meeting"),this.privRecognizer=new Mw.TranscriberRecognizer(e.config,this.privAudioConfig),Yn.Contracts.throwIfNullOrUndefined(this.privRecognizer,"Recognizer"),this.privRecognizer.connectMeetingCallbacks(this),fd.marshalPromiseToCallbacks(n.connectTranscriberRecognizer(this.privRecognizer),t,r)}startTranscribingAsync(e,t){this.privRecognizer.startContinuousRecognitionAsync(e,t)}stopTranscribingAsync(e,t){this.privRecognizer.stopContinuousRecognitionAsync(e,t)}leaveMeetingAsync(e,t){this.privRecognizer.disconnectCallbacks(),fd.marshalPromiseToCallbacks((async()=>{})(),e,t)}close(e,t){Yn.Contracts.throwIfDisposed(this.privDisposedRecognizer),fd.marshalPromiseToCallbacks(this.dispose(!0),e,t)}async dispose(e){this.privDisposedRecognizer||(this.privRecognizer&&(await this.privRecognizer.close(),this.privRecognizer=void 0),e&&(this.privDisposedRecognizer=!0))}};Qa.MeetingTranscriber=gd});var BS=p(Xa=>{"use strict";Object.defineProperty(Xa,"__esModule",{value:!0});Xa.ConversationTranscriptionResult=void 0;var xw=f(),md=class extends xw.RecognitionResult{constructor(e,t,r,n,s,o,a,c,u,l,h){super(e,t,r,n,s,o,a,u,l,h),this.privSpeakerId=c}get speakerId(){return this.privSpeakerId}};Xa.ConversationTranscriptionResult=md});var Ha=p(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});var FS=Xh();Object.defineProperty(re,"Conversation",{enumerable:!0,get:function(){return FS.Conversation}});Object.defineProperty(re,"ConversationImpl",{enumerable:!0,get:function(){return FS.ConversationImpl}});var Nw=ES();Object.defineProperty(re,"ConversationCommon",{enumerable:!0,get:function(){return Nw.ConversationCommon}});var qw=_S();Object.defineProperty(re,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return qw.ConversationExpirationEventArgs}});var jw=IS();Object.defineProperty(re,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return jw.ConversationParticipantsChangedEventArgs}});var zw=wS();Object.defineProperty(re,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return zw.ConversationTranslationCanceledEventArgs}});var Lw=bS();Object.defineProperty(re,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return Lw.ConversationTranslationEventArgs}});var Bw=AS();Object.defineProperty(re,"ConversationTranslationResult",{enumerable:!0,get:function(){return Bw.ConversationTranslationResult}});var Fw=DS();Object.defineProperty(re,"ConversationTranslator",{enumerable:!0,get:function(){return Fw.ConversationTranslator}});var Vw=xS();Object.defineProperty(re,"ConversationTranscriber",{enumerable:!0,get:function(){return Vw.ConversationTranscriber}});var VS=NS();Object.defineProperty(re,"Participant",{enumerable:!0,get:function(){return VS.Participant}});Object.defineProperty(re,"User",{enumerable:!0,get:function(){return VS.User}});var Uw=qS();Object.defineProperty(re,"ParticipantChangedReason",{enumerable:!0,get:function(){return Uw.ParticipantChangedReason}});var US=jS();Object.defineProperty(re,"Meeting",{enumerable:!0,get:function(){return US.Meeting}});Object.defineProperty(re,"MeetingImpl",{enumerable:!0,get:function(){return US.MeetingImpl}});var Ww=zS();Object.defineProperty(re,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return Ww.MeetingTranscriptionCanceledEventArgs}});var Hw=LS();Object.defineProperty(re,"MeetingTranscriber",{enumerable:!0,get:function(){return Hw.MeetingTranscriber}});var Kw=BS();Object.defineProperty(re,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return Kw.ConversationTranscriptionResult}})});var Za=p(zi=>{"use strict";Object.defineProperty(zi,"__esModule",{value:!0});zi.SynthesisRequest=zi.Synthesizer=void 0;var Yr=C(),Jw=P(),WS=_(),mr=f(),yd=class i{constructor(e){let t=e;WS.Contracts.throwIfNull(t,"speechConfig"),this.privProperties=t.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.synthesisRequestQueue=new Jw.Queue}get authorizationToken(){return this.properties.getProperty(mr.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){WS.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(mr.PropertyId.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}get autoDetectSourceLanguage(){return this.properties.getProperty(mr.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)===Yr.AutoDetectSourceLanguagesOpenRangeOptionName}buildSsml(e){let t={"af-ZA":"af-ZA-AdriNeural","am-ET":"am-ET-AmehaNeural","ar-AE":"ar-AE-FatimaNeural","ar-BH":"ar-BH-AliNeural","ar-DZ":"ar-DZ-AminaNeural","ar-EG":"ar-EG-SalmaNeural","ar-IQ":"ar-IQ-BasselNeural","ar-JO":"ar-JO-SanaNeural","ar-KW":"ar-KW-FahedNeural","ar-LY":"ar-LY-ImanNeural","ar-MA":"ar-MA-JamalNeural","ar-QA":"ar-QA-AmalNeural","ar-SA":"ar-SA-HamedNeural","ar-SY":"ar-SY-AmanyNeural","ar-TN":"ar-TN-HediNeural","ar-YE":"ar-YE-MaryamNeural","bg-BG":"bg-BG-BorislavNeural","bn-BD":"bn-BD-NabanitaNeural","bn-IN":"bn-IN-BashkarNeural","ca-ES":"ca-ES-JoanaNeural","cs-CZ":"cs-CZ-AntoninNeural","cy-GB":"cy-GB-AledNeural","da-DK":"da-DK-ChristelNeural","de-AT":"de-AT-IngridNeural","de-CH":"de-CH-JanNeural","de-DE":"de-DE-KatjaNeural","el-GR":"el-GR-AthinaNeural","en-AU":"en-AU-NatashaNeural","en-CA":"en-CA-ClaraNeural","en-GB":"en-GB-LibbyNeural","en-HK":"en-HK-SamNeural","en-IE":"en-IE-ConnorNeural","en-IN":"en-IN-NeerjaNeural","en-KE":"en-KE-AsiliaNeural","en-NG":"en-NG-AbeoNeural","en-NZ":"en-NZ-MitchellNeural","en-PH":"en-PH-JamesNeural","en-SG":"en-SG-LunaNeural","en-TZ":"en-TZ-ElimuNeural","en-US":"en-US-JennyNeural","en-ZA":"en-ZA-LeahNeural","es-AR":"es-AR-ElenaNeural","es-BO":"es-BO-MarceloNeural","es-CL":"es-CL-CatalinaNeural","es-CO":"es-CO-GonzaloNeural","es-CR":"es-CR-JuanNeural","es-CU":"es-CU-BelkysNeural","es-DO":"es-DO-EmilioNeural","es-EC":"es-EC-AndreaNeural","es-ES":"es-ES-AlvaroNeural","es-GQ":"es-GQ-JavierNeural","es-GT":"es-GT-AndresNeural","es-HN":"es-HN-CarlosNeural","es-MX":"es-MX-DaliaNeural","es-NI":"es-NI-FedericoNeural","es-PA":"es-PA-MargaritaNeural","es-PE":"es-PE-AlexNeural","es-PR":"es-PR-KarinaNeural","es-PY":"es-PY-MarioNeural","es-SV":"es-SV-LorenaNeural","es-US":"es-US-AlonsoNeural","es-UY":"es-UY-MateoNeural","es-VE":"es-VE-PaolaNeural","et-EE":"et-EE-AnuNeural","fa-IR":"fa-IR-DilaraNeural","fi-FI":"fi-FI-SelmaNeural","fil-PH":"fil-PH-AngeloNeural","fr-BE":"fr-BE-CharlineNeural","fr-CA":"fr-CA-SylvieNeural","fr-CH":"fr-CH-ArianeNeural","fr-FR":"fr-FR-DeniseNeural","ga-IE":"ga-IE-ColmNeural","gl-ES":"gl-ES-RoiNeural","gu-IN":"gu-IN-DhwaniNeural","he-IL":"he-IL-AvriNeural","hi-IN":"hi-IN-MadhurNeural","hr-HR":"hr-HR-GabrijelaNeural","hu-HU":"hu-HU-NoemiNeural","id-ID":"id-ID-ArdiNeural","is-IS":"is-IS-GudrunNeural","it-IT":"it-IT-IsabellaNeural","ja-JP":"ja-JP-NanamiNeural","jv-ID":"jv-ID-DimasNeural","kk-KZ":"kk-KZ-AigulNeural","km-KH":"km-KH-PisethNeural","kn-IN":"kn-IN-GaganNeural","ko-KR":"ko-KR-SunHiNeural","lo-LA":"lo-LA-ChanthavongNeural","lt-LT":"lt-LT-LeonasNeural","lv-LV":"lv-LV-EveritaNeural","mk-MK":"mk-MK-AleksandarNeural","ml-IN":"ml-IN-MidhunNeural","mr-IN":"mr-IN-AarohiNeural","ms-MY":"ms-MY-OsmanNeural","mt-MT":"mt-MT-GraceNeural","my-MM":"my-MM-NilarNeural","nb-NO":"nb-NO-PernilleNeural","nl-BE":"nl-BE-ArnaudNeural","nl-NL":"nl-NL-ColetteNeural","pl-PL":"pl-PL-AgnieszkaNeural","ps-AF":"ps-AF-GulNawazNeural","pt-BR":"pt-BR-FranciscaNeural","pt-PT":"pt-PT-DuarteNeural","ro-RO":"ro-RO-AlinaNeural","ru-RU":"ru-RU-SvetlanaNeural","si-LK":"si-LK-SameeraNeural","sk-SK":"sk-SK-LukasNeural","sl-SI":"sl-SI-PetraNeural","so-SO":"so-SO-MuuseNeural","sr-RS":"sr-RS-NicholasNeural","su-ID":"su-ID-JajangNeural","sv-SE":"sv-SE-SofieNeural","sw-KE":"sw-KE-RafikiNeural","sw-TZ":"sw-TZ-DaudiNeural","ta-IN":"ta-IN-PallaviNeural","ta-LK":"ta-LK-KumarNeural","ta-SG":"ta-SG-AnbuNeural","te-IN":"te-IN-MohanNeural","th-TH":"th-TH-PremwadeeNeural","tr-TR":"tr-TR-AhmetNeural","uk-UA":"uk-UA-OstapNeural","ur-IN":"ur-IN-GulNeural","ur-PK":"ur-PK-AsadNeural","uz-UZ":"uz-UZ-MadinaNeural","vi-VN":"vi-VN-HoaiMyNeural","zh-CN":"zh-CN-XiaoxiaoNeural","zh-HK":"zh-HK-HiuMaanNeural","zh-TW":"zh-TW-HsiaoChenNeural","zu-ZA":"zu-ZA-ThandoNeural"},r=this.properties.getProperty(mr.PropertyId.SpeechServiceConnection_SynthLanguage,"en-US"),n=this.properties.getProperty(mr.PropertyId.SpeechServiceConnection_SynthVoice,""),s=i.XMLEncode(e);return this.autoDetectSourceLanguage?r="en-US":n=n||t[r],n&&(s=`<voice name='${n}'>${s}</voice>`),s=`<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${r}'>${s}</speak>`,s}async dispose(e){this.privDisposed||(e&&this.privAdapter&&await this.privAdapter.dispose(),this.privDisposed=!0)}async adapterSpeak(){if(!this.privDisposed&&!this.privSynthesizing){this.privSynthesizing=!0;let e=await this.synthesisRequestQueue.dequeue();return this.privAdapter.Speak(e.text,e.isSSML,e.requestId,e.cb,e.err,e.dataStream)}}createSynthesizerConfig(e){return new Yr.SynthesizerConfig(e,this.privProperties)}implCommonSynthesizeSetup(){let e=typeof window<"u"?"Browser":"Node",t="unknown",r="unknown";typeof navigator<"u"&&(e=e+"/"+navigator.platform,t=navigator.userAgent,r=navigator.appVersion);let n=this.createSynthesizerConfig(new Yr.SpeechServiceConfig(new Yr.Context(new Yr.OS(e,t,r)))),s=this.privProperties.getProperty(mr.PropertyId.SpeechServiceConnection_Key,void 0),o=s&&s!==""?new Yr.CognitiveSubscriptionKeyAuthentication(s):new Yr.CognitiveTokenAuthentication(()=>{let a=this.privProperties.getProperty(mr.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(a)},()=>{let a=this.privProperties.getProperty(mr.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(a)});this.privAdapter=this.createSynthesisAdapter(o,this.privConnectionFactory,n),this.privRestAdapter=this.createRestSynthesisAdapter(o,n)}static XMLEncode(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}};zi.Synthesizer=yd;var Sd=class{constructor(e,t,r,n,s,o){this.requestId=e,this.text=t,this.isSSML=r,this.cb=n,this.err=s,this.dataStream=o}};zi.SynthesisRequest=Sd});var KS=p(Ya=>{"use strict";Object.defineProperty(Ya,"__esModule",{value:!0});Ya.SpeechSynthesizer=void 0;var Cd=C(),Pd=P(),Gw=Al(),$w=Pi(),Qw=Lr(),HS=_(),yr=f(),Xw=Za(),Rd=class i extends yr.Synthesizer{constructor(e,t){super(e),t!==null&&(t===void 0?this.audioConfig=typeof window>"u"?void 0:yr.AudioConfig.fromDefaultSpeakerOutput():this.audioConfig=t),this.privConnectionFactory=new Cd.SpeechSynthesisConnectionFactory,this.implCommonSynthesizeSetup()}static FromConfig(e,t,r){let n=e;return t.properties.mergeTo(n.properties),new i(e,r)}speakTextAsync(e,t,r,n){this.speakImpl(e,!1,t,r,n)}speakSsmlAsync(e,t,r,n){this.speakImpl(e,!0,t,r,n)}async getVoicesAsync(e=""){return this.getVoices(e)}close(e,t){HS.Contracts.throwIfDisposed(this.privDisposed),Pd.marshalPromiseToCallbacks(this.dispose(!0),e,t)}get internalData(){return this.privAdapter}createSynthesisAdapter(e,t,r){return new Cd.SpeechSynthesisAdapter(e,t,r,this,this.audioConfig)}createRestSynthesisAdapter(e,t){return new Cd.SynthesisRestAdapter(t,e)}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=$w.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(yr.SpeechSynthesisOutputFormat[this.properties.getProperty(yr.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)])}speakImpl(e,t,r,n,s){try{HS.Contracts.throwIfDisposed(this.privDisposed);let o=Pd.createNoDashGuid(),a;s instanceof yr.PushAudioOutputStreamCallback?a=new Qw.PushAudioOutputStreamImpl(s):s instanceof yr.PullAudioOutputStream?a=s:s!==void 0?a=new Gw.AudioFileWriter(s):a=void 0,this.synthesisRequestQueue.enqueue(new Xw.SynthesisRequest(o,e,t,c=>{if(this.privSynthesizing=!1,r)try{r(c)}catch(u){n&&n(u)}r=void 0,this.adapterSpeak().catch(()=>{})},c=>{n&&n(c)},a)),this.adapterSpeak().catch(()=>{})}catch(o){if(n)if(o instanceof Error){let a=o;n(a.name+": "+a.message)}else n(o);this.dispose(!0).catch(()=>{})}}async getVoices(e){let t=Pd.createNoDashGuid(),r=await this.privRestAdapter.getVoicesList(t);if(r.ok&&Array.isArray(r.json)){let n=r.json;return e&&e.length>0&&(n=n.filter(s=>!!s.Locale&&s.Locale.toLowerCase()===e.toLowerCase())),new yr.SynthesisVoicesResult(t,n,void 0)}else return new yr.SynthesisVoicesResult(t,void 0,`Error: ${r.status}: ${r.statusText}`)}};Ya.SpeechSynthesizer=Rd});var JS=p(ec=>{"use strict";Object.defineProperty(ec,"__esModule",{value:!0});ec.SynthesisResult=void 0;var Ed=class{constructor(e,t,r,n){this.privResultId=e,this.privReason=t,this.privErrorDetails=r,this.privProperties=n}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}};ec.SynthesisResult=Ed});var GS=p(tc=>{"use strict";Object.defineProperty(tc,"__esModule",{value:!0});tc.SpeechSynthesisResult=void 0;var Zw=f(),_d=class extends Zw.SynthesisResult{constructor(e,t,r,n,s,o){super(e,t,n,s),this.privAudioData=r,this.privAudioDuration=o}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}};tc.SpeechSynthesisResult=_d});var $S=p(rc=>{"use strict";Object.defineProperty(rc,"__esModule",{value:!0});rc.SpeechSynthesisEventArgs=void 0;var Id=class{constructor(e){this.privResult=e}get result(){return this.privResult}};rc.SpeechSynthesisEventArgs=Id});var QS=p(ic=>{"use strict";Object.defineProperty(ic,"__esModule",{value:!0});ic.SpeechSynthesisWordBoundaryEventArgs=void 0;var wd=class{constructor(e,t,r,n,s,o){this.privAudioOffset=e,this.privDuration=t,this.privText=r,this.privWordLength=n,this.privTextOffset=s,this.privBoundaryType=o}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}};ic.SpeechSynthesisWordBoundaryEventArgs=wd});var XS=p(nc=>{"use strict";Object.defineProperty(nc,"__esModule",{value:!0});nc.SpeechSynthesisBookmarkEventArgs=void 0;var bd=class{constructor(e,t){this.privAudioOffset=e,this.privText=t}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}};nc.SpeechSynthesisBookmarkEventArgs=bd});var ZS=p(sc=>{"use strict";Object.defineProperty(sc,"__esModule",{value:!0});sc.SpeechSynthesisVisemeEventArgs=void 0;var Ad=class{constructor(e,t,r){this.privAudioOffset=e,this.privVisemeId=t,this.privAnimation=r}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}};sc.SpeechSynthesisVisemeEventArgs=Ad});var YS=p(ts=>{"use strict";Object.defineProperty(ts,"__esModule",{value:!0});ts.SpeechSynthesisBoundaryType=void 0;var Yw;(function(i){i.Word="WordBoundary",i.Punctuation="PunctuationBoundary",i.Sentence="SentenceBoundary"})(Yw=ts.SpeechSynthesisBoundaryType||(ts.SpeechSynthesisBoundaryType={}))});var eC=p(oc=>{"use strict";Object.defineProperty(oc,"__esModule",{value:!0});oc.SynthesisVoicesResult=void 0;var Li=f(),Td=class extends Li.SynthesisResult{constructor(e,t,r){if(Array.isArray(t)){super(e,Li.ResultReason.VoicesListRetrieved,void 0,new Li.PropertyCollection),this.privVoices=[];for(let n of t)this.privVoices.push(new Li.VoiceInfo(n))}else super(e,Li.ResultReason.Canceled,r||"Error information unavailable",new Li.PropertyCollection)}get voices(){return this.privVoices}};oc.SynthesisVoicesResult=Td});var tC=p(Tt=>{"use strict";Object.defineProperty(Tt,"__esModule",{value:!0});Tt.VoiceInfo=Tt.SynthesisVoiceType=Tt.SynthesisVoiceGender=void 0;var ft;(function(i){i[i.Unknown=0]="Unknown",i[i.Female=1]="Female",i[i.Male=2]="Male",i[i.Neutral=3]="Neutral"})(ft=Tt.SynthesisVoiceGender||(Tt.SynthesisVoiceGender={}));var Od;(function(i){i[i.OnlineNeural=1]="OnlineNeural",i[i.OnlineStandard=2]="OnlineStandard",i[i.OfflineNeural=3]="OfflineNeural",i[i.OfflineStandard=4]="OfflineStandard"})(Od=Tt.SynthesisVoiceType||(Tt.SynthesisVoiceType={}));var eb={[ft[ft.Neutral]]:ft.Neutral,[ft[ft.Male]]:ft.Male,[ft[ft.Female]]:ft.Female},kd=class{constructor(e){if(this.privStyleList=[],e){if(this.privName=e.Name,this.privLocale=e.Locale,this.privShortName=e.ShortName,this.privLocaleName=e.LocaleName,this.privDisplayName=e.DisplayName,this.privLocalName=e.LocalName,this.privVoiceType=e.VoiceType.endsWith("Standard")?Od.OnlineStandard:Od.OnlineNeural,this.privGender=eb[e.Gender]||ft.Unknown,e.StyleList&&Array.isArray(e.StyleList))for(let t of e.StyleList)this.privStyleList.push(t);this.privSampleRateHertz=e.SampleRateHertz,this.privStatus=e.Status,e.ExtendedPropertyMap&&(this.privExtendedPropertyMap=e.ExtendedPropertyMap),this.privWordsPerMinute=e.WordsPerMinute,Array.isArray(e.SecondaryLocaleList)&&(this.privSecondaryLocaleList=[...e.SecondaryLocaleList]),Array.isArray(e.RolePlayList)&&(this.privRolePlayList=[...e.RolePlayList])}}get name(){return this.privName}get locale(){return this.privLocale}get shortName(){return this.privShortName}get displayName(){return this.privDisplayName}get localName(){return this.privLocalName}get localeName(){return this.privLocaleName}get gender(){return this.privGender}get voiceType(){return this.privVoiceType}get styleList(){return this.privStyleList}get sampleRateHertz(){return this.privSampleRateHertz}get status(){return this.privStatus}get extendedPropertyMap(){return this.privExtendedPropertyMap}get wordsPerMinute(){return this.privWordsPerMinute}get secondaryLocaleList(){return this.privSecondaryLocaleList}get rolePlayList(){return this.privRolePlayList}};Tt.VoiceInfo=kd});var iC=p(ac=>{"use strict";Object.defineProperty(ac,"__esModule",{value:!0});ac.SpeakerAudioDestination=void 0;var ei=P(),tb=Lr(),et=pr(),rb=60*30,rC={[et.AudioFormatTag.PCM]:"audio/wav",[et.AudioFormatTag.MuLaw]:"audio/x-wav",[et.AudioFormatTag.MP3]:"audio/mpeg",[et.AudioFormatTag.OGG_OPUS]:"audio/ogg",[et.AudioFormatTag.WEBM_OPUS]:"audio/webm; codecs=opus",[et.AudioFormatTag.ALaw]:"audio/x-wav",[et.AudioFormatTag.FLAC]:"audio/flac"},Md=class{constructor(e){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=e||ei.createNoDashGuid(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(e,t,r){this.privAudioBuffer!==void 0?(this.privAudioBuffer.push(e),this.updateSourceBuffer().then(()=>{t&&t()},n=>{r&&r(n)})):this.privAudioOutputStream!==void 0&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength)}close(e,t){if(this.privIsClosed=!0,this.privSourceBuffer!==void 0)this.handleSourceBufferUpdateEnd().then(()=>{e&&e()},r=>{t&&t(r)});else if(this.privAudioOutputStream!==void 0&&typeof window<"u")if((this.privFormat.formatTag===et.AudioFormatTag.PCM||this.privFormat.formatTag===et.AudioFormatTag.MuLaw||this.privFormat.formatTag===et.AudioFormatTag.ALaw)&&this.privFormat.hasHeader===!1)console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else{let r=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(r).then(()=>{r=this.privFormat.addHeader(r);let n=new Blob([r],{type:rC[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(n),this.notifyPlayback().then(()=>{e&&e()},s=>{t&&t(s)})},n=>{t&&t(n)})}else this.onAudioEnd&&this.onAudioEnd(this)}set format(e){if(typeof AudioContext<"u"||typeof window<"u"&&typeof window.webkitAudioContext<"u"){this.privFormat=e;let t=rC[this.privFormat.formatTag];t===void 0?console.warn(`Unknown mimeType for format ${et.AudioFormatTag[this.privFormat.formatTag]}; playback is not supported.`):typeof MediaSource<"u"&&MediaSource.isTypeSupported(t)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=rb,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(t),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch(r=>{ei.Events.instance.onEvent(new ei.BackgroundEvent(r))})},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch(r=>{ei.Events.instance.onEvent(new ei.BackgroundEvent(r))})},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch(r=>{ei.Events.instance.onEvent(new ei.BackgroundEvent(r))})):(console.warn(`Format ${et.AudioFormatTag[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new tb.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){return this.privAudio?.volume??-1}set volume(e){this.privAudio&&(this.privAudio.volume=e)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return this.privAudio!==void 0?this.privAudio.currentTime:-1}pause(){!this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.pause(),this.privIsPaused=!0)}resume(e,t){this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.play().then(()=>{e&&e()},r=>{t&&t(r)}),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}async updateSourceBuffer(){if(this.privAudioBuffer!==void 0&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;let e=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(e)}catch{this.privAudioBuffer.unshift(e),console.log("buffer filled, pausing addition of binaries until space is made");return}await this.notifyPlayback()}else this.canEndStream()&&await this.handleSourceBufferUpdateEnd()}async handleSourceBufferUpdateEnd(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),await this.notifyPlayback())}async notifyPlayback(){!this.privPlaybackStarted&&this.privAudio!==void 0&&(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||await this.privAudio.play())}canEndStream(){return this.isClosed&&this.privSourceBuffer!==void 0&&this.privAudioBuffer.length===0&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&this.privMediaSource.readyState==="open"}sourceBufferAvailable(){return this.privSourceBuffer!==void 0&&!this.privSourceBuffer.updating}};ac.SpeakerAudioDestination=Md});var nC=p(cc=>{"use strict";Object.defineProperty(cc,"__esModule",{value:!0});cc.ConversationTranscriptionCanceledEventArgs=void 0;var ib=Ii(),Dd=class extends ib.CancellationEventArgsBase{};cc.ConversationTranscriptionCanceledEventArgs=Dd});var sC=p(uc=>{"use strict";Object.defineProperty(uc,"__esModule",{value:!0});uc.MeetingTranscriptionCanceledEventArgs=void 0;var nb=Ii(),xd=class extends nb.CancellationEventArgsBase{};uc.MeetingTranscriptionCanceledEventArgs=xd});var oC=p(rs=>{"use strict";Object.defineProperty(rs,"__esModule",{value:!0});rs.PronunciationAssessmentGradingSystem=void 0;var sb;(function(i){i[i.FivePoint=1]="FivePoint",i[i.HundredMark=2]="HundredMark"})(sb=rs.PronunciationAssessmentGradingSystem||(rs.PronunciationAssessmentGradingSystem={}))});var aC=p(is=>{"use strict";Object.defineProperty(is,"__esModule",{value:!0});is.PronunciationAssessmentGranularity=void 0;var ob;(function(i){i[i.Phoneme=1]="Phoneme",i[i.Word=2]="Word",i[i.FullText=3]="FullText"})(ob=is.PronunciationAssessmentGranularity||(is.PronunciationAssessmentGranularity={}))});var cC=p(lc=>{"use strict";Object.defineProperty(lc,"__esModule",{value:!0});lc.PronunciationAssessmentConfig=void 0;var pc=_(),G=f(),Nd=class i{constructor(e,t=G.PronunciationAssessmentGradingSystem.FivePoint,r=G.PronunciationAssessmentGranularity.Phoneme,n=!1){pc.Contracts.throwIfNullOrUndefined(e,"referenceText"),this.privProperties=new G.PropertyCollection,this.privProperties.setProperty(G.PropertyId.PronunciationAssessment_ReferenceText,e),this.privProperties.setProperty(G.PropertyId.PronunciationAssessment_GradingSystem,G.PronunciationAssessmentGradingSystem[t]),this.privProperties.setProperty(G.PropertyId.PronunciationAssessment_Granularity,G.PronunciationAssessmentGranularity[r]),this.privProperties.setProperty(G.PropertyId.PronunciationAssessment_EnableMiscue,String(n))}static fromJSON(e){pc.Contracts.throwIfNullOrUndefined(e,"json");let t=new i("");return t.privProperties=new G.PropertyCollection,t.properties.setProperty(G.PropertyId.PronunciationAssessment_Json,e),t}toJSON(){return this.updateJson(),this.privProperties.getProperty(G.PropertyId.PronunciationAssessment_Params)}applyTo(e){this.updateJson();let t=e.internalData;t.expectContentAssessmentResponse=!!this.privContentAssessmentTopic,t.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(G.PropertyId.PronunciationAssessment_Params),this.privContentAssessmentTopic,t.isSpeakerDiarizationEnabled)}get referenceText(){return this.properties.getProperty(G.PropertyId.PronunciationAssessment_ReferenceText)}set referenceText(e){pc.Contracts.throwIfNullOrWhitespace(e,"referenceText"),this.properties.setProperty(G.PropertyId.PronunciationAssessment_ReferenceText,e)}set phonemeAlphabet(e){pc.Contracts.throwIfNullOrWhitespace(e,"phonemeAlphabet"),this.privPhonemeAlphabet=e}set enableMiscue(e){let t=e?"true":"false";this.properties.setProperty(G.PropertyId.PronunciationAssessment_EnableMiscue,t)}get enableMiscue(){return this.properties.getProperty(G.PropertyId.PronunciationAssessment_EnableMiscue,"false").toLowerCase()==="true"}set nbestPhonemeCount(e){this.privNBestPhonemeCount=e}set enableProsodyAssessment(e){this.privEnableProsodyAssessment=e}enableContentAssessmentWithTopic(e){this.privContentAssessmentTopic=e}get properties(){return this.privProperties}updateJson(){let e=this.privProperties.getProperty(G.PropertyId.PronunciationAssessment_Json,"{}"),t=JSON.parse(e),r=this.privProperties.getProperty(G.PropertyId.PronunciationAssessment_ReferenceText);r&&(t.referenceText=r);let n=this.privProperties.getProperty(G.PropertyId.PronunciationAssessment_GradingSystem);n&&(t.gradingSystem=n);let s=this.privProperties.getProperty(G.PropertyId.PronunciationAssessment_Granularity);s&&(t.granularity=s),this.privPhonemeAlphabet&&(t.phonemeAlphabet=this.privPhonemeAlphabet),this.privNBestPhonemeCount&&(t.nbestPhonemeCount=this.privNBestPhonemeCount),t.enableProsodyAssessment=this.privEnableProsodyAssessment,t.dimension="Comprehensive",this.privProperties.getProperty(G.PropertyId.PronunciationAssessment_EnableMiscue)&&(t.enableMiscue=this.enableMiscue),this.privProperties.setProperty(G.PropertyId.PronunciationAssessment_Params,JSON.stringify(t))}};lc.PronunciationAssessmentConfig=Nd});var uC=p(Bi=>{"use strict";Object.defineProperty(Bi,"__esModule",{value:!0});Bi.PronunciationAssessmentResult=Bi.ContentAssessmentResult=void 0;var qd=_(),ab=f(),hc=class{constructor(e){this.privPronJson=e}get grammarScore(){return this.privPronJson.ContentAssessment.GrammarScore}get vocabularyScore(){return this.privPronJson.ContentAssessment.VocabularyScore}get topicScore(){return this.privPronJson.ContentAssessment.TopicScore}};Bi.ContentAssessmentResult=hc;var jd=class i{constructor(e){let t=JSON.parse(e);qd.Contracts.throwIfNullOrUndefined(t.NBest[0],"NBest"),this.privPronJson=t.NBest[0]}static fromResult(e){qd.Contracts.throwIfNullOrUndefined(e,"result");let t=e.properties.getProperty(ab.PropertyId.SpeechServiceResponse_JsonResult);return qd.Contracts.throwIfNullOrUndefined(t,"json"),new i(t)}get detailResult(){return this.privPronJson}get accuracyScore(){return this.detailResult.PronunciationAssessment?.AccuracyScore}get pronunciationScore(){return this.detailResult.PronunciationAssessment?.PronScore}get completenessScore(){return this.detailResult.PronunciationAssessment?.CompletenessScore}get fluencyScore(){return this.detailResult.PronunciationAssessment?.FluencyScore}get prosodyScore(){return this.detailResult.PronunciationAssessment?.ProsodyScore}get contentAssessmentResult(){if(this.detailResult.ContentAssessment!==void 0)return new hc(this.detailResult)}};Bi.PronunciationAssessmentResult=jd});var pC=p(dc=>{"use strict";Object.defineProperty(dc,"__esModule",{value:!0});dc.AvatarConfig=void 0;var cb=_(),ub=f(),zd=class{constructor(e,t,r){this.privCustomized=!1,cb.Contracts.throwIfNullOrWhitespace(e,"character"),this.character=e,this.style=t,r===void 0&&(r=new ub.AvatarVideoFormat),this.videoFormat=r}get customized(){return this.privCustomized}set customized(e){this.privCustomized=e}get backgroundColor(){return this.privBackgroundColor}set backgroundColor(e){this.privBackgroundColor=e}};dc.AvatarConfig=zd});var lC=p(ti=>{"use strict";Object.defineProperty(ti,"__esModule",{value:!0});ti.AvatarEventArgs=ti.AvatarEventTypes=void 0;var pb;(function(i){i.SwitchedToSpeaking="SwitchedToSpeaking",i.SwitchedToIdle="SwitchedToIdle",i.SessionClosed="SessionClosed"})(pb=ti.AvatarEventTypes||(ti.AvatarEventTypes={}));var Ld=class{constructor(e,t){this.privOffset=e,this.privDescription=t}get type(){return this.privType}get offset(){return this.privOffset}get description(){return this.privDescription}};ti.AvatarEventArgs=Ld});var Fd=p(fc=>{"use strict";Object.defineProperty(fc,"__esModule",{value:!0});fc.SpeechSynthesisConnectionFactory=void 0;var hC=ce(),ns=f(),lb=Ze(),hb=C(),db=Ie(),vc=$t(),Bd=class{constructor(){this.synthesisUri="/cognitiveservices/websocket/v1"}create(e,t,r){let n=e.parameters.getProperty(ns.PropertyId.SpeechServiceConnection_Endpoint,void 0),s=e.parameters.getProperty(ns.PropertyId.SpeechServiceConnection_Region,void 0),o=lb.ConnectionFactoryBase.getHostSuffix(s),a=e.parameters.getProperty(ns.PropertyId.SpeechServiceConnection_EndpointId,void 0),c=a===void 0?"tts":"voice",u=e.parameters.getProperty(ns.PropertyId.SpeechServiceConnection_Host,"wss://"+s+"."+c+".speech"+o),l={},h={};t.token!==void 0&&t.token!==""&&(h[t.headerName]=t.token),h[db.HeaderNames.ConnectionId]=r,a!==void 0&&a!==""&&(!n||n.search(vc.QueryParameterNames.CustomVoiceDeploymentId)===-1)&&(l[vc.QueryParameterNames.CustomVoiceDeploymentId]=a),e.avatarEnabled&&(!n||n.search(vc.QueryParameterNames.EnableAvatar)===-1)&&(l[vc.QueryParameterNames.EnableAvatar]="true"),n||(n=u+this.synthesisUri),e.parameters.setProperty(ns.PropertyId.SpeechServiceConnection_Url,n);let d=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new hC.WebsocketConnection(n,l,h,new hb.WebsocketMessageFormatter,hC.ProxyInfo.fromParameters(e.parameters),d,r)}};fc.SpeechSynthesisConnectionFactory=Bd});var dC=p(mc=>{"use strict";Object.defineProperty(mc,"__esModule",{value:!0});mc.AvatarSynthesizer=void 0;var vb=Fd(),fb=C(),X=P(),gb=Pi(),Xt=f(),gc=_(),mb=Za(),Vd=class extends Xt.Synthesizer{constructor(e,t){super(e),gc.Contracts.throwIfNullOrUndefined(t,"avatarConfig"),this.privConnectionFactory=new vb.SpeechSynthesisConnectionFactory,this.privAvatarConfig=t,this.implCommonSynthesizeSetup()}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=gb.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(Xt.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm)}async startAvatarAsync(e){gc.Contracts.throwIfNullOrUndefined(e,"peerConnection"),this.privIceServers=e.getConfiguration().iceServers,gc.Contracts.throwIfNullOrUndefined(this.privIceServers,"Ice servers must be set.");let t=new X.Deferred;e.onicegatheringstatechange=()=>{X.Events.instance.onEvent(new X.PlatformEvent("peer connection: ice gathering state: "+e.iceGatheringState,X.EventType.Debug)),e.iceGatheringState==="complete"&&(X.Events.instance.onEvent(new X.PlatformEvent("peer connection: ice gathering complete.",X.EventType.Info)),t.resolve())},e.onicecandidate=a=>{a.candidate?X.Events.instance.onEvent(new X.PlatformEvent("peer connection: ice candidate: "+a.candidate.candidate,X.EventType.Debug)):(X.Events.instance.onEvent(new X.PlatformEvent("peer connection: ice candidate: complete",X.EventType.Debug)),t.resolve())},setTimeout(()=>{e.iceGatheringState!=="complete"&&(X.Events.instance.onEvent(new X.PlatformEvent("peer connection: ice gathering timeout.",X.EventType.Warning)),t.resolve())},2e3);let r=await e.createOffer();await e.setLocalDescription(r),await t.promise,X.Events.instance.onEvent(new X.PlatformEvent("peer connection: got local SDP.",X.EventType.Info)),this.privProperties.setProperty(Xt.PropertyId.TalkingAvatarService_WebRTC_SDP,JSON.stringify(e.localDescription));let n=await this.speak("",!1);if(n.reason!==Xt.ResultReason.SynthesizingAudioCompleted)return new Xt.SynthesisResult(n.resultId,n.reason,n.errorDetails,n.properties);let s=atob(n.properties.getProperty(Xt.PropertyId.TalkingAvatarService_WebRTC_SDP)),o=new RTCSessionDescription(JSON.parse(s));return await e.setRemoteDescription(o),new Xt.SynthesisResult(n.resultId,n.reason,void 0,n.properties)}async speakTextAsync(e){let t=await this.speak(e,!1);return new Xt.SynthesisResult(t.resultId,t.reason,t.errorDetails,t.properties)}async speakSsmlAsync(e){let t=await this.speak(e,!0);return new Xt.SynthesisResult(t.resultId,t.reason,t.errorDetails,t.properties)}async stopSpeakingAsync(){for(;this.synthesisRequestQueue.length()>0;)(await this.synthesisRequestQueue.dequeue()).err("Synthesis is canceled by user.");return this.privAdapter.stopSpeaking()}async stopAvatarAsync(){return gc.Contracts.throwIfDisposed(this.privDisposed),this.dispose(!0)}async close(){if(!this.privDisposed)return this.dispose(!0)}get iceServers(){return this.privIceServers}createSynthesisAdapter(e,t,r){return new fb.AvatarSynthesisAdapter(e,t,r,this,this.privAvatarConfig)}createRestSynthesisAdapter(e,t){}createSynthesizerConfig(e){let t=super.createSynthesizerConfig(e);return t.avatarEnabled=!0,t}async speak(e,t){let r=X.createNoDashGuid(),n=new X.Deferred;return this.synthesisRequestQueue.enqueue(new mb.SynthesisRequest(r,e,t,s=>{n.resolve(s),this.privSynthesizing=!1,this.adapterSpeak()},s=>{n.reject(s),this.privSynthesizing=!1})),this.adapterSpeak(),n.promise}};mc.AvatarSynthesizer=Vd});var vC=p(Fi=>{"use strict";Object.defineProperty(Fi,"__esModule",{value:!0});Fi.AvatarVideoFormat=Fi.Coordinate=void 0;var Ud=class{constructor(e,t){this.x=e,this.y=t}};Fi.Coordinate=Ud;var Wd=class{constructor(e="H264",t=2e6,r=1920,n=1080){this.codec=e,this.bitrate=t,this.width=r,this.height=n}setCropRange(e,t){this.cropRange={bottomRight:t,topLeft:e}}};Fi.AvatarVideoFormat=Wd});var fC=p(yc=>{"use strict";Object.defineProperty(yc,"__esModule",{value:!0});yc.AvatarWebRTCConnectionResult=void 0;var yb=f(),Hd=class extends yb.SynthesisResult{constructor(e,t,r,n,s){super(t,r,n,s),this.privSDPAnswer=e}get SDPAnswer(){return this.privSDPAnswer}};yc.AvatarWebRTCConnectionResult=Hd});var gC=p(Cc=>{"use strict";Object.defineProperty(Cc,"__esModule",{value:!0});Cc.Diagnostics=void 0;var Sb=ce(),Cb=P(),Sc=class{static SetLoggingLevel(e){this.privListener=new Sb.ConsoleLoggingListener(e),Cb.Events.instance.attachConsoleListener(this.privListener)}static StartConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!0)}static StopConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!1)}static SetLogOutputPath(e){if(typeof window>"u")this.privListener&&(this.privListener.logPath=e);else throw new Error("File system logging not available in browser.")}static set onLogOutput(e){this.privListener&&(this.privListener.logCallback=e)}};Cc.Diagnostics=Sc;Sc.privListener=void 0});var f=p(v=>{"use strict";Object.defineProperty(v,"__esModule",{value:!0});var Pb=Ml();Object.defineProperty(v,"AudioConfig",{enumerable:!0,get:function(){return Pb.AudioConfig}});var mC=pr();Object.defineProperty(v,"AudioStreamFormat",{enumerable:!0,get:function(){return mC.AudioStreamFormat}});Object.defineProperty(v,"AudioFormatTag",{enumerable:!0,get:function(){return mC.AudioFormatTag}});var Kd=Tl();Object.defineProperty(v,"AudioInputStream",{enumerable:!0,get:function(){return Kd.AudioInputStream}});Object.defineProperty(v,"PullAudioInputStream",{enumerable:!0,get:function(){return Kd.PullAudioInputStream}});Object.defineProperty(v,"PushAudioInputStream",{enumerable:!0,get:function(){return Kd.PushAudioInputStream}});var Jd=Lr();Object.defineProperty(v,"AudioOutputStream",{enumerable:!0,get:function(){return Jd.AudioOutputStream}});Object.defineProperty(v,"PullAudioOutputStream",{enumerable:!0,get:function(){return Jd.PullAudioOutputStream}});Object.defineProperty(v,"PushAudioOutputStream",{enumerable:!0,get:function(){return Jd.PushAudioOutputStream}});var Rb=iy();Object.defineProperty(v,"CancellationReason",{enumerable:!0,get:function(){return Rb.CancellationReason}});var Eb=ny();Object.defineProperty(v,"PullAudioInputStreamCallback",{enumerable:!0,get:function(){return Eb.PullAudioInputStreamCallback}});var _b=sy();Object.defineProperty(v,"PushAudioOutputStreamCallback",{enumerable:!0,get:function(){return _b.PushAudioOutputStreamCallback}});var Ib=ay();Object.defineProperty(v,"KeywordRecognitionModel",{enumerable:!0,get:function(){return Ib.KeywordRecognitionModel}});var wb=cy();Object.defineProperty(v,"SessionEventArgs",{enumerable:!0,get:function(){return wb.SessionEventArgs}});var bb=uy();Object.defineProperty(v,"RecognitionEventArgs",{enumerable:!0,get:function(){return bb.RecognitionEventArgs}});var Ab=py();Object.defineProperty(v,"OutputFormat",{enumerable:!0,get:function(){return Ab.OutputFormat}});var Tb=ly();Object.defineProperty(v,"IntentRecognitionEventArgs",{enumerable:!0,get:function(){return Tb.IntentRecognitionEventArgs}});var Ob=hy();Object.defineProperty(v,"RecognitionResult",{enumerable:!0,get:function(){return Ob.RecognitionResult}});var kb=dy();Object.defineProperty(v,"SpeechRecognitionResult",{enumerable:!0,get:function(){return kb.SpeechRecognitionResult}});var Mb=vy();Object.defineProperty(v,"IntentRecognitionResult",{enumerable:!0,get:function(){return Mb.IntentRecognitionResult}});var Db=fy();Object.defineProperty(v,"LanguageUnderstandingModel",{enumerable:!0,get:function(){return Db.LanguageUnderstandingModel}});var Gd=my();Object.defineProperty(v,"SpeechRecognitionEventArgs",{enumerable:!0,get:function(){return Gd.SpeechRecognitionEventArgs}});Object.defineProperty(v,"ConversationTranscriptionEventArgs",{enumerable:!0,get:function(){return Gd.ConversationTranscriptionEventArgs}});Object.defineProperty(v,"MeetingTranscriptionEventArgs",{enumerable:!0,get:function(){return Gd.MeetingTranscriptionEventArgs}});var xb=yy();Object.defineProperty(v,"SpeechRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return xb.SpeechRecognitionCanceledEventArgs}});var Nb=Sy();Object.defineProperty(v,"TranslationRecognitionEventArgs",{enumerable:!0,get:function(){return Nb.TranslationRecognitionEventArgs}});var qb=Cy();Object.defineProperty(v,"TranslationSynthesisEventArgs",{enumerable:!0,get:function(){return qb.TranslationSynthesisEventArgs}});var jb=$l();Object.defineProperty(v,"TranslationRecognitionResult",{enumerable:!0,get:function(){return jb.TranslationRecognitionResult}});var zb=Py();Object.defineProperty(v,"TranslationSynthesisResult",{enumerable:!0,get:function(){return zb.TranslationSynthesisResult}});var Lb=Ry();Object.defineProperty(v,"ResultReason",{enumerable:!0,get:function(){return Lb.ResultReason}});var yC=Ey();Object.defineProperty(v,"SpeechConfig",{enumerable:!0,get:function(){return yC.SpeechConfig}});Object.defineProperty(v,"SpeechConfigImpl",{enumerable:!0,get:function(){return yC.SpeechConfigImpl}});var SC=_y();Object.defineProperty(v,"SpeechTranslationConfig",{enumerable:!0,get:function(){return SC.SpeechTranslationConfig}});Object.defineProperty(v,"SpeechTranslationConfigImpl",{enumerable:!0,get:function(){return SC.SpeechTranslationConfigImpl}});var Bb=Zl();Object.defineProperty(v,"PropertyCollection",{enumerable:!0,get:function(){return Bb.PropertyCollection}});var Fb=Lo();Object.defineProperty(v,"PropertyId",{enumerable:!0,get:function(){return Fb.PropertyId}});var Vb=by();Object.defineProperty(v,"Recognizer",{enumerable:!0,get:function(){return Vb.Recognizer}});var Ub=Ay();Object.defineProperty(v,"SpeechRecognizer",{enumerable:!0,get:function(){return Ub.SpeechRecognizer}});var Wb=Ty();Object.defineProperty(v,"IntentRecognizer",{enumerable:!0,get:function(){return Wb.IntentRecognizer}});var Hb=Oy();Object.defineProperty(v,"VoiceProfileType",{enumerable:!0,get:function(){return Hb.VoiceProfileType}});var Kb=xy();Object.defineProperty(v,"TranslationRecognizer",{enumerable:!0,get:function(){return Kb.TranslationRecognizer}});var Jb=Ny();Object.defineProperty(v,"Translations",{enumerable:!0,get:function(){return Jb.Translations}});var Gb=qy();Object.defineProperty(v,"NoMatchReason",{enumerable:!0,get:function(){return Gb.NoMatchReason}});var $b=jy();Object.defineProperty(v,"NoMatchDetails",{enumerable:!0,get:function(){return $b.NoMatchDetails}});var Qb=zy();Object.defineProperty(v,"TranslationRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return Qb.TranslationRecognitionCanceledEventArgs}});var Xb=Ly();Object.defineProperty(v,"IntentRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return Xb.IntentRecognitionCanceledEventArgs}});var Zb=gh();Object.defineProperty(v,"CancellationDetailsBase",{enumerable:!0,get:function(){return Zb.CancellationDetailsBase}});var Yb=By();Object.defineProperty(v,"CancellationDetails",{enumerable:!0,get:function(){return Yb.CancellationDetails}});var eA=Fy();Object.defineProperty(v,"CancellationErrorCode",{enumerable:!0,get:function(){return eA.CancellationErrorCode}});var tA=Vy();Object.defineProperty(v,"ConnectionEventArgs",{enumerable:!0,get:function(){return tA.ConnectionEventArgs}});var rA=Uy();Object.defineProperty(v,"ServiceEventArgs",{enumerable:!0,get:function(){return rA.ServiceEventArgs}});var iA=ch();Object.defineProperty(v,"Connection",{enumerable:!0,get:function(){return iA.Connection}});var nA=Wy();Object.defineProperty(v,"PhraseListGrammar",{enumerable:!0,get:function(){return nA.PhraseListGrammar}});var sA=ca();Object.defineProperty(v,"DialogServiceConfig",{enumerable:!0,get:function(){return sA.DialogServiceConfig}});var oA=Hy();Object.defineProperty(v,"BotFrameworkConfig",{enumerable:!0,get:function(){return oA.BotFrameworkConfig}});var aA=Ky();Object.defineProperty(v,"CustomCommandsConfig",{enumerable:!0,get:function(){return aA.CustomCommandsConfig}});var cA=Xy();Object.defineProperty(v,"DialogServiceConnector",{enumerable:!0,get:function(){return cA.DialogServiceConnector}});var uA=Zy();Object.defineProperty(v,"ActivityReceivedEventArgs",{enumerable:!0,get:function(){return uA.ActivityReceivedEventArgs}});var pA=eS();Object.defineProperty(v,"TurnStatusReceivedEventArgs",{enumerable:!0,get:function(){return pA.TurnStatusReceivedEventArgs}});var lA=tS();Object.defineProperty(v,"ServicePropertyChannel",{enumerable:!0,get:function(){return lA.ServicePropertyChannel}});var hA=rS();Object.defineProperty(v,"ProfanityOption",{enumerable:!0,get:function(){return hA.ProfanityOption}});var dA=iS();Object.defineProperty(v,"BaseAudioPlayer",{enumerable:!0,get:function(){return dA.BaseAudioPlayer}});var vA=nS();Object.defineProperty(v,"ConnectionMessageEventArgs",{enumerable:!0,get:function(){return vA.ConnectionMessageEventArgs}});var fA=nh();Object.defineProperty(v,"ConnectionMessage",{enumerable:!0,get:function(){return fA.ConnectionMessage}});var gA=sS();Object.defineProperty(v,"VoiceProfile",{enumerable:!0,get:function(){return gA.VoiceProfile}});var CC=aS();Object.defineProperty(v,"VoiceProfileEnrollmentResult",{enumerable:!0,get:function(){return CC.VoiceProfileEnrollmentResult}});Object.defineProperty(v,"VoiceProfileEnrollmentCancellationDetails",{enumerable:!0,get:function(){return CC.VoiceProfileEnrollmentCancellationDetails}});var PC=uS();Object.defineProperty(v,"VoiceProfileResult",{enumerable:!0,get:function(){return PC.VoiceProfileResult}});Object.defineProperty(v,"VoiceProfileCancellationDetails",{enumerable:!0,get:function(){return PC.VoiceProfileCancellationDetails}});var mA=pS();Object.defineProperty(v,"VoiceProfilePhraseResult",{enumerable:!0,get:function(){return mA.VoiceProfilePhraseResult}});var yA=lS();Object.defineProperty(v,"VoiceProfileClient",{enumerable:!0,get:function(){return yA.VoiceProfileClient}});var SA=hS();Object.defineProperty(v,"SpeakerRecognizer",{enumerable:!0,get:function(){return SA.SpeakerRecognizer}});var CA=dS();Object.defineProperty(v,"SpeakerIdentificationModel",{enumerable:!0,get:function(){return CA.SpeakerIdentificationModel}});var PA=fS();Object.defineProperty(v,"SpeakerVerificationModel",{enumerable:!0,get:function(){return PA.SpeakerVerificationModel}});var RA=mS();Object.defineProperty(v,"AutoDetectSourceLanguageConfig",{enumerable:!0,get:function(){return RA.AutoDetectSourceLanguageConfig}});var EA=SS();Object.defineProperty(v,"AutoDetectSourceLanguageResult",{enumerable:!0,get:function(){return EA.AutoDetectSourceLanguageResult}});var _A=CS();Object.defineProperty(v,"SourceLanguageConfig",{enumerable:!0,get:function(){return _A.SourceLanguageConfig}});var $d=RS();Object.defineProperty(v,"SpeakerRecognitionResult",{enumerable:!0,get:function(){return $d.SpeakerRecognitionResult}});Object.defineProperty(v,"SpeakerRecognitionResultType",{enumerable:!0,get:function(){return $d.SpeakerRecognitionResultType}});Object.defineProperty(v,"SpeakerRecognitionCancellationDetails",{enumerable:!0,get:function(){return $d.SpeakerRecognitionCancellationDetails}});var ze=Ha();Object.defineProperty(v,"Conversation",{enumerable:!0,get:function(){return ze.Conversation}});Object.defineProperty(v,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return ze.ConversationExpirationEventArgs}});Object.defineProperty(v,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return ze.ConversationParticipantsChangedEventArgs}});Object.defineProperty(v,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return ze.ConversationTranslationCanceledEventArgs}});Object.defineProperty(v,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return ze.ConversationTranslationEventArgs}});Object.defineProperty(v,"ConversationTranslationResult",{enumerable:!0,get:function(){return ze.ConversationTranslationResult}});Object.defineProperty(v,"ConversationTranslator",{enumerable:!0,get:function(){return ze.ConversationTranslator}});Object.defineProperty(v,"ConversationTranscriber",{enumerable:!0,get:function(){return ze.ConversationTranscriber}});Object.defineProperty(v,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return ze.ConversationTranscriptionResult}});Object.defineProperty(v,"Meeting",{enumerable:!0,get:function(){return ze.Meeting}});Object.defineProperty(v,"MeetingTranscriber",{enumerable:!0,get:function(){return ze.MeetingTranscriber}});Object.defineProperty(v,"Participant",{enumerable:!0,get:function(){return ze.Participant}});Object.defineProperty(v,"ParticipantChangedReason",{enumerable:!0,get:function(){return ze.ParticipantChangedReason}});Object.defineProperty(v,"User",{enumerable:!0,get:function(){return ze.User}});var IA=Za();Object.defineProperty(v,"Synthesizer",{enumerable:!0,get:function(){return IA.Synthesizer}});var wA=Ol();Object.defineProperty(v,"SpeechSynthesisOutputFormat",{enumerable:!0,get:function(){return wA.SpeechSynthesisOutputFormat}});var bA=KS();Object.defineProperty(v,"SpeechSynthesizer",{enumerable:!0,get:function(){return bA.SpeechSynthesizer}});var AA=JS();Object.defineProperty(v,"SynthesisResult",{enumerable:!0,get:function(){return AA.SynthesisResult}});var TA=GS();Object.defineProperty(v,"SpeechSynthesisResult",{enumerable:!0,get:function(){return TA.SpeechSynthesisResult}});var OA=$S();Object.defineProperty(v,"SpeechSynthesisEventArgs",{enumerable:!0,get:function(){return OA.SpeechSynthesisEventArgs}});var kA=QS();Object.defineProperty(v,"SpeechSynthesisWordBoundaryEventArgs",{enumerable:!0,get:function(){return kA.SpeechSynthesisWordBoundaryEventArgs}});var MA=XS();Object.defineProperty(v,"SpeechSynthesisBookmarkEventArgs",{enumerable:!0,get:function(){return MA.SpeechSynthesisBookmarkEventArgs}});var DA=ZS();Object.defineProperty(v,"SpeechSynthesisVisemeEventArgs",{enumerable:!0,get:function(){return DA.SpeechSynthesisVisemeEventArgs}});var xA=YS();Object.defineProperty(v,"SpeechSynthesisBoundaryType",{enumerable:!0,get:function(){return xA.SpeechSynthesisBoundaryType}});var NA=eC();Object.defineProperty(v,"SynthesisVoicesResult",{enumerable:!0,get:function(){return NA.SynthesisVoicesResult}});var qA=tC();Object.defineProperty(v,"VoiceInfo",{enumerable:!0,get:function(){return qA.VoiceInfo}});var jA=iC();Object.defineProperty(v,"SpeakerAudioDestination",{enumerable:!0,get:function(){return jA.SpeakerAudioDestination}});var zA=nC();Object.defineProperty(v,"ConversationTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return zA.ConversationTranscriptionCanceledEventArgs}});var LA=sC();Object.defineProperty(v,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return LA.MeetingTranscriptionCanceledEventArgs}});var BA=oC();Object.defineProperty(v,"PronunciationAssessmentGradingSystem",{enumerable:!0,get:function(){return BA.PronunciationAssessmentGradingSystem}});var FA=aC();Object.defineProperty(v,"PronunciationAssessmentGranularity",{enumerable:!0,get:function(){return FA.PronunciationAssessmentGranularity}});var VA=cC();Object.defineProperty(v,"PronunciationAssessmentConfig",{enumerable:!0,get:function(){return VA.PronunciationAssessmentConfig}});var UA=uC();Object.defineProperty(v,"PronunciationAssessmentResult",{enumerable:!0,get:function(){return UA.PronunciationAssessmentResult}});var WA=Hh();Object.defineProperty(v,"LanguageIdMode",{enumerable:!0,get:function(){return WA.LanguageIdMode}});var HA=pC();Object.defineProperty(v,"AvatarConfig",{enumerable:!0,get:function(){return HA.AvatarConfig}});var KA=lC();Object.defineProperty(v,"AvatarEventArgs",{enumerable:!0,get:function(){return KA.AvatarEventArgs}});var JA=dC();Object.defineProperty(v,"AvatarSynthesizer",{enumerable:!0,get:function(){return JA.AvatarSynthesizer}});var RC=vC();Object.defineProperty(v,"AvatarVideoFormat",{enumerable:!0,get:function(){return RC.AvatarVideoFormat}});Object.defineProperty(v,"Coordinate",{enumerable:!0,get:function(){return RC.Coordinate}});var GA=fC();Object.defineProperty(v,"AvatarWebRTCConnectionResult",{enumerable:!0,get:function(){return GA.AvatarWebRTCConnectionResult}});var $A=gC();Object.defineProperty(v,"Diagnostics",{enumerable:!0,get:function(){return $A.Diagnostics}});var QA=fl();Object.defineProperty(v,"LogLevel",{enumerable:!0,get:function(){return QA.LogLevel}})});var EC=p(Rc=>{"use strict";Object.defineProperty(Rc,"__esModule",{value:!0});Rc.ProxyInfo=void 0;var Pc=f(),Qd=class i{constructor(e,t,r,n){this.privProxyHostName=e,this.privProxyPort=t,this.privProxyUserName=r,this.privProxyPassword=n}static fromParameters(e){return new i(e.getProperty(Pc.PropertyId.SpeechServiceConnection_ProxyHostName),parseInt(e.getProperty(Pc.PropertyId.SpeechServiceConnection_ProxyPort),10),e.getProperty(Pc.PropertyId.SpeechServiceConnection_ProxyUserName),e.getProperty(Pc.PropertyId.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(e){return this.fromParameters(e.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}};Rc.ProxyInfo=Qd});var IC=p((l1,_C)=>{"use strict";var XA=new Set(["json","buffer","string"]);_C.exports=i=>(...e)=>{let t=new Set,r,n,s,o="";return e.forEach(a=>{if(typeof a=="string")if(a.toUpperCase()===a)if(r){let c=`Can't set method to ${a}, already set to ${r}.`;throw new Error(c)}else r=a;else if(a.startsWith("http:")||a.startsWith("https:"))o=a;else if(XA.has(a))n=a;else throw new Error(`Unknown encoding, ${a}`);else if(typeof a=="number")t.add(a);else if(typeof a=="object")if(Array.isArray(a)||a instanceof Set)a.forEach(c=>t.add(c));else{if(s)throw new Error("Cannot set headers twice.");s=a}else throw new Error(`Unknown type: ${typeof a}`)}),r||(r="GET"),t.size===0&&t.add(200),i(t,r,n,s,o)}});var bC=p((h1,wC)=>{"use strict";var ZA=IC(),Xd=class i extends Error{constructor(e,...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,i),this.name="StatusError",this.message=e.statusMessage,this.statusCode=e.status,this.res=e,this.json=e.json.bind(e),this.text=e.text.bind(e),this.arrayBuffer=e.arrayBuffer.bind(e);let r;Object.defineProperty(this,"responseBody",{get:()=>(r||(r=this.arrayBuffer()),r)}),this.headers={};for(let[s,o]of e.headers.entries())this.headers[s.toLowerCase()]=o}},YA=(i,e,t,r,n)=>async(s,o,a={})=>{s=n+(s||"");let c=new URL(s);if(r||(r={}),c.username&&(r.Authorization="Basic "+btoa(c.username+":"+c.password),c=new URL(c.protocol+"//"+c.host+c.pathname+c.search)),c.protocol!=="https:"&&c.protocol!=="http:")throw new Error(`Unknown protocol, ${c.protocol}`);if(o&&!(o instanceof ArrayBuffer||ArrayBuffer.isView(o)||typeof o=="string"))if(typeof o=="object")o=JSON.stringify(o),r["Content-Type"]="application/json";else throw new Error("Unknown body type.");a=new Headers({...r||{},...a});let u=await fetch(c,{method:e,headers:a,body:o});if(u.statusCode=u.status,!i.has(u.status))throw new Xd(u);return t==="json"?u.json():t==="buffer"?u.arrayBuffer():t==="string"?u.text():u};wC.exports=ZA(YA)});var TC=p(Zt=>{"use strict";var eT=Zt&&Zt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Zt,"__esModule",{value:!0});Zt.RestMessageAdapter=Zt.RestRequestType=void 0;var tT=eT(bC()),AC=P(),Ec;(function(i){i.Get="GET",i.Post="POST",i.Delete="DELETE",i.File="file"})(Ec=Zt.RestRequestType||(Zt.RestRequestType={}));var Zd=class{constructor(e){if(!e)throw new AC.ArgumentNullError("configParams");this.privHeaders=e.headers,this.privIgnoreCache=e.ignoreCache}static extractHeaderValue(e,t){let r="";try{let n=t.trim().split(/[\r\n]+/),s={};n.forEach(o=>{let a=o.split(": "),c=a.shift().toLowerCase(),u=a.join(": ");s[c]=u}),r=s[e.toLowerCase()]}catch{}return r}set options(e){this.privHeaders=e.headers,this.privIgnoreCache=e.ignoreCache}setHeaders(e,t){this.privHeaders[e]=t}request(e,t,r={},n=null){let s=new AC.Deferred,o=e===Ec.File?"POST":e,a=(u,l={})=>{let h=u;return{data:JSON.stringify(l),headers:JSON.stringify(u.headers),json:l,ok:u.statusCode>=200&&u.statusCode<300,status:u.statusCode,statusText:l.error?l.error.message:h.statusText?h.statusText:h.statusMessage}},c=u=>{let l=tT.default(t,o,this.privHeaders,200,201,202,204,400,401,402,403,404),h=this.queryParams(r)===""?"":`?${this.queryParams(r)}`;l(h,u).then(async d=>{if(e===Ec.Delete||d.statusCode===204)s.resolve(a(d));else try{let g=await d.json();s.resolve(a(d,g))}catch{s.resolve(a(d))}}).catch(d=>{s.reject(d)})};return this.privIgnoreCache&&(this.privHeaders["Cache-Control"]="no-cache"),e===Ec.Post&&n&&(this.privHeaders["content-type"]="application/json",this.privHeaders["Content-Type"]="application/json"),c(n),s.promise}queryParams(e={}){return Object.keys(e).map(t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t])).join("&")}};Zt.RestMessageAdapter=Zd});var Yd=p(_c=>{"use strict";Object.defineProperty(_c,"__esModule",{value:!0});_c.RestConfigBase=void 0;var Vi=class i{static get requestOptions(){return i.privDefaultRequestOptions}static get configParams(){return i.privDefaultParams}static get restErrors(){return i.privRestErrors}};_c.RestConfigBase=Vi;Vi.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4};Vi.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."};Vi.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"}});var ce=p(ge=>{"use strict";var rT=ge&&ge.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t),Object.defineProperty(i,r,{enumerable:!0,get:function(){return e[t]}})}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),gt=ge&&ge.__exportStar||function(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&rT(e,i,t)};Object.defineProperty(ge,"__esModule",{value:!0});gt(Lm(),ge);gt(Fm(),ge);gt(Wm(),ge);gt(Km(),ge);gt(Jm(),ge);gt(ey(),ge);gt(Pl(),ge);gt(ty(),ge);gt(EC(),ge);gt(TC(),ge);gt(Yd(),ge)});var MC=p(Ic=>{"use strict";Object.defineProperty(Ic,"__esModule",{value:!0});Ic.IntentConnectionFactory=void 0;var OC=ce(),ss=f(),kC=Ze(),iT=C(),nT=Ie(),ev=class extends kC.ConnectionFactoryBase{create(e,t,r){let n=e.parameters.getProperty(ss.PropertyId.SpeechServiceConnection_Endpoint);if(!n){let c=e.parameters.getProperty(ss.PropertyId.SpeechServiceConnection_IntentRegion),u=kC.ConnectionFactoryBase.getHostSuffix(c);n=e.parameters.getProperty(ss.PropertyId.SpeechServiceConnection_Host,"wss://"+c+".sr.speech"+u)+"/speech/recognition/interactive/cognitiveservices/v1"}let s={format:"simple",language:e.parameters.getProperty(ss.PropertyId.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(e,s,n);let o={};t.token!==void 0&&t.token!==""&&(o[t.headerName]=t.token),o[nT.HeaderNames.ConnectionId]=r,e.parameters.setProperty(ss.PropertyId.SpeechServiceConnection_Url,n);let a=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new OC.WebsocketConnection(n,s,o,new iT.WebsocketMessageFormatter,OC.ProxyInfo.fromRecognizerConfig(e),a,r)}getSpeechRegionFromIntentRegion(e){switch(e){case"West US":case"US West":case"westus":return"uswest";case"West US 2":case"US West 2":case"westus2":return"uswest2";case"South Central US":case"US South Central":case"southcentralus":return"ussouthcentral";case"West Central US":case"US West Central":case"westcentralus":return"uswestcentral";case"East US":case"US East":case"eastus":return"useast";case"East US 2":case"US East 2":case"eastus2":return"useast2";case"West Europe":case"Europe West":case"westeurope":return"europewest";case"North Europe":case"Europe North":case"northeurope":return"europenorth";case"Brazil South":case"South Brazil":case"southbrazil":return"brazilsouth";case"Australia East":case"East Australia":case"eastaustralia":return"australiaeast";case"Southeast Asia":case"Asia Southeast":case"southeastasia":return"asiasoutheast";case"East Asia":case"Asia East":case"eastasia":return"asiaeast";default:return e}}};Ic.IntentConnectionFactory=ev});var qC=p(Ui=>{"use strict";Object.defineProperty(Ui,"__esModule",{value:!0});Ui.VoiceProfileConnectionFactory=Ui.SpeakerRecognitionConnectionFactory=void 0;var DC=ce(),ri=f(),xC=Ze(),sT=C(),NC=Ie(),wc=class extends xC.ConnectionFactoryBase{create(e,t,r,n){let s=e.parameters.getProperty(ri.PropertyId.SpeechServiceConnection_Endpoint);if(!s){let u=e.parameters.getProperty(ri.PropertyId.SpeechServiceConnection_Region),l=xC.ConnectionFactoryBase.getHostSuffix(u),h=e.parameters.getProperty(ri.PropertyId.SpeechServiceConnection_Host,`wss://${u}.spr-frontend.speech${l}`),d=e.parameters.getProperty(ri.PropertyId.SpeechServiceConnection_SpeakerIdMode,"TextIndependentIdentification");s=`${h}/speaker/ws/${this.scenarioToPath(d)}/${r}`}let o={format:"simple",language:e.parameters.getProperty(ri.PropertyId.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(e,o,s);let a={};t.token!==void 0&&t.token!==""&&(a[t.headerName]=t.token),a[NC.HeaderNames.ConnectionId]=n,a[NC.HeaderNames.SpIDAuthKey]=e.parameters.getProperty(ri.PropertyId.SpeechServiceConnection_Key),e.parameters.setProperty(ri.PropertyId.SpeechServiceConnection_Url,s);let c=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new DC.WebsocketConnection(s,o,a,new sT.WebsocketMessageFormatter,DC.ProxyInfo.fromRecognizerConfig(e),c,n)}scenarioToPath(e){switch(e){case"TextIndependentVerification":case"2":return"verification/text-independent";case"TextDependentVerification":case"1":return"verification/text-dependent";default:return"identification/text-independent"}}},tv=class extends wc{create(e,t,r){return super.create(e,t,"recognition",r)}};Ui.SpeakerRecognitionConnectionFactory=tv;var rv=class extends wc{create(e,t,r){return super.create(e,t,"profile",r)}};Ui.VoiceProfileConnectionFactory=rv});var Ac=p(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.RecognitionEndedEvent=me.RecognitionCompletionStatus=me.RecognitionStartedEvent=me.ConnectingToServiceEvent=me.ListeningStartedEvent=me.RecognitionTriggeredEvent=me.SpeechRecognitionEvent=void 0;var bc=P(),Sr=class extends bc.PlatformEvent{constructor(e,t,r,n=bc.EventType.Info){super(e,n),this.privRequestId=t,this.privSessionId=r}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}};me.SpeechRecognitionEvent=Sr;var iv=class extends Sr{constructor(e,t,r,n){super("RecognitionTriggeredEvent",e,t),this.privAudioSourceId=r,this.privAudioNodeId=n}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}};me.RecognitionTriggeredEvent=iv;var nv=class extends Sr{constructor(e,t,r,n){super("ListeningStartedEvent",e,t),this.privAudioSourceId=r,this.privAudioNodeId=n}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}};me.ListeningStartedEvent=nv;var sv=class extends Sr{constructor(e,t,r){super("ConnectingToServiceEvent",e,r),this.privAuthFetchEventid=t}get authFetchEventid(){return this.privAuthFetchEventid}};me.ConnectingToServiceEvent=sv;var ov=class extends Sr{constructor(e,t,r,n,s){super("RecognitionStartedEvent",e,s),this.privAudioSourceId=t,this.privAudioNodeId=r,this.privAuthFetchEventId=n}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}};me.RecognitionStartedEvent=ov;var jC;(function(i){i[i.Success=0]="Success",i[i.AudioSourceError=1]="AudioSourceError",i[i.AudioSourceTimeout=2]="AudioSourceTimeout",i[i.AuthTokenFetchError=3]="AuthTokenFetchError",i[i.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",i[i.UnAuthorized=5]="UnAuthorized",i[i.ConnectTimeout=6]="ConnectTimeout",i[i.ConnectError=7]="ConnectError",i[i.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",i[i.UnknownError=9]="UnknownError"})(jC=me.RecognitionCompletionStatus||(me.RecognitionCompletionStatus={}));var av=class extends Sr{constructor(e,t,r,n,s,o,a,c){super("RecognitionEndedEvent",e,s,a===jC.Success?bc.EventType.Info:bc.EventType.Error),this.privAudioSourceId=t,this.privAudioNodeId=r,this.privAuthFetchEventId=n,this.privStatus=a,this.privError=c,this.privServiceTag=o}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}get serviceTag(){return this.privServiceTag}get status(){return this.privStatus}get error(){return this.privError}};me.RecognitionEndedEvent=av});var ii=p(Tc=>{"use strict";Object.defineProperty(Tc,"__esModule",{value:!0});Tc.SpeechConnectionMessage=void 0;var cv=P(),Yt=Ie(),uv=class i extends cv.ConnectionMessage{constructor(e,t,r,n,s,o,a,c){if(!t)throw new cv.ArgumentNullError("path");if(!r)throw new cv.ArgumentNullError("requestId");let u={};if(u[Yt.HeaderNames.Path]=t,u[Yt.HeaderNames.RequestId]=r,u[Yt.HeaderNames.RequestTimestamp]=new Date().toISOString(),n&&(u[Yt.HeaderNames.ContentType]=n),o&&(u[Yt.HeaderNames.RequestStreamId]=o),a)for(let l in a)l&&(u[l]=a[l]);c?super(e,s,u,c):super(e,s,u),this.privPath=t,this.privRequestId=r,this.privContentType=n,this.privStreamId=o,this.privAdditionalHeaders=a}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(e){let t=null,r=null,n=null,s=null,o={};if(e.headers)for(let a in e.headers)a&&(a.toLowerCase()===Yt.HeaderNames.Path.toLowerCase()?t=e.headers[a]:a.toLowerCase()===Yt.HeaderNames.RequestId.toLowerCase()?r=e.headers[a]:a.toLowerCase()===Yt.HeaderNames.ContentType.toLowerCase()?n=e.headers[a]:a.toLowerCase()===Yt.HeaderNames.RequestStreamId.toLowerCase()?s=e.headers[a]:o[a]=e.headers[a]);return new i(e.messageType,t,r,n,e.body,s,o,e.id)}};Tc.SpeechConnectionMessage=uv});var zC=p(kc=>{"use strict";Object.defineProperty(kc,"__esModule",{value:!0});kc.ServiceRecognizerBase=void 0;var oT=ce(),Z=P(),B=f(),Ot=C(),Cr=ii(),Oc=class i{constructor(e,t,r,n,s){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.privAverageBytesPerMs=0,this.privEnableSpeakerId=!1,this.privExpectContentAssessmentResponse=!1,this.recognizeOverride=void 0,this.recognizeSpeaker=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!e)throw new Z.ArgumentNullError("authentication");if(!t)throw new Z.ArgumentNullError("connectionFactory");if(!r)throw new Z.ArgumentNullError("audioSource");if(!n)throw new Z.ArgumentNullError("recognizerConfig");this.privEnableSpeakerId=n.isSpeakerDiarizationEnabled,this.privMustReportEndOfStream=!1,this.privAuthentication=e,this.privConnectionFactory=t,this.privAudioSource=r,this.privRecognizerConfig=n,this.privIsDisposed=!1,this.privRecognizer=s,this.privRequestSession=new Ot.RequestSession(this.privAudioSource.id()),this.privConnectionEvents=new Z.EventSource,this.privServiceEvents=new Z.EventSource,this.privDynamicGrammar=new Ot.DynamicGrammarBuilder,this.privSpeechContext=new Ot.SpeechContext(this.privDynamicGrammar),this.privAgentConfig=new Ot.AgentConfig,this.privRecognizerConfig.parameters.getProperty(B.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?this.privSetTimeout=Z.Timeout.setTimeout:typeof window<"u"&&(this.privSetTimeout=window.setTimeout.bind(window)),this.connectionEvents.attach(a=>{if(a.name==="ConnectionClosedEvent"){let c=a;(c.statusCode===1003||c.statusCode===1007||c.statusCode===1002||c.statusCode===4e3||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(B.CancellationReason.Error,c.statusCode===1007?B.CancellationErrorCode.BadRequestParameters:B.CancellationErrorCode.ConnectionFailure,`${c.reason} websocket error code: ${c.statusCode}`)}}),this.privEnableSpeakerId&&(this.privDiarizationSessionId=Z.createNoDashGuid()),this.setLanguageIdJson(),this.setOutputDetailLevelJson()}setTranslationJson(){let e=this.privRecognizerConfig.parameters.getProperty(B.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0);if(e!==void 0){let t=e.split(","),r=this.privRecognizerConfig.parameters.getProperty(B.PropertyId.SpeechServiceConnection_TranslationVoice,void 0),n=r!==void 0?"Synthesize":"None";if(this.privSpeechContext.setSection("translation",{onSuccess:{action:n},output:{interimResults:{mode:"Always"}},targetLanguages:t}),r!==void 0){let s={};for(let o of t)s[o]=r;this.privSpeechContext.setSection("synthesis",{defaultVoices:s})}}}setSpeechSegmentationTimeoutJson(){let e=this.privRecognizerConfig.parameters.getProperty(B.PropertyId.Speech_SegmentationSilenceTimeoutMs,void 0);if(e!==void 0){let t=this.recognitionMode===Ot.RecognitionMode.Conversation?"CONVERSATION":this.recognitionMode===Ot.RecognitionMode.Dictation?"DICTATION":"INTERACTIVE",r=parseInt(e,10),n=this.privSpeechContext.getSection("phraseDetection");n.mode=t,n[t]={segmentation:{mode:"Custom",segmentationSilenceTimeoutMs:r}},this.privSpeechContext.setSection("phraseDetection",n)}}setLanguageIdJson(){let e=this.privSpeechContext.getSection("phraseDetection");if(this.privRecognizerConfig.autoDetectSourceLanguages!==void 0){let r=this.privRecognizerConfig.autoDetectSourceLanguages.split(","),n;this.privRecognizerConfig.languageIdMode==="Continuous"?n="DetectContinuous":n="DetectAtAudioStart",this.privSpeechContext.setSection("languageId",{Priority:"PrioritizeLatency",languages:r,mode:n,onSuccess:{action:"Recognize"},onUnknown:{action:"None"}}),this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"Auto"},phraseResults:{resultType:"Always"}});let s=this.privRecognizerConfig.sourceLanguageModels;s!==void 0&&(e.customModels=s,e.onInterim={action:"None"},e.onSuccess={action:"None"})}this.privRecognizerConfig.parameters.getProperty(B.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0&&(e.onInterim={action:"Translate"},e.onSuccess={action:"Translate"},this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"None"},phraseResults:{resultType:"None"}})),this.privSpeechContext.setSection("phraseDetection",e)}setOutputDetailLevelJson(){this.privEnableSpeakerId&&(this.privRecognizerConfig.parameters.getProperty(B.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true"?this.privSpeechContext.setWordLevelTimings():this.privRecognizerConfig.parameters.getProperty(Ot.OutputFormatPropertyName,B.OutputFormat[B.OutputFormat.Simple]).toLowerCase()===B.OutputFormat[B.OutputFormat.Detailed].toLocaleLowerCase()&&this.privSpeechContext.setDetailedOutputFormat())}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(e){this.privRecognizerConfig.parameters.setProperty(B.PropertyId.ConversationTranslator_Token,e)}set voiceProfileType(e){this.privRecognizerConfig.parameters.setProperty(B.PropertyId.SpeechServiceConnection_SpeakerIdMode,e)}set authentication(e){this.privAuthentication=e}isDisposed(){return this.privIsDisposed}async dispose(e){if(this.privIsDisposed=!0,this.privConnectionConfigurationPromise!==void 0)try{await(await this.privConnectionConfigurationPromise).dispose(e)}catch{return}}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}async recognize(e,t,r){if(this.recognizeOverride!==void 0){await this.recognizeOverride(e,t,r);return}this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=e,this.setSpeechSegmentationTimeoutJson(),this.setTranslationJson(),this.privSuccessCallback=t,this.privErrorCallback=r,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);let n=this.connectImpl(),s;try{let c=await this.audioSource.attach(this.privRequestSession.audioNodeId),u=await this.audioSource.format,l=await this.audioSource.deviceInfo;this.privIsLiveAudio=l.type&&l.type===Ot.type.Microphones,s=new oT.ReplayableAudioNode(c,u.avgBytesPerSec),await this.privRequestSession.onAudioSourceAttachCompleted(s,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:l}}catch(c){throw await this.privRequestSession.onStopRecognizing(),c}try{await n}catch(c){await this.cancelRecognitionLocal(B.CancellationReason.Error,B.CancellationErrorCode.ConnectionFailure,c);return}let o=new B.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,o),this.receiveMessage(),this.sendAudio(s).catch(async c=>{await this.cancelRecognitionLocal(B.CancellationReason.Error,B.CancellationErrorCode.RuntimeError,c)})}async stopRecognizing(){if(this.privRequestSession.isRecognizing)try{await this.audioSource.turnOff(),await this.sendFinalAudio(),await this.privRequestSession.onStopRecognizing(),await this.privRequestSession.turnCompletionPromise}finally{await this.privRequestSession.dispose()}}async connect(){return await this.connectImpl(),Promise.resolve()}connectAsync(e,t){this.connectImpl().then(()=>{try{e&&e()}catch(r){t&&t(r)}},r=>{try{t&&t(r)}catch{}})}async disconnect(){if(await this.cancelRecognitionLocal(B.CancellationReason.Error,B.CancellationErrorCode.NoError,"Disconnecting"),this.disconnectOverride!==void 0&&await this.disconnectOverride(),this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose()}catch{}this.privConnectionPromise=void 0}sendMessage(e){}async sendNetworkMessage(e,t){let r=typeof t=="string"?Z.MessageType.Text:Z.MessageType.Binary,n=typeof t=="string"?"application/json":"";return(await this.fetchConnection()).send(new Cr.SpeechConnectionMessage(r,e,this.privRequestSession.requestId,n,t))}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}set expectContentAssessmentResponse(e){this.privExpectContentAssessmentResponse=e}async sendTelemetryData(){let e=this.privRequestSession.getTelemetry();if(i.telemetryDataEnabled!==!0||this.privIsDisposed||e===null)return;if(i.telemetryData)try{i.telemetryData(e)}catch{}await(await this.fetchConnection()).send(new Cr.SpeechConnectionMessage(Z.MessageType.Text,"telemetry",this.privRequestSession.requestId,"application/json",e))}async cancelRecognitionLocal(e,t,r){this.privRequestSession.isRecognizing&&(await this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,e,t,r))}async receiveMessage(){try{if(this.privIsDisposed)return;let e=await this.fetchConnection(),t=await e.read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(!t)return this.receiveMessage();this.privServiceHasSentMessage=!0;let r=Cr.SpeechConnectionMessage.fromConnectionMessage(t);if(r.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(r.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":let n=Ot.SpeechDetected.fromJSON(r.textBody),s=new B.RecognitionEventArgs(n.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,s);break;case"speech.enddetected":let o;r.textBody.length>0?o=r.textBody:o="{ Offset: 0 }";let a=Ot.SpeechDetected.fromJSON(o),c=new B.RecognitionEventArgs(a.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,c);break;case"turn.end":await this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,await this.cancelRecognitionLocal(B.CancellationReason.EndOfStream,B.CancellationErrorCode.NoError,void 0));let u=new B.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing){this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,u);return}else e=await this.fetchConnection(),await this.sendPrePayloadJSON(e);break;default:await this.processTypeSpecificMessages(r)||this.privServiceEvents&&this.serviceEvents.onEvent(new Z.ServiceEvent(r.path.toLowerCase(),r.textBody))}return this.receiveMessage()}catch{return null}}updateSpeakerDiarizationAudioOffset(){let t=this.privRequestSession.recognitionBytesSent/this.privAverageBytesPerMs;this.privSpeechContext.setSpeakerDiarizationAudioOffsetMs(t)}sendSpeechContext(e,t){this.privEnableSpeakerId&&this.updateSpeakerDiarizationAudioOffset();let r=this.speechContext.toJSON();if(t&&this.privRequestSession.onSpeechContext(),r)return e.send(new Cr.SpeechConnectionMessage(Z.MessageType.Text,"speech.context",this.privRequestSession.requestId,"application/json",r))}noOp(){}async sendPrePayloadJSON(e,t=!0){if(this.sendPrePayloadJSONOverride!==void 0)return this.sendPrePayloadJSONOverride(e);await this.sendSpeechContext(e,t),await this.sendWaveHeader(e)}async sendWaveHeader(e){let t=await this.audioSource.format;return e.send(new Cr.SpeechConnectionMessage(Z.MessageType.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",t.header))}connectImpl(){return this.privConnectionPromise!==void 0?this.privConnectionPromise.then(e=>e.state()===Z.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl())):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch(()=>{}),this.postConnectImplOverride!==void 0?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(e,t,r){if(t.onSpeechContext(),i.telemetryDataEnabled!==!0){let s={context:{system:JSON.parse(r).context.system}};r=JSON.stringify(s)}if(this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()==="true"){let n=JSON.parse(r);n.context.DisableReferenceChannel="True",n.context.MicSpec="1_0_0",r=JSON.stringify(n)}if(r)return e.send(new Cr.SpeechConnectionMessage(Z.MessageType.Text,"speech.config",t.requestId,"application/json",r))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(e=>e.state()===Z.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async sendAudio(e){let t=await this.audioSource.format;this.privAverageBytesPerMs=t.avgBytesPerSec/1e3;let r=Date.now(),n=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),s=t.avgBytesPerSec/1e3*parseInt(n,10),o=this.privRequestSession.recogNumber,a=async()=>{if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===o){let c=await this.fetchConnection(),u=await e.read();if(this.privRequestSession.isSpeechEnded)return;let l,h;if(!u||u.isEnd?(l=null,h=0):(l=u.buffer,this.privRequestSession.onAudioSent(l.byteLength),s>=this.privRequestSession.bytesSent?h=0:h=Math.max(0,r-Date.now())),h!==0&&await this.delay(h),l!==null&&(r=Date.now()+l.byteLength*1e3/(t.avgBytesPerSec*2)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===o)if(c.send(new Cr.SpeechConnectionMessage(Z.MessageType.Binary,"audio",this.privRequestSession.requestId,null,l)).catch(()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch(()=>{})}),u?.isEnd)this.privIsLiveAudio||this.privRequestSession.onSpeechEnded();else return a()}};return a()}async retryableConnect(){let e=!1;this.privAuthFetchEventId=Z.createNoDashGuid();let t=this.privRequestSession.sessionId;this.privConnectionId=t!==void 0?t:Z.createNoDashGuid(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let r=0,n="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){let o=await(e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId));await this.privRequestSession.onAuthCompleted(!1);let a=this.privConnectionFactory.create(this.privRecognizerConfig,o,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(a.events),a.events.attach(u=>{this.connectionEvents.onEvent(u)});let c=await a.open();if(c.statusCode===200)return await this.privRequestSession.onConnectionEstablishCompleted(c.statusCode),Promise.resolve(a);c.statusCode===1006&&(e=!0),r=c.statusCode,n=c.reason,this.privRequestSession.onRetryConnection()}return await this.privRequestSession.onConnectionEstablishCompleted(r,n),Promise.reject(`Unable to contact server. StatusCode: ${r}, ${this.privRecognizerConfig.parameters.getProperty(B.PropertyId.SpeechServiceConnection_Endpoint)} Reason: ${n}`)}delay(e){return new Promise(t=>this.privSetTimeout(t,e))}writeBufferToConsole(e){let t="Buffer Size: ";if(e===null)t+="null";else{let r=new Uint8Array(e);t+=`${e.byteLength}\r
`;for(let n=0;n<e.byteLength;n++)t+=r[n].toString(16).padStart(2,"0")+" ",(n+1)%16===0&&(console.info(t),t="")}console.info(t)}async sendFinalAudio(){await(await this.fetchConnection()).send(new Cr.SpeechConnectionMessage(Z.MessageType.Binary,"audio",this.privRequestSession.requestId,null,null))}async configureConnection(){let e=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(e):(await this.sendSpeechServiceConfig(e,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendPrePayloadJSON(e,!1),e)}};kc.ServiceRecognizerBase=Oc;Oc.telemetryDataEnabled=!0});var LC=p(Mc=>{"use strict";Object.defineProperty(Mc,"__esModule",{value:!0});Mc.ConversationServiceRecognizer=void 0;var tt=f(),kt=C(),pv=class extends kt.ServiceRecognizerBase{constructor(e,t,r,n,s){super(e,t,r,n,s),this.handleSpeechPhraseMessage=async o=>this.handleSpeechPhrase(o),this.handleSpeechHypothesisMessage=o=>this.handleSpeechHypothesis(o)}processTypeSpecificMessages(e){}handleRecognizedCallback(e,t,r){}handleRecognizingCallback(e,t,r){}async processSpeechMessages(e){let t=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":this.handleSpeechHypothesisMessage&&this.handleSpeechHypothesisMessage(e.textBody),t=!0;break;case"speech.phrase":this.handleSpeechPhraseMessage&&await this.handleSpeechPhraseMessage(e.textBody),t=!0;break;default:break}return t}cancelRecognition(e,t,r,n,s){}async handleSpeechPhrase(e){let t=kt.SimpleSpeechPhrase.fromJSON(e),r=kt.EnumTranslation.implTranslateRecognitionResult(t.RecognitionStatus),n,s=new tt.PropertyCollection;s.setProperty(tt.PropertyId.SpeechServiceResponse_JsonResult,e);let o=t.Offset+this.privRequestSession.currentTurnAudioOffset,a=o;if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+t.Offset+t.Duration),tt.ResultReason.Canceled===r){let c=kt.EnumTranslation.implTranslateCancelResult(t.RecognitionStatus),u=kt.EnumTranslation.implTranslateCancelErrorCode(t.RecognitionStatus);await this.cancelRecognitionLocal(c,u,kt.EnumTranslation.implTranslateErrorDetails(u))}else if(!(this.privRequestSession.isSpeechEnded&&r===tt.ResultReason.NoMatch&&t.RecognitionStatus!==kt.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(kt.OutputFormatPropertyName)===tt.OutputFormat[tt.OutputFormat.Simple])n=new tt.SpeechRecognitionResult(this.privRequestSession.requestId,r,t.DisplayText,t.Duration,o,t.Language,t.LanguageDetectionConfidence,t.SpeakerId,void 0,e,s);else{let c=kt.DetailedSpeechPhrase.fromJSON(e),u=c.Offset+this.privRequestSession.currentTurnAudioOffset,l=c.getJsonWithCorrectedOffsets(u);n=new tt.SpeechRecognitionResult(this.privRequestSession.requestId,r,c.Text,c.Duration,u,c.Language,c.LanguageDetectionConfidence,c.SpeakerId,void 0,l,s),a=n.offset}this.handleRecognizedCallback(n,a,this.privRequestSession.sessionId)}}handleSpeechHypothesis(e){let t=kt.SpeechHypothesis.fromJSON(e),r=t.Offset+this.privRequestSession.currentTurnAudioOffset,n=new tt.PropertyCollection;n.setProperty(tt.PropertyId.SpeechServiceResponse_JsonResult,e);let s=new tt.SpeechRecognitionResult(this.privRequestSession.requestId,tt.ResultReason.RecognizingSpeech,t.Text,t.Duration,r,t.Language,t.LanguageDetectionConfidence,t.SpeakerId,void 0,e,n);this.privRequestSession.onHypothesis(r),this.handleRecognizingCallback(s,t.Duration,this.privRequestSession.sessionId)}};Mc.ConversationServiceRecognizer=pv});var FC=p(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.RecognizerConfig=Mt.SpeechResultFormat=Mt.RecognitionMode=void 0;var Dc=f(),BC=C(),xc;(function(i){i[i.Interactive=0]="Interactive",i[i.Conversation=1]="Conversation",i[i.Dictation=2]="Dictation"})(xc=Mt.RecognitionMode||(Mt.RecognitionMode={}));var aT;(function(i){i[i.Simple=0]="Simple",i[i.Detailed=1]="Detailed"})(aT=Mt.SpeechResultFormat||(Mt.SpeechResultFormat={}));var lv=class{constructor(e,t){this.privSpeechServiceConfig=e||new BC.SpeechServiceConfig(new BC.Context(null)),this.privParameters=t,this.privMaxRetryCount=parseInt(t.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=t.getProperty(Dc.PropertyId.SpeechServiceConnection_LanguageIdMode,void 0),this.privEnableSpeakerId=!1}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(e){this.privRecognitionMode=e,this.privRecognitionActivityTimeout=e===xc.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=xc[e]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==xc.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(Dc.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(Dc.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,void 0)}get sourceLanguageModels(){let e=[],t=!1;if(this.autoDetectSourceLanguages!==void 0)for(let r of this.autoDetectSourceLanguages.split(",")){let n=r+Dc.PropertyId.SpeechServiceConnection_EndpointId.toString(),s=this.parameters.getProperty(n,void 0);s!==void 0?(e.push({language:r,endpoint:s}),t=!0):e.push({language:r,endpoint:""})}return t?e:void 0}get maxRetryCount(){return this.privMaxRetryCount}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}set isSpeakerDiarizationEnabled(e){this.privEnableSpeakerId=e}};Mt.RecognizerConfig=lv});var UC=p(VC=>{"use strict";Object.defineProperty(VC,"__esModule",{value:!0})});var HC=p(Nc=>{"use strict";Object.defineProperty(Nc,"__esModule",{value:!0});Nc.WebsocketMessageFormatter=void 0;var rt=P(),WC=`\r
`,hv=class{toConnectionMessage(e){let t=new rt.Deferred;try{if(e.messageType===rt.MessageType.Text){let r=e.textContent,n={},s=null;if(r){let o=r.split(`\r
\r
`);o&&o.length>0&&(n=this.parseHeaders(o[0]),o.length>1&&(s=o[1]))}t.resolve(new rt.ConnectionMessage(e.messageType,s,n,e.id))}else if(e.messageType===rt.MessageType.Binary){let r=e.binaryContent,n={},s=null;if(!r||r.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");let o=new DataView(r),a=o.getInt16(0);if(r.byteLength<a+2)throw new Error("Invalid binary message format. Header content missing.");let c="";for(let u=0;u<a;u++)c+=String.fromCharCode(o.getInt8(u+2));n=this.parseHeaders(c),r.byteLength>a+2&&(s=r.slice(2+a)),t.resolve(new rt.ConnectionMessage(e.messageType,s,n,e.id))}}catch(r){t.reject(`Error formatting the message. Error: ${r}`)}return t.promise}fromConnectionMessage(e){let t=new rt.Deferred;try{if(e.messageType===rt.MessageType.Text){let r=`${this.makeHeaders(e)}${WC}${e.textBody?e.textBody:""}`;t.resolve(new rt.RawWebsocketMessage(rt.MessageType.Text,r,e.id))}else if(e.messageType===rt.MessageType.Binary){let r=this.makeHeaders(e),n=e.binaryBody,s=this.stringToArrayBuffer(r),o=new Int8Array(s),a=o.byteLength,c=new Int8Array(2+a+(n?n.byteLength:0));if(c[0]=a>>8&255,c[1]=a&255,c.set(o,2),n){let l=new Int8Array(n);c.set(l,2+a)}let u=c.buffer;t.resolve(new rt.RawWebsocketMessage(rt.MessageType.Binary,u,e.id))}}catch(r){t.reject(`Error formatting the message. ${r}`)}return t.promise}makeHeaders(e){let t="";if(e.headers)for(let r in e.headers)r&&(t+=`${r}: ${e.headers[r]}${WC}`);return t}parseHeaders(e){let t={};if(e){let r=e.match(/[^\r\n]+/g);if(t){for(let n of r)if(n){let s=n.indexOf(":"),o=s>0?n.substr(0,s).trim().toLowerCase():n,a=s>0&&n.length>s+1?n.substr(s+1).trim():"";t[o]=a}}}return t}stringToArrayBuffer(e){let t=new ArrayBuffer(e.length),r=new DataView(t);for(let n=0;n<e.length;n++)r.setUint8(n,e.charCodeAt(n));return t}};Nc.WebsocketMessageFormatter=hv});var $C=p(qc=>{"use strict";Object.defineProperty(qc,"__esModule",{value:!0});qc.SpeechConnectionFactory=void 0;var KC=ce(),JC=C(),Pr=f(),GC=Ze(),dv=C(),cT=Ie(),ni=$t(),vv=class extends GC.ConnectionFactoryBase{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/speech/universal/v"}create(e,t,r){let n=e.parameters.getProperty(Pr.PropertyId.SpeechServiceConnection_Endpoint,void 0),s=e.parameters.getProperty(Pr.PropertyId.SpeechServiceConnection_Region,void 0),o=GC.ConnectionFactoryBase.getHostSuffix(s),a=e.parameters.getProperty(Pr.PropertyId.SpeechServiceConnection_Host,"wss://"+s+".stt.speech"+o),c={},u=e.parameters.getProperty(Pr.PropertyId.SpeechServiceConnection_EndpointId,void 0),l=e.parameters.getProperty(Pr.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(u?(!n||n.search(ni.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(c[ni.QueryParameterNames.CustomSpeechDeploymentId]=u):l&&(!n||n.search(ni.QueryParameterNames.Language)===-1)&&(c[ni.QueryParameterNames.Language]=l),(!n||n.search(ni.QueryParameterNames.Format)===-1)&&(c[ni.QueryParameterNames.Format]=e.parameters.getProperty(JC.OutputFormatPropertyName,Pr.OutputFormat[Pr.OutputFormat.Simple]).toLowerCase()),e.autoDetectSourceLanguages!==void 0&&(c[ni.QueryParameterNames.EnableLanguageId]="true"),this.setCommonUrlParams(e,c,n),!n)switch(e.recognitionMode){case dv.RecognitionMode.Conversation:e.parameters.getProperty(JC.ForceDictationPropertyName,"false")==="true"?n=a+this.dictationRelativeUri:e.recognitionEndpointVersion!==void 0&&parseInt(e.recognitionEndpointVersion,10)>1?n=`${a}${this.universalUri}${e.recognitionEndpointVersion}`:n=a+this.conversationRelativeUri;break;case dv.RecognitionMode.Dictation:n=a+this.dictationRelativeUri;break;default:e.recognitionEndpointVersion!==void 0&&parseInt(e.recognitionEndpointVersion,10)>1?n=`${a}${this.universalUri}${e.recognitionEndpointVersion}`:n=a+this.interactiveRelativeUri;break}let h={};t.token!==void 0&&t.token!==""&&(h[t.headerName]=t.token),h[cT.HeaderNames.ConnectionId]=r;let d=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",g=new KC.WebsocketConnection(n,c,h,new dv.WebsocketMessageFormatter,KC.ProxyInfo.fromRecognizerConfig(e),d,r),M=g.uri;return e.parameters.setProperty(Pr.PropertyId.SpeechServiceConnection_Url,M),g}};qc.SpeechConnectionFactory=vv});var ZC=p(jc=>{"use strict";Object.defineProperty(jc,"__esModule",{value:!0});jc.ConversationTranscriberConnectionFactory=void 0;var QC=ce(),We=f(),uT=C(),XC=Ze(),pT=C(),lT=Ie(),it=$t(),fv=class extends XC.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/speech/universal/v2"}create(e,t,r){let n=e.parameters.getProperty(We.PropertyId.SpeechServiceConnection_Endpoint,void 0),s=e.parameters.getProperty(We.PropertyId.SpeechServiceConnection_Region,void 0),o=XC.ConnectionFactoryBase.getHostSuffix(s),a=e.parameters.getProperty(We.PropertyId.SpeechServiceConnection_Host,"wss://"+s+".stt.speech"+o),c={},u=e.parameters.getProperty(We.PropertyId.SpeechServiceConnection_EndpointId,void 0),l=e.parameters.getProperty(We.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);u?(!n||n.search(it.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(c[it.QueryParameterNames.CustomSpeechDeploymentId]=u):l&&(!n||n.search(it.QueryParameterNames.Language)===-1)&&(c[it.QueryParameterNames.Language]=l),e.autoDetectSourceLanguages!==void 0&&(c[it.QueryParameterNames.EnableLanguageId]="true"),this.setV2UrlParams(e,c,n),n||(n=`${a}${this.universalUri}`);let h={};t.token!==void 0&&t.token!==""&&(h[t.headerName]=t.token),h[lT.HeaderNames.ConnectionId]=r;let d=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",g=new QC.WebsocketConnection(n,c,h,new pT.WebsocketMessageFormatter,QC.ProxyInfo.fromRecognizerConfig(e),d,r),M=g.uri;return e.parameters.setProperty(We.PropertyId.SpeechServiceConnection_Url,M),g}setV2UrlParams(e,t,r){new Map([[We.PropertyId.Speech_SegmentationSilenceTimeoutMs,it.QueryParameterNames.SegmentationSilenceTimeoutMs],[We.PropertyId.SpeechServiceConnection_EnableAudioLogging,it.QueryParameterNames.EnableAudioLogging],[We.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,it.QueryParameterNames.EndSilenceTimeoutMs],[We.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,it.QueryParameterNames.InitialSilenceTimeoutMs],[We.PropertyId.SpeechServiceResponse_PostProcessingOption,it.QueryParameterNames.Postprocessing],[We.PropertyId.SpeechServiceResponse_ProfanityOption,it.QueryParameterNames.Profanity],[We.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,it.QueryParameterNames.StableIntermediateThreshold]]).forEach((o,a)=>{this.setUrlParameter(a,o,e,t,r)});let s=JSON.parse(e.parameters.getProperty(uT.ServicePropertiesPropertyName,"{}"));Object.keys(s).forEach(o=>{t[o]=s[o]})}};jc.ConversationTranscriberConnectionFactory=fv});var rP=p(zc=>{"use strict";Object.defineProperty(zc,"__esModule",{value:!0});zc.TranscriberConnectionFactory=void 0;var YC=ce(),He=f(),eP=Ze(),tP=C(),hT=Ie(),os=$t(),gv=class extends eP.ConnectionFactoryBase{constructor(){super(...arguments),this.multiaudioRelativeUri="/speech/recognition/multiaudio"}create(e,t,r){let n=e.parameters.getProperty(He.PropertyId.SpeechServiceConnection_Endpoint,void 0),s=e.parameters.getProperty(He.PropertyId.SpeechServiceConnection_Region,"centralus"),o=eP.ConnectionFactoryBase.getHostSuffix(s),a="wss://transcribe."+s+".cts.speech"+o+this.multiaudioRelativeUri,c=e.parameters.getProperty(He.PropertyId.SpeechServiceConnection_Host,a),u={};this.setQueryParams(u,e,n),n||(n=c);let l={};t.token!==void 0&&t.token!==""&&(l[t.headerName]=t.token),l[hT.HeaderNames.ConnectionId]=r,e.parameters.setProperty(He.PropertyId.SpeechServiceConnection_Url,n);let h=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new YC.WebsocketConnection(n,u,l,new tP.WebsocketMessageFormatter,YC.ProxyInfo.fromRecognizerConfig(e),h,r)}setQueryParams(e,t,r){let n=t.parameters.getProperty(He.PropertyId.SpeechServiceConnection_EndpointId,void 0),s=t.parameters.getProperty(He.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);n&&!(os.QueryParameterNames.CustomSpeechDeploymentId in e)&&(e[os.QueryParameterNames.CustomSpeechDeploymentId]=n),s&&!(os.QueryParameterNames.Language in e)&&(e[os.QueryParameterNames.Language]=s);let o=t.parameters.getProperty(He.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true",a=t.parameters.getProperty(tP.OutputFormatPropertyName,He.OutputFormat[He.OutputFormat.Simple])!==He.OutputFormat[He.OutputFormat.Simple];(o||a)&&(e[os.QueryParameterNames.Format]=He.OutputFormat[He.OutputFormat.Detailed].toLowerCase()),this.setCommonUrlParams(t,e,r)}};zc.TranscriberConnectionFactory=gv});var oP=p(Lc=>{"use strict";Object.defineProperty(Lc,"__esModule",{value:!0});Lc.TranslationConnectionFactory=void 0;var iP=ce(),dT=sd(),er=f(),nP=Ze(),mv=C(),vT=Ie(),sP=$t(),yv=class extends nP.ConnectionFactoryBase{create(e,t,r){let n=this.getEndpointUrl(e),s={};e.autoDetectSourceLanguages!==void 0&&(s[sP.QueryParameterNames.EnableLanguageId]="true"),this.setQueryParams(s,e,n);let o={};t.token!==void 0&&t.token!==""&&(o[t.headerName]=t.token),o[vT.HeaderNames.ConnectionId]=r,e.parameters.setProperty(er.PropertyId.SpeechServiceConnection_Url,n);let a=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new iP.WebsocketConnection(n,s,o,new mv.WebsocketMessageFormatter,iP.ProxyInfo.fromRecognizerConfig(e),a,r)}getEndpointUrl(e,t){let r=e.parameters.getProperty(er.PropertyId.SpeechServiceConnection_Region),n=nP.ConnectionFactoryBase.getHostSuffix(r),s=e.parameters.getProperty(er.PropertyId.SpeechServiceConnection_Endpoint,void 0);return s||(e.autoDetectSourceLanguages!==void 0?s=e.parameters.getProperty(er.PropertyId.SpeechServiceConnection_Host,"wss://{region}.stt.speech"+n)+"/speech/universal/v2":s=e.parameters.getProperty(er.PropertyId.SpeechServiceConnection_Host,"wss://{region}.s2s.speech"+n)+"/speech/translation/cognitiveservices/v1"),t===!0?s:dT.StringUtils.formatString(s,{region:r})}setQueryParams(e,t,r){e.from=t.parameters.getProperty(er.PropertyId.SpeechServiceConnection_RecoLanguage),e.to=t.parameters.getProperty(er.PropertyId.SpeechServiceConnection_TranslationToLanguages),e.scenario=t.recognitionMode===mv.RecognitionMode.Interactive?"interactive":t.recognitionMode===mv.RecognitionMode.Conversation?"conversation":"",this.setCommonUrlParams(t,e,r),this.setUrlParameter(er.PropertyId.SpeechServiceResponse_TranslationRequestStablePartialResult,sP.QueryParameterNames.StableTranslation,t,e,r);let n=t.parameters.getProperty(er.PropertyId.SpeechServiceConnection_TranslationVoice,void 0);n!==void 0&&(e.voice=n,e.features="texttospeech")}};Lc.TranslationConnectionFactory=yv});var aP=p(Bc=>{"use strict";Object.defineProperty(Bc,"__esModule",{value:!0});Bc.EnumTranslation=void 0;var ue=f(),ie=C(),Sv=class{static implTranslateRecognitionResult(e,t=!1){let r=ue.ResultReason.Canceled;switch(e){case ie.RecognitionStatus.Success:r=ue.ResultReason.RecognizedSpeech;break;case ie.RecognitionStatus.EndOfDictation:r=t?ue.ResultReason.RecognizedSpeech:ue.ResultReason.NoMatch;break;case ie.RecognitionStatus.NoMatch:case ie.RecognitionStatus.InitialSilenceTimeout:case ie.RecognitionStatus.BabbleTimeout:r=ue.ResultReason.NoMatch;break;case ie.RecognitionStatus.Error:case ie.RecognitionStatus.BadRequest:case ie.RecognitionStatus.Forbidden:default:r=ue.ResultReason.Canceled;break}return r}static implTranslateCancelResult(e){let t=ue.CancellationReason.EndOfStream;switch(e){case ie.RecognitionStatus.Success:case ie.RecognitionStatus.EndOfDictation:case ie.RecognitionStatus.NoMatch:t=ue.CancellationReason.EndOfStream;break;case ie.RecognitionStatus.InitialSilenceTimeout:case ie.RecognitionStatus.BabbleTimeout:case ie.RecognitionStatus.Error:case ie.RecognitionStatus.BadRequest:case ie.RecognitionStatus.Forbidden:default:t=ue.CancellationReason.Error;break}return t}static implTranslateCancelErrorCode(e){let t=ue.CancellationErrorCode.NoError;switch(e){case ie.RecognitionStatus.Error:t=ue.CancellationErrorCode.ServiceError;break;case ie.RecognitionStatus.TooManyRequests:t=ue.CancellationErrorCode.TooManyRequests;break;case ie.RecognitionStatus.BadRequest:t=ue.CancellationErrorCode.BadRequestParameters;break;case ie.RecognitionStatus.Forbidden:t=ue.CancellationErrorCode.Forbidden;break;default:t=ue.CancellationErrorCode.NoError;break}return t}static implTranslateErrorDetails(e){let t="The speech service encountered an internal error and could not continue.";switch(e){case ue.CancellationErrorCode.Forbidden:t="The recognizer is using a free subscription that ran out of quota.";break;case ue.CancellationErrorCode.BadRequestParameters:t="Invalid parameter or unsupported audio format in the request.";break;case ue.CancellationErrorCode.TooManyRequests:t="The number of parallel requests exceeded the number of allowed concurrent transcriptions.";break;default:break}return t}};Bc.EnumTranslation=Sv});var cP=p(Rr=>{"use strict";Object.defineProperty(Rr,"__esModule",{value:!0});Rr.RecognitionStatus=Rr.SynthesisStatus=void 0;var fT;(function(i){i[i.Success=0]="Success",i[i.SynthesisEnd=1]="SynthesisEnd",i[i.Error=2]="Error"})(fT=Rr.SynthesisStatus||(Rr.SynthesisStatus={}));var gT;(function(i){i[i.Success=0]="Success",i[i.NoMatch=1]="NoMatch",i[i.InitialSilenceTimeout=2]="InitialSilenceTimeout",i[i.BabbleTimeout=3]="BabbleTimeout",i[i.Error=4]="Error",i[i.EndOfDictation=5]="EndOfDictation",i[i.TooManyRequests=6]="TooManyRequests",i[i.BadRequest=7]="BadRequest",i[i.Forbidden=8]="Forbidden"})(gT=Rr.RecognitionStatus||(Rr.RecognitionStatus={}))});var pP=p(Fc=>{"use strict";Object.defineProperty(Fc,"__esModule",{value:!0});Fc.TranslationSynthesisEnd=void 0;var uP=C(),Cv=class i{constructor(e){this.privSynthesisEnd=JSON.parse(e),this.privSynthesisEnd.SynthesisStatus&&(this.privSynthesisEnd.SynthesisStatus=uP.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus]),this.privSynthesisEnd.Status&&(this.privSynthesisEnd.SynthesisStatus=uP.SynthesisStatus[this.privSynthesisEnd.Status])}static fromJSON(e){return new i(e)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}};Fc.TranslationSynthesisEnd=Cv});var lP=p(Vc=>{"use strict";Object.defineProperty(Vc,"__esModule",{value:!0});Vc.TranslationHypothesis=void 0;var mT=_(),yT=Hs(),Pv=class i{constructor(e){this.privTranslationHypothesis=e,this.privTranslationHypothesis.Translation.TranslationStatus=yT.TranslationStatus[this.privTranslationHypothesis.Translation.TranslationStatus]}static fromJSON(e){return new i(JSON.parse(e))}static fromTranslationResponse(e){mT.Contracts.throwIfNullOrUndefined(e,"translationHypothesis");let t=e.SpeechHypothesis;return e.SpeechHypothesis=void 0,t.Translation=e,new i(t)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}get Language(){return this.privTranslationHypothesis.PrimaryLanguage?.Language}};Vc.TranslationHypothesis=Pv});var hP=p(Uc=>{"use strict";Object.defineProperty(Uc,"__esModule",{value:!0});Uc.TranslationPhrase=void 0;var ST=_(),CT=C(),PT=Hs(),Rv=class i{constructor(e){this.privTranslationPhrase=e,this.privTranslationPhrase.RecognitionStatus=CT.RecognitionStatus[this.privTranslationPhrase.RecognitionStatus],this.privTranslationPhrase.Translation!==void 0&&(this.privTranslationPhrase.Translation.TranslationStatus=PT.TranslationStatus[this.privTranslationPhrase.Translation.TranslationStatus])}static fromJSON(e){return new i(JSON.parse(e))}static fromTranslationResponse(e){ST.Contracts.throwIfNullOrUndefined(e,"translationResponse");let t=e.SpeechPhrase;return e.SpeechPhrase=void 0,t.Translation=e,t.Text=t.DisplayText,new i(t)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Language(){return this.privTranslationPhrase.PrimaryLanguage?.Language}get Confidence(){return this.privTranslationPhrase.PrimaryLanguage?.Confidence}get Translation(){return this.privTranslationPhrase.Translation}};Uc.TranslationPhrase=Rv});var vP=p(Wc=>{"use strict";Object.defineProperty(Wc,"__esModule",{value:!0});Wc.TranslationServiceRecognizer=void 0;var dP=P(),j=f(),be=C(),Ev=class extends be.ConversationServiceRecognizer{constructor(e,t,r,n,s){super(e,t,r,n,s),this.privTranslationRecognizer=s,this.connectionEvents.attach(o=>{o.name==="ConnectionEstablishedEvent"&&this.privTranslationRecognizer.onConnection()})}async processTypeSpecificMessages(e){let t=new j.PropertyCollection,r=await this.processSpeechMessages(e);if(r)return!0;let n=async o=>{if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+o.Offset+o.Duration),o.RecognitionStatus===be.RecognitionStatus.Success){let a=this.fireEventForResult(o,t);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,a)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(a.result)}catch(c){this.privErrorCallback&&this.privErrorCallback(c)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}else{let a=be.EnumTranslation.implTranslateRecognitionResult(o.RecognitionStatus),c=new j.TranslationRecognitionResult(void 0,this.privRequestSession.requestId,a,o.Text,o.Duration,this.privRequestSession.currentTurnAudioOffset+o.Offset,o.Language,o.Confidence,void 0,e.textBody,t);if(a===j.ResultReason.Canceled){let u=be.EnumTranslation.implTranslateCancelResult(o.RecognitionStatus),l=be.EnumTranslation.implTranslateCancelErrorCode(o.RecognitionStatus);await this.cancelRecognitionLocal(u,l,be.EnumTranslation.implTranslateErrorDetails(l))}else{if(!(this.privRequestSession.isSpeechEnded&&a===j.ResultReason.NoMatch&&o.RecognitionStatus!==be.RecognitionStatus.InitialSilenceTimeout)){let u=new j.TranslationRecognitionEventArgs(c,c.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,u)}catch{}}if(this.privSuccessCallback){try{this.privSuccessCallback(c)}catch(u){this.privErrorCallback&&this.privErrorCallback(u)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}r=!0}},s=(o,a)=>{let c=this.fireEventForResult(o,a);if(this.privRequestSession.onHypothesis(this.privRequestSession.currentTurnAudioOffset+c.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,c)}catch{}r=!0};switch(e.messageType===dP.MessageType.Text&&t.setProperty(j.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"translation.hypothesis":s(be.TranslationHypothesis.fromJSON(e.textBody),t);break;case"translation.response":let o=JSON.parse(e.textBody);if(o.SpeechPhrase)await n(be.TranslationPhrase.fromTranslationResponse(o));else{let c=JSON.parse(e.textBody);c.SpeechHypothesis&&s(be.TranslationHypothesis.fromTranslationResponse(c),t)}break;case"translation.phrase":await n(be.TranslationPhrase.fromJSON(e.textBody));break;case"translation.synthesis":this.sendSynthesisAudio(e.binaryBody,this.privRequestSession.sessionId),r=!0;break;case"audio.end":case"translation.synthesis.end":let a=be.TranslationSynthesisEnd.fromJSON(e.textBody);switch(a.SynthesisStatus){case be.SynthesisStatus.Error:if(this.privTranslationRecognizer.synthesizing){let c=new j.TranslationSynthesisResult(j.ResultReason.Canceled,void 0),u=new j.TranslationSynthesisEventArgs(c,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,u)}catch{}}if(this.privTranslationRecognizer.canceled){let c=new j.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId,j.CancellationReason.Error,a.FailureReason,j.CancellationErrorCode.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,c)}catch{}}break;case be.SynthesisStatus.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId);break;default:break}r=!0;break;default:break}return r}cancelRecognition(e,t,r,n,s){let o=new j.PropertyCollection;if(o.setProperty(be.CancellationErrorCodePropertyName,j.CancellationErrorCode[n]),this.privTranslationRecognizer.canceled){let a=new j.TranslationRecognitionCanceledEventArgs(e,r,s,n,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,a)}catch{}}if(this.privSuccessCallback){let a=new j.TranslationRecognitionResult(void 0,t,j.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,s,void 0,o);try{this.privSuccessCallback(a),this.privSuccessCallback=void 0}catch{}}}handleRecognizingCallback(e,t,r){try{let n=new j.TranslationRecognitionEventArgs(j.TranslationRecognitionResult.fromSpeechRecognitionResult(e),t,r);this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,n)}catch{}}handleRecognizedCallback(e,t,r){try{let n=new j.TranslationRecognitionEventArgs(j.TranslationRecognitionResult.fromSpeechRecognitionResult(e),t,r);this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,n)}catch{}}fireEventForResult(e,t){let r;if(e.Translation.Translations!==void 0){r=new j.Translations;for(let l of e.Translation.Translations)r.set(l.Language,l.Text||l.DisplayText)}let n,s;e instanceof be.TranslationPhrase?(e.Translation&&e.Translation.TranslationStatus===dP.TranslationStatus.Success?n=j.ResultReason.TranslatedSpeech:n=j.ResultReason.RecognizedSpeech,s=e.Confidence):n=j.ResultReason.TranslatingSpeech;let o=e.Language,a=e.Offset+this.privRequestSession.currentTurnAudioOffset,c=new j.TranslationRecognitionResult(r,this.privRequestSession.requestId,n,e.Text,e.Duration,a,o,s,e.Translation.FailureReason,JSON.stringify(e),t);return new j.TranslationRecognitionEventArgs(c,a,this.privRequestSession.sessionId)}sendSynthesisAudio(e,t){let r=e===void 0?j.ResultReason.SynthesizingAudioCompleted:j.ResultReason.SynthesizingAudio,n=new j.TranslationSynthesisResult(r,e),s=new j.TranslationSynthesisEventArgs(n,t);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,s)}catch{}}};Wc.TranslationServiceRecognizer=Ev});var fP=p(Hc=>{"use strict";Object.defineProperty(Hc,"__esModule",{value:!0});Hc.SpeechDetected=void 0;var _v=class i{constructor(e){this.privSpeechStartDetected=JSON.parse(e)}static fromJSON(e){return new i(e)}get Offset(){return this.privSpeechStartDetected.Offset}};Hc.SpeechDetected=_v});var gP=p(Kc=>{"use strict";Object.defineProperty(Kc,"__esModule",{value:!0});Kc.SpeechHypothesis=void 0;var Iv=class i{constructor(e){this.privSpeechHypothesis=JSON.parse(e)}static fromJSON(e){return new i(e)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}};Kc.SpeechHypothesis=Iv});var mP=p(Jc=>{"use strict";Object.defineProperty(Jc,"__esModule",{value:!0});Jc.SpeechKeyword=void 0;var wv=class i{constructor(e){this.privSpeechKeyword=JSON.parse(e)}static fromJSON(e){return new i(e)}get Status(){return this.privSpeechKeyword.Status}get Text(){return this.privSpeechKeyword.Text}get Offset(){return this.privSpeechKeyword.Offset}get Duration(){return this.privSpeechKeyword.Duration}};Jc.SpeechKeyword=wv});var yP=p(Gc=>{"use strict";Object.defineProperty(Gc,"__esModule",{value:!0});Gc.SpeechServiceRecognizer=void 0;var ye=f(),nt=C(),bv=class extends nt.ServiceRecognizerBase{constructor(e,t,r,n,s){super(e,t,r,n,s),this.privSpeechRecognizer=s}async processTypeSpecificMessages(e){let t,r=new ye.PropertyCollection;r.setProperty(ye.PropertyId.SpeechServiceResponse_JsonResult,e.textBody);let n=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":let s=nt.SpeechHypothesis.fromJSON(e.textBody),o=s.Offset+this.privRequestSession.currentTurnAudioOffset;t=new ye.SpeechRecognitionResult(this.privRequestSession.requestId,ye.ResultReason.RecognizingSpeech,s.Text,s.Duration,o,s.Language,s.LanguageDetectionConfidence,void 0,void 0,e.textBody,r),this.privRequestSession.onHypothesis(o);let a=new ye.SpeechRecognitionEventArgs(t,s.Duration,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,a)}catch{}n=!0;break;case"speech.phrase":let c=nt.SimpleSpeechPhrase.fromJSON(e.textBody),u=nt.EnumTranslation.implTranslateRecognitionResult(c.RecognitionStatus,this.privExpectContentAssessmentResponse);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+c.Offset+c.Duration),ye.ResultReason.Canceled===u){let l=nt.EnumTranslation.implTranslateCancelResult(c.RecognitionStatus),h=nt.EnumTranslation.implTranslateCancelErrorCode(c.RecognitionStatus);await this.cancelRecognitionLocal(l,h,nt.EnumTranslation.implTranslateErrorDetails(h))}else{if(!(this.privRequestSession.isSpeechEnded&&u===ye.ResultReason.NoMatch&&c.RecognitionStatus!==nt.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(nt.OutputFormatPropertyName)===ye.OutputFormat[ye.OutputFormat.Simple])t=new ye.SpeechRecognitionResult(this.privRequestSession.requestId,u,c.DisplayText,c.Duration,c.Offset+this.privRequestSession.currentTurnAudioOffset,c.Language,c.LanguageDetectionConfidence,void 0,void 0,e.textBody,r);else{let h=nt.DetailedSpeechPhrase.fromJSON(e.textBody),d=h.Offset+this.privRequestSession.currentTurnAudioOffset,g=h.getJsonWithCorrectedOffsets(d);t=new ye.SpeechRecognitionResult(this.privRequestSession.requestId,u,h.RecognitionStatus===nt.RecognitionStatus.Success?h.NBest[0].Display:void 0,h.Duration,d,h.Language,h.LanguageDetectionConfidence,void 0,void 0,g,r)}let l=new ye.SpeechRecognitionEventArgs(t,t.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,l)}catch{}}if(this.privSuccessCallback){try{this.privSuccessCallback(t)}catch(l){this.privErrorCallback&&this.privErrorCallback(l)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}n=!0;break;default:break}return n}cancelRecognition(e,t,r,n,s){let o=new ye.PropertyCollection;if(o.setProperty(nt.CancellationErrorCodePropertyName,ye.CancellationErrorCode[n]),this.privSpeechRecognizer.canceled){let a=new ye.SpeechRecognitionCanceledEventArgs(r,s,n,void 0,e);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,a)}catch{}}if(this.privSuccessCallback){let a=new ye.SpeechRecognitionResult(t,ye.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,s,void 0,o);try{this.privSuccessCallback(a),this.privSuccessCallback=void 0}catch{}}}};Gc.SpeechServiceRecognizer=bv});var SP=p($c=>{"use strict";Object.defineProperty($c,"__esModule",{value:!0});$c.ConversationTranscriptionServiceRecognizer=void 0;var Me=f(),st=C(),Av=class extends st.ServiceRecognizerBase{constructor(e,t,r,n,s){super(e,t,r,n,s),this.privConversationTranscriber=s,this.setSpeakerDiarizationJson()}setSpeakerDiarizationJson(){if(this.privEnableSpeakerId){let e=this.privSpeechContext.getSection("phraseDetection");e.mode="Conversation";let t={};t.mode="Anonymous",t.audioSessionId=this.privDiarizationSessionId,t.audioOffsetMs=0,e.speakerDiarization=t,this.privSpeechContext.setSection("phraseDetection",e)}}async processTypeSpecificMessages(e){let t,r=new Me.PropertyCollection;r.setProperty(Me.PropertyId.SpeechServiceResponse_JsonResult,e.textBody);let n=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":let s=st.SpeechHypothesis.fromJSON(e.textBody),o=s.Offset+this.privRequestSession.currentTurnAudioOffset;t=new Me.ConversationTranscriptionResult(this.privRequestSession.requestId,Me.ResultReason.RecognizingSpeech,s.Text,s.Duration,o,s.Language,s.LanguageDetectionConfidence,void 0,void 0,e.textBody,r),this.privRequestSession.onHypothesis(o);let a=new Me.ConversationTranscriptionEventArgs(t,s.Duration,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribing)try{this.privConversationTranscriber.transcribing(this.privConversationTranscriber,a)}catch{}n=!0;break;case"speech.phrase":let c=st.SimpleSpeechPhrase.fromJSON(e.textBody),u=st.EnumTranslation.implTranslateRecognitionResult(c.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+c.Offset+c.Duration),Me.ResultReason.Canceled===u){let l=st.EnumTranslation.implTranslateCancelResult(c.RecognitionStatus),h=st.EnumTranslation.implTranslateCancelErrorCode(c.RecognitionStatus);await this.cancelRecognitionLocal(l,h,st.EnumTranslation.implTranslateErrorDetails(h))}else if(!(this.privRequestSession.isSpeechEnded&&u===Me.ResultReason.NoMatch&&c.RecognitionStatus!==st.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(st.OutputFormatPropertyName)===Me.OutputFormat[Me.OutputFormat.Simple])t=new Me.ConversationTranscriptionResult(this.privRequestSession.requestId,u,c.DisplayText,c.Duration,c.Offset+this.privRequestSession.currentTurnAudioOffset,c.Language,c.LanguageDetectionConfidence,c.SpeakerId,void 0,e.textBody,r);else{let h=st.DetailedSpeechPhrase.fromJSON(e.textBody),d=h.Offset+this.privRequestSession.currentTurnAudioOffset,g=h.getJsonWithCorrectedOffsets(d);t=new Me.ConversationTranscriptionResult(this.privRequestSession.requestId,u,h.RecognitionStatus===st.RecognitionStatus.Success?h.NBest[0].Display:void 0,h.Duration,d,h.Language,h.LanguageDetectionConfidence,c.SpeakerId,void 0,g,r)}let l=new Me.ConversationTranscriptionEventArgs(t,t.offset,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribed)try{this.privConversationTranscriber.transcribed(this.privConversationTranscriber,l)}catch{}}n=!0;break;default:break}return n}cancelRecognition(e,t,r,n,s){if(new Me.PropertyCollection().setProperty(st.CancellationErrorCodePropertyName,Me.CancellationErrorCode[n]),this.privConversationTranscriber.canceled){let a=new Me.ConversationTranscriptionCanceledEventArgs(r,s,n,void 0,e);try{this.privConversationTranscriber.canceled(this.privConversationTranscriber,a)}catch{}}}};$c.ConversationTranscriptionServiceRecognizer=Av});var PP=p(Qc=>{"use strict";Object.defineProperty(Qc,"__esModule",{value:!0});Qc.TranscriptionServiceRecognizer=void 0;var RT=P(),tr=f(),CP=C(),ET=ii(),Tv=class extends CP.ConversationServiceRecognizer{constructor(e,t,r,n,s){super(e,t,r,n,s),this.privTranscriberRecognizer=s,this.sendPrePayloadJSONOverride=o=>this.sendTranscriptionStartJSON(o),this.privRecognizerConfig.parameters.getProperty(tr.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps)==="true"&&this.privSpeechContext.setWordLevelTimings()}async sendSpeechEventAsync(e,t){if(this.privRequestSession.isRecognizing){let r=await this.fetchConnection();await this.sendSpeechEvent(r,this.createSpeechEventPayload(e,t))}}async sendMeetingSpeechEventAsync(e,t){if(this.privRequestSession.isRecognizing){let r=await this.fetchConnection();await this.sendSpeechEvent(r,this.createMeetingSpeechEventPayload(e,t))}}processTypeSpecificMessages(e){return this.processSpeechMessages(e)}handleRecognizedCallback(e,t,r){try{let n=new tr.SpeechRecognitionEventArgs(e,t,r);if(this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer,n),this.privSuccessCallback){try{this.privSuccessCallback(e)}catch(s){this.privErrorCallback&&this.privErrorCallback(s)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}catch{}}handleRecognizingCallback(e,t,r){try{let n=new tr.SpeechRecognitionEventArgs(e,t,r);this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer,n)}catch{}}cancelRecognition(e,t,r,n,s){let o=new tr.PropertyCollection;if(o.setProperty(CP.CancellationErrorCodePropertyName,tr.CancellationErrorCode[n]),this.privTranscriberRecognizer.IsMeetingRecognizer()){if(this.privTranscriberRecognizer.canceled){let a=new tr.MeetingTranscriptionCanceledEventArgs(r,s,n,void 0,e);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,a)}catch{}}}else if(this.privTranscriberRecognizer.canceled){let a=new tr.ConversationTranscriptionCanceledEventArgs(r,s,n,void 0,e);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,a)}catch{}}if(this.privSuccessCallback){let a=new tr.SpeechRecognitionResult(t,tr.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,s,void 0,o);try{this.privSuccessCallback(a),this.privSuccessCallback=void 0}catch{}}}async sendTranscriptionStartJSON(e){if(await this.sendSpeechContext(e,!0),this.privTranscriberRecognizer.IsMeetingRecognizer()){let t=this.privTranscriberRecognizer.getMeetingInfo(),r=this.createMeetingSpeechEventPayload(t,"start");await this.sendSpeechEvent(e,r)}else{let t=this.privTranscriberRecognizer.getConversationInfo(),r=this.createSpeechEventPayload(t,"start");await this.sendSpeechEvent(e,r)}await this.sendWaveHeader(e)}sendSpeechEvent(e,t){let r=JSON.stringify(t);if(r)return e.send(new ET.SpeechConnectionMessage(RT.MessageType.Text,"speech.event",this.privRequestSession.requestId,"application/json",r))}createSpeechEventPayload(e,t){let r={id:"meeting",name:t,meeting:e.conversationProperties};return r.meeting.id=e.id,r.meeting.attendees=e.participants,r}createMeetingSpeechEventPayload(e,t){let r={id:"meeting",name:t,meeting:e.meetingProperties};return r.meeting.id=e.id,r.meeting.attendees=e.participants,r}};Qc.TranscriptionServiceRecognizer=Tv});var RP=p(Xc=>{"use strict";Object.defineProperty(Xc,"__esModule",{value:!0});Xc.DetailedSpeechPhrase=void 0;var _T=C(),Ov=class i{constructor(e){this.privDetailedSpeechPhrase=JSON.parse(e),this.privDetailedSpeechPhrase.RecognitionStatus=_T.RecognitionStatus[this.privDetailedSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new i(e)}getJsonWithCorrectedOffsets(e){if(this.privDetailedSpeechPhrase.NBest){let t;for(let r of this.privDetailedSpeechPhrase.NBest)if(r.Words&&r.Words[0]){t=r.Words[0].Offset;break}if(t&&t<e){let r=e-t;for(let n of this.privDetailedSpeechPhrase.NBest){if(n.Words)for(let s of n.Words)s.Offset+=r;if(n.DisplayWords)for(let s of n.DisplayWords)s.Offset+=r}}}return JSON.stringify(this.privDetailedSpeechPhrase)}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}};Xc.DetailedSpeechPhrase=Ov});var EP=p(Zc=>{"use strict";Object.defineProperty(Zc,"__esModule",{value:!0});Zc.SimpleSpeechPhrase=void 0;var IT=C(),kv=class i{constructor(e){this.privSimpleSpeechPhrase=JSON.parse(e),this.privSimpleSpeechPhrase.RecognitionStatus=IT.RecognitionStatus[this.privSimpleSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new i(e)}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}};Zc.SimpleSpeechPhrase=kv});var _P=p(Yc=>{"use strict";Object.defineProperty(Yc,"__esModule",{value:!0});Yc.AddedLmIntent=void 0;var Mv=class{constructor(e,t){this.modelImpl=e,this.intentName=t}};Yc.AddedLmIntent=Mv});var wP=p(eu=>{"use strict";Object.defineProperty(eu,"__esModule",{value:!0});eu.IntentServiceRecognizer=void 0;var IP=P(),ne=f(),Wi=C(),Dv=class extends Wi.ServiceRecognizerBase{constructor(e,t,r,n,s){super(e,t,r,n,s),this.privIntentRecognizer=s,this.privIntentDataSent=!1}setIntents(e,t){this.privAddedLmIntents=e,this.privUmbrellaIntent=t,this.privIntentDataSent=!0}processTypeSpecificMessages(e){let t,r,n=!1,s=new ne.PropertyCollection;switch(e.messageType===IP.MessageType.Text&&s.setProperty(ne.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speech.hypothesis":let a=Wi.SpeechHypothesis.fromJSON(e.textBody);if(t=new ne.IntentRecognitionResult(void 0,this.privRequestSession.requestId,ne.ResultReason.RecognizingIntent,a.Text,a.Duration,a.Offset+this.privRequestSession.currentTurnAudioOffset,a.Language,a.LanguageDetectionConfidence,void 0,e.textBody,s),this.privRequestSession.onHypothesis(t.offset),r=new ne.IntentRecognitionEventArgs(t,a.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId),this.privIntentRecognizer.recognizing)try{this.privIntentRecognizer.recognizing(this.privIntentRecognizer,r)}catch{}n=!0;break;case"speech.phrase":let c=Wi.SimpleSpeechPhrase.fromJSON(e.textBody);t=new ne.IntentRecognitionResult(void 0,this.privRequestSession.requestId,Wi.EnumTranslation.implTranslateRecognitionResult(c.RecognitionStatus),c.DisplayText,c.Duration,c.Offset+this.privRequestSession.currentTurnAudioOffset,c.Language,c.LanguageDetectionConfidence,void 0,e.textBody,s),r=new ne.IntentRecognitionEventArgs(t,t.offset,this.privRequestSession.sessionId);let u=()=>{if(this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,r)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(t)}catch(h){this.privErrorCallback&&this.privErrorCallback(h)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}};this.privIntentDataSent===!1||ne.ResultReason.NoMatch===r.result.reason?(this.privRequestSession.onPhraseRecognized(r.offset+r.result.duration),u()):this.privPendingIntentArgs=r,n=!0;break;case"response":if(r=this.privPendingIntentArgs,this.privPendingIntentArgs=void 0,r===void 0){if(e.textBody==="")return;r=new ne.IntentRecognitionEventArgs(new ne.IntentRecognitionResult,0,this.privRequestSession.sessionId)}let l=Wi.IntentResponse.fromJSON(e.textBody);if(l!==null&&l.topScoringIntent&&l.topScoringIntent.intent){let h=this.privAddedLmIntents[l.topScoringIntent.intent];if(this.privUmbrellaIntent!==void 0&&(h=this.privUmbrellaIntent),h){let d=h===void 0||h.intentName===void 0?l.topScoringIntent.intent:h.intentName,g=r.result.reason;d!==void 0&&(g=ne.ResultReason.RecognizedIntent);let M=r.result.properties!==void 0?r.result.properties:new ne.PropertyCollection;M.setProperty(ne.PropertyId.LanguageUnderstandingServiceResponse_JsonResult,e.textBody),r=new ne.IntentRecognitionEventArgs(new ne.IntentRecognitionResult(d,r.result.resultId,g,r.result.text,r.result.duration,r.result.offset,void 0,void 0,r.result.errorDetails,r.result.json,M),r.offset,r.sessionId)}}if(this.privRequestSession.onPhraseRecognized(r.offset+r.result.duration),this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,r)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(r.result)}catch(h){this.privErrorCallback&&this.privErrorCallback(h)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}n=!0;break;default:break}let o=new IP.Deferred;return o.resolve(n),o.promise}cancelRecognition(e,t,r,n,s){let o=new ne.PropertyCollection;if(o.setProperty(Wi.CancellationErrorCodePropertyName,ne.CancellationErrorCode[n]),this.privIntentRecognizer.canceled){let a=new ne.IntentRecognitionCanceledEventArgs(r,s,n,void 0,void 0,e);try{this.privIntentRecognizer.canceled(this.privIntentRecognizer,a)}catch{}}if(this.privSuccessCallback){let a=new ne.IntentRecognitionResult(void 0,t,ne.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,s,void 0,o);try{this.privSuccessCallback(a),this.privSuccessCallback=void 0}catch{}}}};eu.IntentServiceRecognizer=Dv});var bP=p(tu=>{"use strict";Object.defineProperty(tu,"__esModule",{value:!0});tu.IntentResponse=void 0;var xv=class i{constructor(e){e===""?this.privIntentResponse={}:this.privIntentResponse=JSON.parse(e)}static fromJSON(e){return new i(e)}get query(){return this.privIntentResponse.query}get topScoringIntent(){return this.privIntentResponse.topScoringIntent}get entities(){return this.privIntentResponse.entities}};tu.IntentResponse=xv});var TP=p(AP=>{"use strict";Object.defineProperty(AP,"__esModule",{value:!0})});var kP=p(ru=>{"use strict";Object.defineProperty(ru,"__esModule",{value:!0});ru.ServiceTelemetryListener=void 0;var rr=P(),OP=Ac(),Nv=class{constructor(e,t,r){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=e,this.privAudioSourceId=t,this.privAudioNodeId=r,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(e){e>0&&this.privPhraseLatencies.push(Date.now()-e)}hypothesisReceived(e){e>0&&this.privHypothesisLatencies.push(Date.now()-e)}onEvent(e){this.privIsDisposed||(e instanceof OP.RecognitionTriggeredEvent&&e.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:e.eventTime,Name:"ListeningTrigger",Start:e.eventTime}),e instanceof rr.AudioStreamNodeAttachingEvent&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof rr.AudioStreamNodeAttachedEvent&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof rr.AudioSourceErrorEvent&&e.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof rr.AudioStreamNodeErrorEvent&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof rr.AudioStreamNodeDetachedEvent&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Name:"Microphone",Start:this.privMicStartTime})),e instanceof OP.ConnectingToServiceEvent&&e.requestId===this.privRequestId&&(this.privConnectionId=e.sessionId),e instanceof rr.ConnectionStartEvent&&e.connectionId===this.privConnectionId&&(this.privConnectionStartTime=e.eventTime),e instanceof rr.ConnectionEstablishedEvent&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof rr.ConnectionEstablishErrorEvent&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Error:this.getConnectionError(e.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof rr.ConnectionMessageReceivedEvent&&e.connectionId===this.privConnectionId&&e.message&&e.message.headers&&e.message.headers.path&&(this.privReceivedMessages[e.message.headers.path]||(this.privReceivedMessages[e.message.headers.path]=new Array),this.privReceivedMessages[e.message.headers.path].length<50&&this.privReceivedMessages[e.message.headers.path].push(e.networkReceivedTime)))}getTelemetry(){let e=new Array;this.privListeningTriggerMetric&&e.push(this.privListeningTriggerMetric),this.privMicMetric&&e.push(this.privMicMetric),this.privConnectionEstablishMetric&&e.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&e.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&e.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});let t={Metrics:e,ReceivedMessages:this.privReceivedMessages},r=JSON.stringify(t);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],r}get hasTelemetry(){return Object.keys(this.privReceivedMessages).length!==0||this.privListeningTriggerMetric!==null||this.privMicMetric!==null||this.privConnectionEstablishMetric!==null||this.privPhraseLatencies.length!==0||this.privHypothesisLatencies.length!==0}dispose(){this.privIsDisposed=!0}getConnectionError(e){switch(e){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+e.toString()}}};ru.ServiceTelemetryListener=Nv});var MP=p(nu=>{"use strict";Object.defineProperty(nu,"__esModule",{value:!0});nu.RequestSession=void 0;var Hi=P(),iu=Ac(),wT=kP(),qv=class{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecognitionBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=e,this.privRequestId=Hi.createNoDashGuid(),this.privAudioNodeId=Hi.createNoDashGuid(),this.privTurnDeferral=new Hi.Deferred,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}get recognitionBytesSent(){return this.privRecognitionBytesSent}listenForServiceTelemetry(e){this.privServiceTelemetryListener&&this.privDetachables.push(e.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privRecognitionBytesSent=0,this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new wT.ServiceTelemetryListener(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new iu.RecognitionTriggeredEvent(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}async onAudioSourceAttachCompleted(e,t){this.privAudioNode=e,this.privIsAudioNodeDetached=!1,t?await this.onComplete():this.onEvent(new iu.ListeningStartedEvent(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onPreConnectionStart(e,t){this.privAuthFetchEventId=e,this.privSessionId=t,this.onEvent(new iu.ConnectingToServiceEvent(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}async onAuthCompleted(e){e&&await this.onComplete()}async onConnectionEstablishCompleted(e,t){if(e===200){this.onEvent(new iu.RecognitionStartedEvent(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privBytesSent=0;return}else e===403&&await this.onComplete()}async onServiceTurnEndResponse(e){this.privTurnDeferral.resolve(),!e||this.isSpeechEnded?(await this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())}onSpeechContext(){this.privRequestId=Hi.createNoDashGuid()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new Hi.Deferred}onHypothesis(e){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(e)))}onPhraseRecognized(e){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(e)),this.onServiceRecognized(e)}onServiceRecognized(e){this.privLastRecoOffset=e,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(e),this.privConnectionAttempts=0}onAudioSent(e){this.privBytesSent+=e,this.privRecognitionBytesSent+=e}onRetryConnection(){this.privConnectionAttempts++}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(let e of this.privDetachables)await e.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}async onStopRecognizing(){await this.onComplete()}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(e){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(e),Hi.Events.instance.onEvent(e)}async onComplete(){this.privIsRecognizing&&(this.privIsRecognizing=!1,await this.detachAudioNode())}async detachAudioNode(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&await this.privAudioNode.detach())}};nu.RequestSession=qv});var DP=p(su=>{"use strict";Object.defineProperty(su,"__esModule",{value:!0});su.SpeechContext=void 0;var jv=class{constructor(e){this.privContext={},this.privDynamicGrammar=e}getSection(e){return this.privContext[e]||{}}setSection(e,t){this.privContext[e]=t}setPronunciationAssessmentParams(e,t,r=!1){this.privContext.phraseDetection===void 0&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment===void 0&&(this.privContext.phraseDetection.enrichment={pronunciationAssessment:{}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(e),r&&(this.privContext.phraseDetection.mode="Conversation"),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push("PronunciationAssessment"),this.privContext.phraseOutput.detailed.options.indexOf("SNR")===-1&&this.privContext.phraseOutput.detailed.options.push("SNR"),t&&(this.privContext.phraseDetection.enrichment.contentAssessment={topic:t},this.privContext.phraseOutput.detailed.options.push("ContentAssessment"))}setDetailedOutputFormat(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format="Detailed"}setWordLevelTimings(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format="Detailed",this.privContext.phraseOutput.detailed.options.indexOf("WordTimings")===-1&&this.privContext.phraseOutput.detailed.options.push("WordTimings")}setSpeakerDiarizationAudioOffsetMs(e){this.privContext.phraseDetection.speakerDiarization.audioOffsetMs=e}toJSON(){let e=this.privDynamicGrammar.generateGrammarObject();return this.setSection("dgi",e),JSON.stringify(this.privContext)}};su.SpeechContext=jv});var xP=p(ou=>{"use strict";Object.defineProperty(ou,"__esModule",{value:!0});ou.DynamicGrammarBuilder=void 0;var zv=class{addPhrase(e){this.privPhrases||(this.privPhrases=[]),e instanceof Array?this.privPhrases=this.privPhrases.concat(e):this.privPhrases.push(e)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(e){this.privGrammars||(this.privGrammars=[]),e instanceof Array?this.privGrammars=this.privGrammars.concat(e):this.privGrammars.push(e)}clearGrammars(){this.privGrammars=void 0}generateGrammarObject(){if(this.privGrammars===void 0&&this.privPhrases===void 0)return;let e={};if(e.ReferenceGrammars=this.privGrammars,this.privPhrases!==void 0&&this.privPhrases.length!==0){let t=[];this.privPhrases.forEach(r=>{t.push({Text:r})}),e.Groups=[{Type:"Generic",Items:t}]}return e}};ou.DynamicGrammarBuilder=zv});var qP=p(NP=>{"use strict";Object.defineProperty(NP,"__esModule",{value:!0})});var Bv=p(si=>{"use strict";Object.defineProperty(si,"__esModule",{value:!0});si.MessageDataStreamType=si.ActivityPayloadResponse=void 0;var Lv=class i{constructor(e){this.privActivityResponse=JSON.parse(e)}static fromJSON(e){return new i(e)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}};si.ActivityPayloadResponse=Lv;var bT;(function(i){i[i.None=0]="None",i[i.TextToSpeechAudio=1]="TextToSpeechAudio"})(bT=si.MessageDataStreamType||(si.MessageDataStreamType={}))});var jP=p(au=>{"use strict";Object.defineProperty(au,"__esModule",{value:!0});au.DialogServiceTurnState=void 0;var AT=Pi(),TT=Lr(),OT=Bv(),Fv=class{constructor(e,t){this.privRequestId=t,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=e,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(e,t){return e.messageDataStreamType===OT.MessageDataStreamType.TextToSpeechAudio&&(this.privAudioStream=TT.AudioOutputStream.createPullStream(),this.privAudioStream.format=t!==void 0?t:AT.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){this.privAudioStream!==null&&!this.privAudioStream.isClosed&&this.privAudioStream.close()}complete(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout(()=>{this.privTurnManager.CompleteTurn(this.privRequestId)},2e3)}};au.DialogServiceTurnState=Fv});var LP=p(cu=>{"use strict";Object.defineProperty(cu,"__esModule",{value:!0});cu.DialogServiceTurnStateManager=void 0;var zP=pt(),kT=jP(),Vv=class{constructor(){this.privTurnMap=new Map}StartTurn(e){if(this.privTurnMap.has(e))throw new zP.InvalidOperationError("Service error: There is already a turn with id:"+e);let t=new kT.DialogServiceTurnState(this,e);return this.privTurnMap.set(e,t),this.privTurnMap.get(e)}GetTurn(e){return this.privTurnMap.get(e)}CompleteTurn(e){if(!this.privTurnMap.has(e))throw new zP.InvalidOperationError("Service error: Received turn end for an unknown turn id:"+e);let t=this.privTurnMap.get(e);return t.complete(),this.privTurnMap.delete(e),t}};cu.DialogServiceTurnStateManager=Vv});var BP=p(pu=>{"use strict";Object.defineProperty(pu,"__esModule",{value:!0});pu.DialogServiceAdapter=void 0;var MT=ce(),DT=Dp(),Ae=P(),xT=Pi(),k=f(),NT=LP(),Dt=C(),qT=Bv(),uu=ii(),Uv=class extends Dt.ServiceRecognizerBase{constructor(e,t,r,n,s){super(e,t,r,n,s),this.privEvents=new Ae.EventSource,this.privDialogServiceConnector=s,this.receiveMessageOverride=()=>this.receiveDialogMessageOverride(),this.privTurnStateManager=new NT.DialogServiceTurnStateManager,this.recognizeOverride=(o,a,c)=>this.listenOnce(o,a,c),this.postConnectImplOverride=o=>this.dialogConnectImpl(o),this.configConnectionOverride=o=>this.configConnection(o),this.disconnectOverride=()=>this.privDisconnect(),this.privDialogAudioSource=r,this.agentConfigSent=!1,this.privLastResult=null,this.connectionEvents.attach(o=>{o.name==="ConnectionClosedEvent"&&(this.terminateMessageLoop=!0)})}async sendMessage(e){let t=Ae.createGuid(),r=Ae.createNoDashGuid(),n={context:{interactionId:t},messagePayload:JSON.parse(e),version:.5},s=JSON.stringify(n);await(await this.fetchConnection()).send(new uu.SpeechConnectionMessage(Ae.MessageType.Text,"agent",r,"application/json",s))}async privDisconnect(){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,k.CancellationReason.Error,k.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1}processTypeSpecificMessages(e){let t=new k.PropertyCollection;e.messageType===Ae.MessageType.Text&&t.setProperty(k.PropertyId.SpeechServiceResponse_JsonResult,e.textBody);let r,n;switch(e.path.toLowerCase()){case"speech.phrase":let o=Dt.SimpleSpeechPhrase.fromJSON(e.textBody);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+o.Offset+o.Duration),o.RecognitionStatus!==Dt.RecognitionStatus.TooManyRequests&&o.RecognitionStatus!==Dt.RecognitionStatus.Error){let d=this.fireEventForResult(o,t);if(this.privLastResult=d.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,d)}catch{}}n=!0;break;case"speech.hypothesis":let a=Dt.SpeechHypothesis.fromJSON(e.textBody),c=a.Offset+this.privRequestSession.currentTurnAudioOffset;r=new k.SpeechRecognitionResult(this.privRequestSession.requestId,k.ResultReason.RecognizingSpeech,a.Text,a.Duration,c,a.Language,a.LanguageDetectionConfidence,void 0,void 0,e.textBody,t),this.privRequestSession.onHypothesis(c);let u=new k.SpeechRecognitionEventArgs(r,a.Duration,this.privRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,u)}catch{}n=!0;break;case"speech.keyword":let l=Dt.SpeechKeyword.fromJSON(e.textBody);r=new k.SpeechRecognitionResult(this.privRequestSession.requestId,l.Status==="Accepted"?k.ResultReason.RecognizedKeyword:k.ResultReason.NoMatch,l.Text,l.Duration,l.Offset,void 0,void 0,void 0,void 0,e.textBody,t),l.Status!=="Accepted"&&(this.privLastResult=r);let h=new k.SpeechRecognitionEventArgs(r,r.duration,r.resultId);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,h)}catch{}n=!0;break;case"audio":{let d=e.requestId.toUpperCase(),g=this.privTurnStateManager.GetTurn(d);try{e.binaryBody?g.audioStream.write(e.binaryBody):g.endAudioStream()}catch{}}n=!0;break;case"response":this.handleResponseMessage(e),n=!0;break;default:break}let s=new Ae.Deferred;return s.resolve(n),s.promise}async cancelRecognition(e,t,r,n,s){if(this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing&&await this.privRequestSession.onStopRecognizing(),this.privDialogServiceConnector.canceled){let o=new k.PropertyCollection;o.setProperty(Dt.CancellationErrorCodePropertyName,k.CancellationErrorCode[n]);let a=new k.SpeechRecognitionCanceledEventArgs(r,s,n,void 0,e);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,a)}catch{}if(this.privSuccessCallback){let c=new k.SpeechRecognitionResult(void 0,k.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,s,void 0,o);try{this.privSuccessCallback(c),this.privSuccessCallback=void 0}catch{}}}}async listenOnce(e,t,r){this.privRecognizerConfig.recognitionMode=e,this.privSuccessCallback=t,this.privErrorCallback=r,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(k.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);let n=this.connectImpl(),s=this.sendPreAudioMessages(),o=await this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId),a=await this.privDialogAudioSource.format,c=await this.privDialogAudioSource.deviceInfo,u=new MT.ReplayableAudioNode(o,a.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(u,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:c};try{await n,await s}catch(d){return await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,k.CancellationReason.Error,k.CancellationErrorCode.ConnectionFailure,d),Promise.resolve()}let l=new k.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,l),this.sendAudio(u).then(()=>{},async d=>{await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,k.CancellationReason.Error,k.CancellationErrorCode.RuntimeError,d)})}dialogConnectImpl(e){return this.privConnectionLoop=this.startMessageLoop(),e}receiveDialogMessageOverride(){let e=new Ae.Deferred,t=async()=>{try{let r=this.isDisposed(),n=!this.isDisposed()&&this.terminateMessageLoop;if(r||n){e.resolve(void 0);return}let o=await(await this.fetchConnection()).read();if(!o)return t();let a=uu.SpeechConnectionMessage.fromConnectionMessage(o);switch(a.path.toLowerCase()){case"turn.start":{let M=a.requestId.toUpperCase(),D=this.privRequestSession.requestId.toUpperCase();M!==D?this.privTurnStateManager.StartTurn(M):this.privRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":let u=Dt.SpeechDetected.fromJSON(a.textBody),l=new k.RecognitionEventArgs(u.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,l);break;case"speech.enddetected":let h;a.textBody.length>0?h=a.textBody:h="{ Offset: 0 }";let d=Dt.SpeechDetected.fromJSON(h);this.privRequestSession.onServiceRecognized(d.Offset+this.privRequestSession.currentTurnAudioOffset);let g=new k.RecognitionEventArgs(d.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,g);break;case"turn.end":{let M=a.requestId.toUpperCase(),D=this.privRequestSession.requestId.toUpperCase();if(M!==D)this.privTurnStateManager.CompleteTurn(M);else{let oe=new k.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(!1),(!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)&&this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,oe),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(Q){this.privErrorCallback&&this.privErrorCallback(Q)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:try{await this.processTypeSpecificMessages(a)||this.serviceEvents&&this.serviceEvents.onEvent(new Ae.ServiceEvent(a.path.toLowerCase(),a.textBody))}catch{}}return t()}catch{this.terminateMessageLoop=!0,e.resolve()}};return t().catch(r=>{Ae.Events.instance.onEvent(new Ae.BackgroundEvent(r))}),e.promise}async startMessageLoop(){this.terminateMessageLoop=!1;try{await this.receiveDialogMessageOverride()}catch(e){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,k.CancellationReason.Error,k.CancellationErrorCode.RuntimeError,e)}return Promise.resolve()}async configConnection(e){return this.terminateMessageLoop?(this.terminateMessageLoop=!1,Promise.reject("Connection to service terminated.")):(await this.sendSpeechServiceConfig(e,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendAgentConfig(e),e)}async sendPreAudioMessages(){let e=await this.fetchConnection();this.addKeywordContextData(),await this.sendSpeechContext(e,!0),await this.sendAgentContext(e),await this.sendWaveHeader(e)}sendAgentConfig(e){if(this.agentConfig&&!this.agentConfigSent){if(this.privRecognizerConfig.parameters.getProperty(k.PropertyId.Conversation_DialogType)===k.DialogServiceConfig.DialogTypes.CustomCommands){let r=this.agentConfig.get();r.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(k.PropertyId.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(r)}this.onEvent(new DT.SendingAgentContextMessageEvent(this.agentConfig));let t=this.agentConfig.toJsonString();return this.agentConfigSent=!0,e.send(new uu.SpeechConnectionMessage(Ae.MessageType.Text,"agent.config",this.privRequestSession.requestId,"application/json",t))}}sendAgentContext(e){let t=Ae.createGuid(),r=this.privDialogServiceConnector.properties.getProperty(k.PropertyId.Conversation_Speech_Activity_Template),s=JSON.stringify({channelData:"",context:{interactionId:t},messagePayload:typeof r===void 0?void 0:r,version:.5});return e.send(new uu.SpeechConnectionMessage(Ae.MessageType.Text,"speech.agent.context",this.privRequestSession.requestId,"application/json",s))}fireEventForResult(e,t){let r=Dt.EnumTranslation.implTranslateRecognitionResult(e.RecognitionStatus),n=e.Offset+this.privRequestSession.currentTurnAudioOffset,s=new k.SpeechRecognitionResult(this.privRequestSession.requestId,r,e.DisplayText,e.Duration,n,e.Language,e.LanguageDetectionConfidence,void 0,void 0,JSON.stringify(e),t);return new k.SpeechRecognitionEventArgs(s,n,this.privRequestSession.sessionId)}handleResponseMessage(e){let t=JSON.parse(e.textBody);switch(t.messageType.toLowerCase()){case"message":let r=e.requestId.toUpperCase(),n=qT.ActivityPayloadResponse.fromJSON(e.textBody),s=this.privTurnStateManager.GetTurn(r);if(n.conversationId){let c=this.agentConfig.get();c.botInfo.conversationId=n.conversationId,this.agentConfig.set(c)}let o=s.processActivityPayload(n,xT.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(k.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0))),a=new k.ActivityReceivedEventArgs(n.messagePayload,o);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,a)}catch{}break;case"messagestatus":if(this.privDialogServiceConnector.turnStatusReceived)try{this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector,new k.TurnStatusReceivedEventArgs(e.textBody))}catch{}break;default:Ae.Events.instance.onEvent(new Ae.BackgroundEvent(`Unexpected response of type ${t.messageType}. Ignoring.`));break}}onEvent(e){this.privEvents.onEvent(e),Ae.Events.instance.onEvent(e)}addKeywordContextData(){let e=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(e===void 0)return;let t=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),r=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),n=e.split(";"),s=t===void 0?[]:t.split(";"),o=r===void 0?[]:r.split(";"),a=[];for(let c=0;c<n.length;c++){let u={};u.text=n[c],c<s.length&&(u.offset=Number(s[c])),c<o.length&&(u.duration=Number(o[c])),a.push(u)}this.speechContext.setSection("invocationSource","VoiceActivationWithKeyword"),this.speechContext.setSection("keywordDetection",[{clientDetectedKeywords:a,onReject:{action:"EndOfTurn"},type:"startTrigger"}])}};pu.DialogServiceAdapter=Uv});var FP=p(lu=>{"use strict";Object.defineProperty(lu,"__esModule",{value:!0});lu.AgentConfig=void 0;var Wv=class{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(e){this.iPrivConfig=e}};lu.AgentConfig=Wv});var du=p(hu=>{"use strict";Object.defineProperty(hu,"__esModule",{value:!0});hu.ConversationConnectionConfig=void 0;var jT=Yd(),xt=class i extends jT.RestConfigBase{static get host(){return i.privHost}static get apiVersion(){return i.privApiVersion}static get clientAppId(){return i.privClientAppId}static get defaultLanguageCode(){return i.privDefaultLanguageCode}static get restPath(){return i.privRestPath}static get webSocketPath(){return i.privWebSocketPath}static get transcriptionEventKeys(){return i.privTranscriptionEventKeys}};hu.ConversationConnectionConfig=xt;xt.privHost="dev.microsofttranslator.com";xt.privRestPath="/capito/room";xt.privApiVersion="2.0";xt.privDefaultLanguageCode="en-US";xt.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15";xt.privWebSocketPath="/capito/translate";xt.privTranscriptionEventKeys=["iCalUid","callId","organizer","FLAC","MTUri","DifferentiateGuestSpeakers","audiorecording","Threadid","OrganizerMri","OrganizerTenantId","UserToken"]});var VP=p(fu=>{"use strict";Object.defineProperty(fu,"__esModule",{value:!0});fu.ConversationManager=void 0;var vu=ce(),Er=_(),ir=f(),oi=du(),Hv=class{constructor(){this.privRequestParams=oi.ConversationConnectionConfig.configParams,this.privErrors=oi.ConversationConnectionConfig.restErrors,this.privHost=oi.ConversationConnectionConfig.host,this.privApiVersion=oi.ConversationConnectionConfig.apiVersion,this.privRestPath=oi.ConversationConnectionConfig.restPath,this.privRestAdapter=new vu.RestMessageAdapter({})}createOrJoin(e,t,r,n){try{Er.Contracts.throwIfNullOrUndefined(e,"args");let s=e.getProperty(ir.PropertyId.SpeechServiceConnection_RecoLanguage,oi.ConversationConnectionConfig.defaultLanguageCode),o=e.getProperty(ir.PropertyId.ConversationTranslator_Name,"conversation_host"),a=e.getProperty(ir.PropertyId.ConversationTranslator_Host,this.privHost),c=e.getProperty(ir.PropertyId.ConversationTranslator_CorrelationId),u=e.getProperty(ir.PropertyId.SpeechServiceConnection_Key),l=e.getProperty(ir.PropertyId.SpeechServiceConnection_Region),h=e.getProperty(ir.PropertyId.SpeechServiceAuthorization_Token);Er.Contracts.throwIfNullOrWhitespace(s,"languageCode"),Er.Contracts.throwIfNullOrWhitespace(o,"nickname"),Er.Contracts.throwIfNullOrWhitespace(a,"endpointHost");let d={};d[this.privRequestParams.apiVersion]=this.privApiVersion,d[this.privRequestParams.languageCode]=s,d[this.privRequestParams.nickname]=o;let g={};c&&(g[this.privRequestParams.correlationId]=c),g[this.privRequestParams.clientAppId]=oi.ConversationConnectionConfig.clientAppId,t!==void 0?d[this.privRequestParams.roomId]=t:(Er.Contracts.throwIfNullOrUndefined(l,this.privErrors.authInvalidSubscriptionRegion),g[this.privRequestParams.subscriptionRegion]=l,u?g[this.privRequestParams.subscriptionKey]=u:h?g[this.privRequestParams.authorization]=`Bearer ${h}`:Er.Contracts.throwIfNullOrUndefined(u,this.privErrors.authInvalidSubscriptionKey));let M={};M.headers=g,this.privRestAdapter.options=M;let D=`https://${a}${this.privRestPath}`;this.privRestAdapter.request(vu.RestRequestType.Post,D,d,null).then(oe=>{let Q=vu.RestMessageAdapter.extractHeaderValue(this.privRequestParams.requestId,oe.headers);if(!oe.ok){if(n){let Ce=this.privErrors.invalidCreateJoinConversationResponse.replace("{status}",oe.status.toString()),F;try{F=JSON.parse(oe.data),Ce+=` [${F.error.code}: ${F.error.message}]`}catch{Ce+=` [${oe.data}]`}Q&&(Ce+=` ${Q}`),n(Ce)}return}let ee=JSON.parse(oe.data);if(ee&&(ee.requestId=Q),r){try{r(ee)}catch(Ce){n&&n(Ce)}r=void 0}}).catch(()=>{})}catch(s){if(n)if(s instanceof Error){let o=s;n(o.name+": "+o.message)}else n(s)}}leave(e,t){return new Promise((r,n)=>{try{Er.Contracts.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","config")),Er.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","token"));let s=e.getProperty(ir.PropertyId.ConversationTranslator_Host,this.privHost),o=e.getProperty(ir.PropertyId.ConversationTranslator_CorrelationId),a={};a[this.privRequestParams.apiVersion]=this.privApiVersion,a[this.privRequestParams.sessionToken]=t;let c={};o&&(c[this.privRequestParams.correlationId]=o);let u={};u.headers=c,this.privRestAdapter.options=u;let l=`https://${s}${this.privRestPath}`;this.privRestAdapter.request(vu.RestRequestType.Delete,l,a,null).then(h=>{h.ok,r()}).catch(()=>{})}catch(s){if(s instanceof Error){let o=s;n(o.name+": "+o.message)}else n(s)}})}};fu.ConversationManager=Hv});var Jv=p(gu=>{"use strict";Object.defineProperty(gu,"__esModule",{value:!0});gu.ConversationConnectionMessage=void 0;var zT=P(),Kv=class extends zT.ConnectionMessage{constructor(e,t,r,n){super(e,t,r,n);let s=JSON.parse(this.textBody);s.type!==void 0&&(this.privConversationMessageType=s.type)}get conversationMessageType(){return this.privConversationMessageType}};gu.ConversationConnectionMessage=Kv});var WP=p(mu=>{"use strict";Object.defineProperty(mu,"__esModule",{value:!0});mu.ConversationWebsocketMessageFormatter=void 0;var ai=P(),UP=Jv(),Gv=class{toConnectionMessage(e){let t=new ai.Deferred;try{if(e.messageType===ai.MessageType.Text){let r=new UP.ConversationConnectionMessage(e.messageType,e.textContent,{},e.id);t.resolve(r)}else e.messageType===ai.MessageType.Binary&&t.resolve(new UP.ConversationConnectionMessage(e.messageType,e.binaryContent,void 0,e.id))}catch(r){t.reject(`Error formatting the message. Error: ${r}`)}return t.promise}fromConnectionMessage(e){let t=new ai.Deferred;try{if(e.messageType===ai.MessageType.Text){let r=`${e.textBody?e.textBody:""}`;t.resolve(new ai.RawWebsocketMessage(ai.MessageType.Text,r,e.id))}}catch(r){t.reject(`Error formatting the message. ${r}`)}return t.promise}};mu.ConversationWebsocketMessageFormatter=Gv});var KP=p(yu=>{"use strict";Object.defineProperty(yu,"__esModule",{value:!0});yu.ConversationConnectionFactory=void 0;var HP=ce(),LT=P(),BT=_(),$v=f(),FT=Ze(),Ki=du(),VT=WP(),Qv=class extends FT.ConnectionFactoryBase{create(e,t,r){let n=e.parameters.getProperty($v.PropertyId.ConversationTranslator_Host,Ki.ConversationConnectionConfig.host),s=e.parameters.getProperty($v.PropertyId.ConversationTranslator_CorrelationId,LT.createGuid()),o=`wss://${n}${Ki.ConversationConnectionConfig.webSocketPath}`,a=e.parameters.getProperty($v.PropertyId.ConversationTranslator_Token,void 0);BT.Contracts.throwIfNullOrUndefined(a,"token");let c={};c[Ki.ConversationConnectionConfig.configParams.apiVersion]=Ki.ConversationConnectionConfig.apiVersion,c[Ki.ConversationConnectionConfig.configParams.token]=a,c[Ki.ConversationConnectionConfig.configParams.correlationId]=s;let u=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new HP.WebsocketConnection(o,c,{},new VT.ConversationWebsocketMessageFormatter,HP.ProxyInfo.fromRecognizerConfig(e),u,r)}};yu.ConversationConnectionFactory=Qv});var JP=p(Su=>{"use strict";Object.defineProperty(Su,"__esModule",{value:!0});Su.ConversationRequestSession=void 0;var Xv=P(),Zv=class{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.privSessionId=e,this.privRequestId=Xv.createNoDashGuid(),this.privRequestCompletionDeferral=new Xv.Deferred}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get completionPromise(){return this.privRequestCompletionDeferral.promise}onPreConnectionStart(e,t){this.privSessionId=t}onAuthCompleted(e){e&&this.onComplete()}onConnectionEstablishCompleted(e){e!==200&&e===403&&this.onComplete()}onServiceTurnEndResponse(e){e?this.privRequestId=Xv.createNoDashGuid():this.onComplete()}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(let e of this.privDetachables)await e.detach()}}onComplete(){}};Su.ConversationRequestSession=Zv});var of=p(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});Le.ConversationReceivedTranslationEventArgs=Le.ParticipantsListEventArgs=Le.ParticipantAttributeEventArgs=Le.ParticipantEventArgs=Le.LockRoomEventArgs=Le.MuteAllEventArgs=void 0;var as=f(),Yv=class extends as.SessionEventArgs{constructor(e,t){super(t),this.privIsMuted=e}get isMuted(){return this.privIsMuted}};Le.MuteAllEventArgs=Yv;var ef=class extends as.SessionEventArgs{constructor(e,t){super(t),this.privIsLocked=e}get isMuted(){return this.privIsLocked}};Le.LockRoomEventArgs=ef;var tf=class extends as.SessionEventArgs{constructor(e,t){super(t),this.privParticipant=e}get participant(){return this.privParticipant}};Le.ParticipantEventArgs=tf;var rf=class extends as.SessionEventArgs{constructor(e,t,r,n){super(n),this.privKey=t,this.privValue=r,this.privParticipantId=e}get value(){return this.privValue}get key(){return this.privKey}get id(){return this.privParticipantId}};Le.ParticipantAttributeEventArgs=rf;var nf=class extends as.SessionEventArgs{constructor(e,t,r,n,s,o,a,c,u){super(u),this.privRoomId=e,this.privSessionToken=t,this.privTranslateTo=r,this.privProfanityFilter=n,this.privRoomProfanityFilter=s,this.privIsRoomLocked=o,this.privIsRoomLocked=a,this.privParticipants=c}get sessionToken(){return this.privSessionToken}get conversationId(){return this.privRoomId}get translateTo(){return this.privTranslateTo}get profanityFilter(){return this.privProfanityFilter}get roomProfanityFilter(){return this.privRoomProfanityFilter}get isRoomLocked(){return this.privIsRoomLocked}get isMuteAll(){return this.privIsMuteAll}get participants(){return this.privParticipants}};Le.ParticipantsListEventArgs=nf;var sf=class{constructor(e,t,r){this.privPayload=t,this.privCommand=e,this.privSessionId=r}get payload(){return this.privPayload}get command(){return this.privCommand}get sessionId(){return this.privSessionId}};Le.ConversationReceivedTranslationEventArgs=sf});var cf=p(_r=>{"use strict";Object.defineProperty(_r,"__esModule",{value:!0});_r.ConversationTranslatorCommandTypes=_r.ConversationTranslatorMessageTypes=_r.InternalParticipants=void 0;var af=class{constructor(e=[],t){this.participants=e,this.meId=t}addOrUpdateParticipant(e){if(e===void 0)return;let t=this.getParticipantIndex(e.id);return t>-1?this.participants.splice(t,1,e):this.participants.push(e),this.getParticipant(e.id)}getParticipantIndex(e){return this.participants.findIndex(t=>t.id===e)}getParticipant(e){return this.participants.find(t=>t.id===e)}deleteParticipant(e){this.participants=this.participants.filter(t=>t.id!==e)}get host(){return this.participants.find(e=>e.isHost===!0)}get me(){return this.getParticipant(this.meId)}};_r.InternalParticipants=af;_r.ConversationTranslatorMessageTypes={command:"command",final:"final",info:"info",instantMessage:"instant_message",keepAlive:"keep_alive",partial:"partial",participantCommand:"participant_command",translatedMessage:"translated_message"};_r.ConversationTranslatorCommandTypes={changeNickname:"ChangeNickname",disconnectSession:"DisconnectSession",ejectParticipant:"EjectParticipant",instant_message:"instant_message",joinSession:"JoinSession",leaveSession:"LeaveSession",participantList:"ParticipantList",roomExpirationWarning:"RoomExpirationWarning",setLockState:"SetLockState",setMute:"SetMute",setMuteAll:"SetMuteAll",setProfanityFiltering:"SetProfanityFiltering",setTranslateToLanguages:"SetTranslateToLanguages",setUseTTS:"SetUseTTS"}});var GP=p(Cu=>{"use strict";Object.defineProperty(Cu,"__esModule",{value:!0});Cu.CommandResponsePayload=void 0;var UT=i=>JSON.parse(i),uf=class i{constructor(e){this.privCommandResponse=UT(e)}get type(){return this.privCommandResponse.type}get command(){return this.privCommandResponse.command}get id(){return this.privCommandResponse.id}get nickname(){return this.privCommandResponse.nickname}get participantId(){return this.privCommandResponse.participantId}get roomid(){return this.privCommandResponse.roomid}get value(){return this.privCommandResponse.value}get token(){return this.privCommandResponse.token}static fromJSON(e){return new i(e)}};Cu.CommandResponsePayload=uf});var $P=p(Ji=>{"use strict";Object.defineProperty(Ji,"__esModule",{value:!0});Ji.ParticipantPayloadResponse=Ji.ParticipantsListPayloadResponse=void 0;var WT=i=>JSON.parse(i),HT=i=>JSON.parse(i),pf=class i{constructor(e){this.privParticipantsPayloadResponse=WT(e)}get roomid(){return this.privParticipantsPayloadResponse.roomid}get id(){return this.privParticipantsPayloadResponse.id}get command(){return this.privParticipantsPayloadResponse.command}get participants(){return this.privParticipantsPayloadResponse.participants}get token(){return this.privParticipantsPayloadResponse.token}get translateTo(){return this.privParticipantsPayloadResponse.translateTo}get profanityFilter(){return this.privParticipantsPayloadResponse.profanityFilter}get roomProfanityFilter(){return this.privParticipantsPayloadResponse.roomProfanityFilter}get roomLocked(){return this.privParticipantsPayloadResponse.roomLocked}get muteAll(){return this.privParticipantsPayloadResponse.muteAll}get type(){return this.privParticipantsPayloadResponse.type}static fromJSON(e){return new i(e)}};Ji.ParticipantsListPayloadResponse=pf;var lf=class i{constructor(e){this.privParticipantPayloadResponse=HT(e)}get nickname(){return this.privParticipantPayloadResponse.nickname}get locale(){return this.privParticipantPayloadResponse.locale}get usetts(){return this.privParticipantPayloadResponse.usetts}get ismuted(){return this.privParticipantPayloadResponse.ismuted}get ishost(){return this.privParticipantPayloadResponse.ishost}get participantId(){return this.privParticipantPayloadResponse.participantId}get avatar(){return this.privParticipantPayloadResponse.avatar}static fromJSON(e){return new i(e)}};Ji.ParticipantPayloadResponse=lf});var QP=p(Gi=>{"use strict";Object.defineProperty(Gi,"__esModule",{value:!0});Gi.TextResponsePayload=Gi.SpeechResponsePayload=void 0;var KT=i=>JSON.parse(i),JT=i=>JSON.parse(i),hf=class i{constructor(e){this.privSpeechResponse=KT(e)}get recognition(){return this.privSpeechResponse.recognition}get translations(){return this.privSpeechResponse.translations}get id(){return this.privSpeechResponse.id}get language(){return this.privSpeechResponse.language}get nickname(){return this.privSpeechResponse.nickname}get participantId(){return this.privSpeechResponse.participantId}get roomid(){return this.privSpeechResponse.roomid}get timestamp(){return this.privSpeechResponse.timestamp}get type(){return this.privSpeechResponse.type}get isFinal(){return this.privSpeechResponse.type==="final"}static fromJSON(e){return new i(e)}};Gi.SpeechResponsePayload=hf;var df=class i{constructor(e){this.privTextResponse=JT(e)}get originalText(){return this.privTextResponse.originalText}get translations(){return this.privTextResponse.translations}get id(){return this.privTextResponse.id}get language(){return this.privTextResponse.language}get nickname(){return this.privTextResponse.nickname}get participantId(){return this.privTextResponse.participantId}get roomid(){return this.privTextResponse.roomid}get timestamp(){return this.privTextResponse.timestamp}get type(){return this.privTextResponse.type}static fromJSON(e){return new i(e)}};Gi.TextResponsePayload=df});var YP=p(ci=>{"use strict";Object.defineProperty(ci,"__esModule",{value:!0});var GT=GP();Object.defineProperty(ci,"CommandResponsePayload",{enumerable:!0,get:function(){return GT.CommandResponsePayload}});var XP=$P();Object.defineProperty(ci,"ParticipantsListPayloadResponse",{enumerable:!0,get:function(){return XP.ParticipantsListPayloadResponse}});Object.defineProperty(ci,"ParticipantPayloadResponse",{enumerable:!0,get:function(){return XP.ParticipantPayloadResponse}});var ZP=QP();Object.defineProperty(ci,"SpeechResponsePayload",{enumerable:!0,get:function(){return ZP.SpeechResponsePayload}});Object.defineProperty(ci,"TextResponsePayload",{enumerable:!0,get:function(){return ZP.TextResponsePayload}})});var rR=p(Pu=>{"use strict";Object.defineProperty(Pu,"__esModule",{value:!0});Pu.ConversationServiceAdapter=void 0;var cs=P(),mt=f(),eR=C(),tR=Jv(),$T=JP(),Ke=of(),Ir=cf(),us=YP(),vf=class extends eR.ServiceRecognizerBase{constructor(e,t,r,n,s){super(e,t,r,n,s),this.privConnectionConfigPromise=void 0,this.privLastPartialUtteranceId="",this.privConversationServiceConnector=s,this.privConversationAuthentication=e,this.receiveMessageOverride=()=>this.receiveConversationMessageOverride(),this.recognizeOverride=()=>this.noOp(),this.postConnectImplOverride=o=>this.conversationConnectImpl(o),this.configConnectionOverride=()=>this.configConnection(),this.disconnectOverride=()=>this.privDisconnect(),this.privConversationRequestSession=new $T.ConversationRequestSession(cs.createNoDashGuid()),this.privConversationConnectionFactory=t,this.privConversationIsDisposed=!1}isDisposed(){return super.isDisposed()||this.privConversationIsDisposed}async dispose(e){this.privConversationIsDisposed=!0,this.privConnectionConfigPromise!==void 0&&await(await this.privConnectionConfigPromise).dispose(e),await super.dispose(e)}async sendMessage(e){return(await this.fetchConnection()).send(new tR.ConversationConnectionMessage(cs.MessageType.Text,e))}async sendMessageAsync(e){await(await this.fetchConnection()).send(new tR.ConversationConnectionMessage(cs.MessageType.Text,e))}privDisconnect(){if(!this.terminateMessageLoop)return this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,mt.CancellationReason.Error,mt.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,Promise.resolve()}async processTypeSpecificMessages(){return!0}cancelRecognition(e,t,r,n,s){this.terminateMessageLoop=!0;let o=new mt.ConversationTranslationCanceledEventArgs(r,s,n,void 0,e);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,o)}catch{}}async conversationConnectImpl(e){return this.privConnectionLoop=this.startMessageLoop(),e}async receiveConversationMessageOverride(){if(this.isDisposed()||this.terminateMessageLoop)return Promise.resolve();let e=new cs.Deferred;try{let r=await(await this.fetchConnection()).read();if(this.isDisposed()||this.terminateMessageLoop)return e.resolve(),Promise.resolve();if(!r)return this.receiveConversationMessageOverride();let n=this.privConversationRequestSession.sessionId,s=r.conversationMessageType.toLowerCase(),o=!1;try{switch(s){case"info":case"participant_command":case"command":let a=us.CommandResponsePayload.fromJSON(r.textBody);switch(a.command.toLowerCase()){case"participantlist":let g=us.ParticipantsListPayloadResponse.fromJSON(r.textBody),M=g.participants.map(F=>({avatar:F.avatar,displayName:F.nickname,id:F.participantId,isHost:F.ishost,isMuted:F.ismuted,isUsingTts:F.usetts,preferredLanguage:F.locale}));this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new Ke.ParticipantsListEventArgs(g.roomid,g.token,g.translateTo,g.profanityFilter,g.roomProfanityFilter,g.roomLocked,g.muteAll,M,n));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new Ke.ParticipantAttributeEventArgs(a.participantId,Ir.ConversationTranslatorCommandTypes.setTranslateToLanguages,a.value,n));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new Ke.ParticipantAttributeEventArgs(a.participantId,Ir.ConversationTranslatorCommandTypes.setProfanityFiltering,a.value,n));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new Ke.ParticipantAttributeEventArgs(a.participantId,Ir.ConversationTranslatorCommandTypes.setMute,a.value,n));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new Ke.MuteAllEventArgs(a.value,n));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new mt.ConversationExpirationEventArgs(a.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new Ke.ParticipantAttributeEventArgs(a.participantId,Ir.ConversationTranslatorCommandTypes.setUseTTS,a.value,n));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new Ke.LockRoomEventArgs(a.value,n));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new Ke.ParticipantAttributeEventArgs(a.participantId,Ir.ConversationTranslatorCommandTypes.changeNickname,a.value,n));break;case"joinsession":let D=us.ParticipantPayloadResponse.fromJSON(r.textBody),oe={avatar:D.avatar,displayName:D.nickname,id:D.participantId,isHost:D.ishost,isMuted:D.ismuted,isUsingTts:D.usetts,preferredLanguage:D.locale};this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new Ke.ParticipantEventArgs(oe,n));break;case"leavesession":let Q={id:a.participantId};this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new Ke.ParticipantEventArgs(Q,n));break;case"disconnectsession":let ee={id:a.participantId};break;case"token":let Ce=new eR.CognitiveTokenAuthentication(()=>{let F=a.token;return Promise.resolve(F)},()=>{let F=a.token;return Promise.resolve(F)});this.authentication=Ce,this.privConversationServiceConnector.onToken(Ce);break;default:break}break;case"partial":case"final":let c=us.SpeechResponsePayload.fromJSON(r.textBody),u=s==="final"?mt.ResultReason.TranslatedParticipantSpeech:mt.ResultReason.TranslatingParticipantSpeech,l=new mt.ConversationTranslationResult(c.participantId,this.getTranslations(c.translations),c.language,c.id,u,c.recognition,void 0,void 0,r.textBody,void 0);c.isFinal?((l.text!==void 0&&l.text.length>0||c.id===this.privLastPartialUtteranceId)&&(o=!0),o&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new Ke.ConversationReceivedTranslationEventArgs(Ir.ConversationTranslatorMessageTypes.final,l,n))):l.text!==void 0&&(this.privLastPartialUtteranceId=c.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new Ke.ConversationReceivedTranslationEventArgs(Ir.ConversationTranslatorMessageTypes.partial,l,n)));break;case"translated_message":let h=us.TextResponsePayload.fromJSON(r.textBody),d=new mt.ConversationTranslationResult(h.participantId,this.getTranslations(h.translations),h.language,void 0,void 0,h.originalText,void 0,void 0,void 0,r.textBody,void 0);this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new Ke.ConversationReceivedTranslationEventArgs(Ir.ConversationTranslatorMessageTypes.instantMessage,d,n));break;default:break}}catch{}return this.receiveConversationMessageOverride()}catch{this.terminateMessageLoop=!0}return e.promise}async startMessageLoop(){if(this.isDisposed())return Promise.resolve();this.terminateMessageLoop=!1;let e=this.receiveConversationMessageOverride();try{return await e}catch(t){return this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",mt.CancellationReason.Error,mt.CancellationErrorCode.RuntimeError,t),null}}configConnection(){return this.isDisposed()?Promise.resolve(void 0):this.privConnectionConfigPromise!==void 0?this.privConnectionConfigPromise.then(e=>e.state()===cs.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()):this.privConnectionConfigPromise,()=>(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection())):this.terminateMessageLoop?Promise.resolve(void 0):(this.privConnectionConfigPromise=this.connectImpl().then(e=>e),this.privConnectionConfigPromise)}getTranslations(e){let t;if(e!==void 0){t=new mt.Translations;for(let r of e)t.set(r.lang,r.translation)}return t}};Pu.ConversationServiceAdapter=vf});var iR=p(Xi=>{"use strict";Object.defineProperty(Xi,"__esModule",{value:!0});Xi.ConversationTranslatorRecognizer=Xi.ConversationRecognizerFactory=void 0;var QT=C(),$i=P(),Qi=_(),ff=f(),XT=KP(),ZT=rR(),gf=class{static fromConfig(e,t,r){return new Ru(e,t,r)}};Xi.ConversationRecognizerFactory=gf;var Ru=class extends ff.Recognizer{constructor(e,t,r){let n=t;Qi.Contracts.throwIfNull(n,"speechConfig");let s=e;Qi.Contracts.throwIfNull(s,"conversationImpl"),super(r,n.properties,new XT.ConversationConnectionFactory),this.privConversation=s,this.privIsDisposed=!1,this.privProperties=n.properties.clone(),this.privConnection=ff.Connection.fromRecognizer(this),this.privProperties.getProperty(ff.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?(this.privSetTimeout=$i.Timeout.setTimeout,this.privClearTimeout=$i.Timeout.clearTimeout):typeof window<"u"?(this.privSetTimeout=window.setTimeout.bind(window),this.privClearTimeout=window.clearTimeout.bind(window)):(this.privSetTimeout=setTimeout,this.privClearTimeout=clearTimeout)}set connected(e){this.privConnection.connected=e}set disconnected(e){this.privConnection.disconnected=e}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get properties(){return this.privProperties}isDisposed(){return this.privIsDisposed}connect(e,t,r){try{Qi.Contracts.throwIfDisposed(this.privIsDisposed),Qi.Contracts.throwIfNullOrWhitespace(e,"token"),this.privReco.conversationTranslatorToken=e,this.resetConversationTimeout(),this.privReco.connectAsync(t,r)}catch(n){if(r)if(n instanceof Error){let s=n;r(s.name+": "+s.message)}else r(n)}}disconnect(e,t){try{Qi.Contracts.throwIfDisposed(this.privIsDisposed),this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privReco.disconnect().then(()=>{e&&e()},r=>{t&&t(r)})}catch(r){if(t)if(r instanceof Error){let n=r;t(n.name+": "+n.message)}else t(r);this.dispose(!0).catch(n=>{$i.Events.instance.onEvent(new $i.BackgroundEvent(n))})}}sendRequest(e,t,r){try{Qi.Contracts.throwIfDisposed(this.privIsDisposed),this.sendMessage(e,t,r)}catch(n){if(r)if(n instanceof Error){let s=n;r(s.name+": "+s.message)}else r(n);this.dispose(!0).catch(s=>{$i.Events.instance.onEvent(new $i.BackgroundEvent(s))})}}onToken(e){this.privConversation.onToken(e)}async close(){this.privIsDisposed||(this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close()),this.privConnection=void 0,await this.dispose(!0))}async dispose(e){this.privIsDisposed||e&&(this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privIsDisposed=!0,this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close(),this.privConnection=void 0),await super.dispose(e))}createRecognizerConfig(e){return new QT.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,r,n){let s=r;return new ZT.ConversationServiceAdapter(e,t,s,n,this)}sendMessage(e,t,r){let n=this.privReco;((o,a,c)=>{o!==void 0?o.then(()=>{try{a&&a()}catch(u){c&&c(`'Unhandled error on promise callback: ${u}'`)}},u=>{try{c&&c(u)}catch{}}):c&&c("Null promise")})(n.sendMessageAsync(e),t,r),this.resetConversationTimeout()}resetConversationTimeout(){this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privTimeoutToken=this.privSetTimeout(()=>{this.sendRequest(this.privConversation.getKeepAlive())},6e4)}};Xi.ConversationTranslatorRecognizer=Ru});var sR=p(_u=>{"use strict";Object.defineProperty(_u,"__esModule",{value:!0});_u.TranscriberRecognizer=void 0;var nR=P(),yt=_(),Zi=f(),Eu=C(),mf=class extends Zi.Recognizer{constructor(e,t){let r=e;yt.Contracts.throwIfNull(r,"speechTranslationConfig");let n=t;yt.Contracts.throwIfNull(n,"audioConfigImpl"),yt.Contracts.throwIfNullOrWhitespace(r.speechRecognitionLanguage,Zi.PropertyId[Zi.PropertyId.SpeechServiceConnection_RecoLanguage]),super(t,r.properties,new Eu.TranscriberConnectionFactory),this.privDisposedRecognizer=!1,this.isMeetingRecognizer=!1}get speechRecognitionLanguage(){return yt.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Zi.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(Zi.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){yt.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Zi.PropertyId.SpeechServiceAuthorization_Token,e)}set conversation(e){yt.Contracts.throwIfNullOrUndefined(e,"Conversation"),this.isMeetingRecognizer=!1,this.privConversation=e}getConversationInfo(){return yt.Contracts.throwIfNullOrUndefined(this.privConversation,"Conversation"),this.privConversation.conversationInfo}set meeting(e){yt.Contracts.throwIfNullOrUndefined(e,"Meeting"),this.isMeetingRecognizer=!0,this.privMeeting=e}getMeetingInfo(){return yt.Contracts.throwIfNullOrUndefined(this.privMeeting,"Meeting"),this.privMeeting.meetingInfo}IsMeetingRecognizer(){return this.isMeetingRecognizer}startContinuousRecognitionAsync(e,t){nR.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(Eu.RecognitionMode.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){nR.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),e,t)}async close(){this.privDisposedRecognizer||await this.dispose(!0)}async pushConversationEvent(e,t){let r=this.privReco;yt.Contracts.throwIfNullOrUndefined(r,"serviceRecognizer"),await r.sendSpeechEventAsync(e,t)}async pushMeetingEvent(e,t){let r=this.privReco;yt.Contracts.throwIfNullOrUndefined(r,"serviceRecognizer"),await r.sendMeetingSpeechEventAsync(e,t)}async enforceAudioGating(){let r=(await this.audioConfig.format).channels;if(r===1){if(this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()!=="true")throw new Error("Single channel audio configuration for MeetingTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details")}else if(r!==8)throw new Error(`Unsupported audio configuration: Detected ${r}-channel audio`)}connectMeetingCallbacks(e){this.isMeetingRecognizer=!0,this.canceled=(t,r)=>{e.canceled&&e.canceled(e,r)},this.recognizing=(t,r)=>{e.transcribing&&e.transcribing(e,r)},this.recognized=(t,r)=>{e.transcribed&&e.transcribed(e,r)},this.sessionStarted=(t,r)=>{e.sessionStarted&&e.sessionStarted(e,r)},this.sessionStopped=(t,r)=>{e.sessionStopped&&e.sessionStopped(e,r)}}disconnectCallbacks(){this.canceled=void 0,this.recognizing=void 0,this.recognized=void 0,this.sessionStarted=void 0,this.sessionStopped=void 0}async dispose(e){this.privDisposedRecognizer||(e&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(e))}createRecognizerConfig(e){return new Eu.RecognizerConfig(e,this.properties)}createServiceRecognizer(e,t,r,n){let s=r;return new Eu.TranscriptionServiceRecognizer(e,t,s,n,this)}};_u.TranscriberRecognizer=mf});var oR=p(De=>{"use strict";Object.defineProperty(De,"__esModule",{value:!0});var YT=VP();Object.defineProperty(De,"ConversationManager",{enumerable:!0,get:function(){return YT.ConversationManager}});var eO=du();Object.defineProperty(De,"ConversationConnectionConfig",{enumerable:!0,get:function(){return eO.ConversationConnectionConfig}});var tO=iR();Object.defineProperty(De,"ConversationRecognizerFactory",{enumerable:!0,get:function(){return tO.ConversationRecognizerFactory}});var rO=sR();Object.defineProperty(De,"TranscriberRecognizer",{enumerable:!0,get:function(){return rO.TranscriberRecognizer}});var Yi=of();Object.defineProperty(De,"ConversationReceivedTranslationEventArgs",{enumerable:!0,get:function(){return Yi.ConversationReceivedTranslationEventArgs}});Object.defineProperty(De,"LockRoomEventArgs",{enumerable:!0,get:function(){return Yi.LockRoomEventArgs}});Object.defineProperty(De,"MuteAllEventArgs",{enumerable:!0,get:function(){return Yi.MuteAllEventArgs}});Object.defineProperty(De,"ParticipantAttributeEventArgs",{enumerable:!0,get:function(){return Yi.ParticipantAttributeEventArgs}});Object.defineProperty(De,"ParticipantEventArgs",{enumerable:!0,get:function(){return Yi.ParticipantEventArgs}});Object.defineProperty(De,"ParticipantsListEventArgs",{enumerable:!0,get:function(){return Yi.ParticipantsListEventArgs}});var yf=cf();Object.defineProperty(De,"ConversationTranslatorCommandTypes",{enumerable:!0,get:function(){return yf.ConversationTranslatorCommandTypes}});Object.defineProperty(De,"ConversationTranslatorMessageTypes",{enumerable:!0,get:function(){return yf.ConversationTranslatorMessageTypes}});Object.defineProperty(De,"InternalParticipants",{enumerable:!0,get:function(){return yf.InternalParticipants}})});var Cf=p(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.SynthesisAudioMetadata=ui.MetadataType=void 0;var iO;(function(i){i.WordBoundary="WordBoundary",i.Bookmark="Bookmark",i.Viseme="Viseme",i.SentenceBoundary="SentenceBoundary",i.SessionEnd="SessionEnd",i.AvatarSignal="TalkingAvatarSignal"})(iO=ui.MetadataType||(ui.MetadataType={}));var Sf=class i{constructor(e){this.privSynthesisAudioMetadata=JSON.parse(e)}static fromJSON(e){return new i(e)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}};ui.SynthesisAudioMetadata=Sf});var cR=p(Nt=>{"use strict";Object.defineProperty(Nt,"__esModule",{value:!0});Nt.SynthesisStartedEvent=Nt.ConnectingToSynthesisServiceEvent=Nt.SynthesisTriggeredEvent=Nt.SpeechSynthesisEvent=void 0;var aR=P(),en=class extends aR.PlatformEvent{constructor(e,t,r=aR.EventType.Info){super(e,r),this.privRequestId=t}get requestId(){return this.privRequestId}};Nt.SpeechSynthesisEvent=en;var Pf=class extends en{constructor(e,t,r){super("SynthesisTriggeredEvent",e),this.privSessionAudioDestinationId=t,this.privTurnAudioDestinationId=r}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}};Nt.SynthesisTriggeredEvent=Pf;var Rf=class extends en{constructor(e,t){super("ConnectingToSynthesisServiceEvent",e),this.privAuthFetchEventId=t}get authFetchEventId(){return this.privAuthFetchEventId}};Nt.ConnectingToSynthesisServiceEvent=Rf;var Ef=class extends en{constructor(e,t){super("SynthesisStartedEvent",e),this.privAuthFetchEventId=t}get authFetchEventId(){return this.privAuthFetchEventId}};Nt.SynthesisStartedEvent=Ef});var uR=p(bu=>{"use strict";Object.defineProperty(bu,"__esModule",{value:!0});bu.SynthesisTurn=void 0;var Iu=P(),nO=Lr(),wu=f(),sO=Cf(),_f=cR(),If=class i{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=Iu.createNoDashGuid(),this.privTurnDeferral=new Iu.Deferred,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(e){this.privStreamId=e}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(e){this.privAudioOutputFormat=e}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}get extraProperties(){if(this.privWebRTCSDP){let e=new wu.PropertyCollection;return e.setProperty(wu.PropertyId.TalkingAvatarService_WebRTC_SDP,this.privWebRTCSDP),e}}async getAllReceivedAudio(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(await this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null}async getAllReceivedAudioWithHeader(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){let e=await this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=this.audioOutputFormat.addHeader(e),this.privReceivedAudioWithHeader}else return this.getAllReceivedAudio()}startNewSynthesis(e,t,r,n){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=e,this.privRawText=t,this.privIsSSML=r,this.privAudioOutputStream=new nO.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",this.privWebRTCSDP="",n!==void 0&&(this.privTurnAudioDestination=n,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new _f.SynthesisTriggeredEvent(this.requestId,void 0,n===void 0?void 0:n.id()))}onPreConnectionStart(e){this.privAuthFetchEventId=e,this.onEvent(new _f.ConnectingToSynthesisServiceEvent(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(e){e&&this.onComplete()}onConnectionEstablishCompleted(e){if(e===200){this.onEvent(new _f.SynthesisStartedEvent(this.requestId,this.privAuthFetchEventId)),this.privBytesReceived=0;return}else e===403&&this.onComplete()}onServiceResponseMessage(e){let t=JSON.parse(e);this.streamId=t.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(e){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new Iu.Deferred;let t=JSON.parse(e);t.webrtc&&(this.privWebRTCSDP=t.webrtc.connectionString)}onAudioChunkReceived(e){this.isSynthesizing&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength,this.privTurnAudioDestination!==void 0&&this.privTurnAudioDestination.write(e))}onTextBoundaryEvent(e){this.updateTextOffset(e.Data.text.Text,e.Type)}onVisemeMetadataReceived(e){e.Data.AnimationChunk!==void 0&&(this.privPartialVisemeAnimation+=e.Data.AnimationChunk)}onSessionEnd(e){this.privAudioDuration=e.Data.Offset}async constructSynthesisResult(){let e=await this.getAllReceivedAudioWithHeader();return new wu.SpeechSynthesisResult(this.requestId,wu.ResultReason.SynthesizingAudioCompleted,e,void 0,this.extraProperties,this.audioDuration)}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){let e=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",e}onEvent(e){Iu.Events.instance.onEvent(e)}static isXmlTag(e){return e.length>=2&&e[0]==="<"&&e[e.length-1]===">"}updateTextOffset(e,t){t===sO.MetadataType.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(e,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+e.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!i.isXmlTag(e)&&this.updateTextOffset(e,t))):(this.privSentenceOffset=this.privRawText.indexOf(e,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+e.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!i.isXmlTag(e)&&this.updateTextOffset(e,t)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,this.privTurnAudioDestination!==void 0&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}async readAllAudioFromStream(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{await this.privAudioOutputStream.read(this.privReceivedAudio)}catch{this.privReceivedAudio=new ArrayBuffer(0)}}}withinXmlTag(e){return this.privRawText.indexOf("<",e+1)>this.privRawText.indexOf(">",e+1)}};bu.SynthesisTurn=If});var pR=p(Tu=>{"use strict";Object.defineProperty(Tu,"__esModule",{value:!0});Tu.SynthesisAdapterBase=void 0;var Te=P(),Je=f(),ot=C(),tn=ii(),Au=class{constructor(e,t,r,n){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!e)throw new Te.ArgumentNullError("authentication");if(!t)throw new Te.ArgumentNullError("connectionFactory");if(!r)throw new Te.ArgumentNullError("synthesizerConfig");this.privAuthentication=e,this.privConnectionFactory=t,this.privSynthesizerConfig=r,this.privIsDisposed=!1,this.privSessionAudioDestination=n,this.privSynthesisTurn=new ot.SynthesisTurn,this.privConnectionEvents=new Te.EventSource,this.privServiceEvents=new Te.EventSource,this.privSynthesisContext=new ot.SynthesisContext,this.privAgentConfig=new ot.AgentConfig,this.connectionEvents.attach(s=>{if(s.name==="ConnectionClosedEvent"){let o=s;o.statusCode!==1e3&&this.cancelSynthesisLocal(Je.CancellationReason.Error,o.statusCode===1007?Je.CancellationErrorCode.BadRequestParameters:Je.CancellationErrorCode.ConnectionFailure,`${o.reason} websocket error code: ${o.statusCode}`)}})}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(e){this.privAudioOutputFormat=e,this.privSynthesisTurn.audioOutputFormat=e,this.privSessionAudioDestination!==void 0&&(this.privSessionAudioDestination.format=e),this.synthesisContext!==void 0&&(this.synthesisContext.audioOutputFormat=e)}isDisposed(){return this.privIsDisposed}async dispose(e){this.privIsDisposed=!0,this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.close(),this.privConnectionConfigurationPromise!==void 0&&await(await this.privConnectionConfigurationPromise).dispose(e)}async connect(){await this.connectImpl()}async sendNetworkMessage(e,t){let r=typeof t=="string"?Te.MessageType.Text:Te.MessageType.Binary,n=typeof t=="string"?"application/json":"";return(await this.fetchConnection()).send(new tn.SpeechConnectionMessage(r,e,this.privSynthesisTurn.requestId,n,t))}async Speak(e,t,r,n,s,o){let a;if(t?a=e:a=this.privSynthesizer.buildSsml(e),this.speakOverride!==void 0)return this.speakOverride(a,r,n,s);this.privSuccessCallback=n,this.privErrorCallback=s,this.privSynthesisTurn.startNewSynthesis(r,e,t,o);try{await this.connectImpl();let c=await this.fetchConnection();await this.sendSynthesisContext(c),await this.sendSsmlMessage(c,a,r),this.onSynthesisStarted(r),this.receiveMessage()}catch(c){return this.cancelSynthesisLocal(Je.CancellationReason.Error,Je.CancellationErrorCode.ConnectionFailure,c),Promise.reject(c)}}async stopSpeaking(){return await this.connectImpl(),(await this.fetchConnection()).send(new tn.SpeechConnectionMessage(Te.MessageType.Text,"synthesis.control",this.privSynthesisTurn.requestId,"application/json",JSON.stringify({action:"stop"})))}cancelSynthesis(e,t,r,n){let s=new Je.PropertyCollection;s.setProperty(ot.CancellationErrorCodePropertyName,Je.CancellationErrorCode[r]);let o=new Je.SpeechSynthesisResult(e,Je.ResultReason.Canceled,void 0,n,s);if(this.onSynthesisCancelled(o),this.privSuccessCallback)try{this.privSuccessCallback(o)}catch{}}cancelSynthesisLocal(e,t,r){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,e,t,r))}processTypeSpecificMessages(e){return!0}async receiveMessage(){try{let t=await(await this.fetchConnection()).read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!t)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;let r=tn.SpeechConnectionMessage.fromConnectionMessage(t);if(r.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(r.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse(r.textBody);break;case"response":this.privSynthesisTurn.onServiceResponseMessage(r.textBody);break;case"audio":this.privSynthesisTurn.streamId.toLowerCase()===r.streamId.toLowerCase()&&r.binaryBody&&(this.privSynthesisTurn.onAudioChunkReceived(r.binaryBody),this.onSynthesizing(r.binaryBody),this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.write(r.binaryBody));break;case"audio.metadata":let n=ot.SynthesisAudioMetadata.fromJSON(r.textBody).Metadata;for(let o of n)switch(o.Type){case ot.MetadataType.WordBoundary:case ot.MetadataType.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(o);let a=new Je.SpeechSynthesisWordBoundaryEventArgs(o.Data.Offset,o.Data.Duration,o.Data.text.Text,o.Data.text.Length,o.Type===ot.MetadataType.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,o.Data.text.BoundaryType);this.onWordBoundary(a);break;case ot.MetadataType.Bookmark:let c=new Je.SpeechSynthesisBookmarkEventArgs(o.Data.Offset,o.Data.Bookmark);this.onBookmarkReached(c);break;case ot.MetadataType.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(o),o.Data.IsLastAnimation){let u=new Je.SpeechSynthesisVisemeEventArgs(o.Data.Offset,o.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());this.onVisemeReceived(u)}break;case ot.MetadataType.AvatarSignal:this.onAvatarEvent(o);break;case ot.MetadataType.SessionEnd:this.privSynthesisTurn.onSessionEnd(o);break}break;case"turn.end":this.privSynthesisTurn.onServiceTurnEndResponse();let s;try{s=await this.privSynthesisTurn.constructSynthesisResult(),this.privSuccessCallback&&this.privSuccessCallback(s)}catch(o){this.privErrorCallback&&this.privErrorCallback(o)}this.onSynthesisCompleted(s);break;default:this.processTypeSpecificMessages(r)||this.privServiceEvents&&this.serviceEvents.onEvent(new Te.ServiceEvent(r.path.toLowerCase(),r.textBody))}return this.receiveMessage()}catch{}}sendSynthesisContext(e){this.setSynthesisContextSynthesisSection();let t=this.synthesisContext.toJSON();if(t)return e.send(new tn.SpeechConnectionMessage(Te.MessageType.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",t))}setSpeechConfigSynthesisSection(){}connectImpl(e=!1){if(this.privConnectionPromise!=null)return this.privConnectionPromise.then(r=>r.state()===Te.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()));this.privAuthFetchEventId=Te.createNoDashGuid(),this.privConnectionId=Te.createNoDashGuid(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);let t=e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=t.then(async r=>{this.privSynthesisTurn.onAuthCompleted(!1);let n=this.privConnectionFactory.create(this.privSynthesizerConfig,r,this.privConnectionId);n.events.attach(o=>{this.connectionEvents.onEvent(o)});let s=await n.open();return s.statusCode===200?(this.privSynthesisTurn.onConnectionEstablishCompleted(s.statusCode),Promise.resolve(n)):s.statusCode===403&&!e?this.connectImpl(!0):(this.privSynthesisTurn.onConnectionEstablishCompleted(s.statusCode),Promise.reject(`Unable to contact server. StatusCode: ${s.statusCode},
                    ${this.privSynthesizerConfig.parameters.getProperty(Je.PropertyId.SpeechServiceConnection_Url)} Reason: ${s.reason}`))},r=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(r)}),this.privConnectionPromise.catch(()=>{}),this.privConnectionPromise}sendSpeechServiceConfig(e,t){if(t)return e.send(new tn.SpeechConnectionMessage(Te.MessageType.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",t))}sendSsmlMessage(e,t,r){return e.send(new tn.SpeechConnectionMessage(Te.MessageType.Text,"ssml",r,"application/ssml+xml",t))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(e=>e.state()===Te.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async configureConnection(){let e=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(e):(this.setSpeechConfigSynthesisSection(),await this.sendSpeechServiceConfig(e,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),e)}onAvatarEvent(e){}onSynthesisStarted(e){}onSynthesizing(e){}onSynthesisCancelled(e){}onSynthesisCompleted(e){}onWordBoundary(e){}onVisemeReceived(e){}onBookmarkReached(e){}};Tu.SynthesisAdapterBase=Au;Au.telemetryDataEnabled=!0});var hR=p(Ou=>{"use strict";Object.defineProperty(Ou,"__esModule",{value:!0});Ou.AvatarSynthesisAdapter=void 0;var lR=f(),oO=C(),wf=class extends oO.SynthesisAdapterBase{constructor(e,t,r,n,s){super(e,t,r,void 0),this.privAvatarSynthesizer=n,this.privSynthesizer=n,this.privAvatarConfig=s}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(void 0)}setSpeechConfigSynthesisSection(){this.privSynthesizerConfig.synthesisVideoSection={format:{bitrate:this.privAvatarConfig.videoFormat?.bitrate,codec:this.privAvatarConfig.videoFormat?.codec,crop:{bottomRight:{x:this.privAvatarConfig.videoFormat?.cropRange?.bottomRight?.x,y:this.privAvatarConfig.videoFormat?.cropRange?.bottomRight?.y},topLeft:{x:this.privAvatarConfig.videoFormat?.cropRange?.topLeft?.x,y:this.privAvatarConfig.videoFormat?.cropRange?.topLeft?.y}},resolution:{height:this.privAvatarConfig.videoFormat?.height,width:this.privAvatarConfig.videoFormat?.width}},protocol:{name:"WebRTC",webrtcConfig:{clientDescription:btoa(this.privSynthesizerConfig.parameters.getProperty(lR.PropertyId.TalkingAvatarService_WebRTC_SDP)),iceServers:this.privAvatarSynthesizer.iceServers}},talkingAvatar:{background:{color:this.privAvatarConfig.backgroundColor},character:this.privAvatarConfig.character,customized:this.privAvatarConfig.customized,style:this.privAvatarConfig.style}}}onAvatarEvent(e){if(this.privAvatarSynthesizer.avatarEventReceived){let t=new lR.AvatarEventArgs(e.Data.Offset,e.Data.Name);try{this.privAvatarSynthesizer.avatarEventReceived(this.privAvatarSynthesizer,t)}catch{}}}};Ou.AvatarSynthesisAdapter=wf});var dR=p(ku=>{"use strict";Object.defineProperty(ku,"__esModule",{value:!0});ku.SpeechSynthesisAdapter=void 0;var wr=f(),aO=C(),bf=class extends aO.SynthesisAdapterBase{constructor(e,t,r,n,s){super(e,t,r,s),this.privSpeechSynthesizer=n,this.privSynthesizer=n}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(this.privSpeechSynthesizer)}onSynthesisStarted(e){let t=new wr.SpeechSynthesisEventArgs(new wr.SpeechSynthesisResult(e,wr.ResultReason.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,t)}onSynthesizing(e){if(this.privSpeechSynthesizer.synthesizing)try{let t=this.privSynthesisTurn.audioOutputFormat.addHeader(e),r=new wr.SpeechSynthesisEventArgs(new wr.SpeechSynthesisResult(this.privSynthesisTurn.requestId,wr.ResultReason.SynthesizingAudio,t));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,r)}catch{}}onSynthesisCancelled(e){if(this.privSpeechSynthesizer.SynthesisCanceled){let t=new wr.SpeechSynthesisEventArgs(e);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,t)}catch{}}}onSynthesisCompleted(e){if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new wr.SpeechSynthesisEventArgs(e))}catch{}}onWordBoundary(e){if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,e)}catch{}}onVisemeReceived(e){if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,e)}catch{}}onBookmarkReached(e){if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,e)}catch{}}};ku.SpeechSynthesisAdapter=bf});var vR=p(Mu=>{"use strict";Object.defineProperty(Mu,"__esModule",{value:!0});Mu.SynthesisRestAdapter=void 0;var Af=ce(),Tf=f(),cO=Ze(),uO=Ie(),Of=class{constructor(e,t){let r=e.parameters.getProperty(Tf.PropertyId.SpeechServiceConnection_Endpoint,void 0);if(!r){let s=e.parameters.getProperty(Tf.PropertyId.SpeechServiceConnection_Region,"westus"),o=cO.ConnectionFactoryBase.getHostSuffix(s);r=e.parameters.getProperty(Tf.PropertyId.SpeechServiceConnection_Host,`https://${s}.tts.speech${o}`)}this.privUri=`${r}/cognitiveservices/voices/list`;let n=Af.RestConfigBase.requestOptions;this.privRestAdapter=new Af.RestMessageAdapter(n),this.privAuthentication=t}getVoicesList(e){return this.privRestAdapter.setHeaders(uO.HeaderNames.ConnectionId,e),this.privAuthentication.fetch(e).then(t=>(this.privRestAdapter.setHeaders(t.headerName,t.token),this.privRestAdapter.request(Af.RestRequestType.Get,this.privUri)))}};Mu.SynthesisRestAdapter=Of});var mR=p(pi=>{"use strict";Object.defineProperty(pi,"__esModule",{value:!0});pi.SynthesizerConfig=pi.SynthesisServiceType=void 0;var fR=C(),gR;(function(i){i[i.Standard=0]="Standard",i[i.Custom=1]="Custom"})(gR=pi.SynthesisServiceType||(pi.SynthesisServiceType={}));var kf=class{constructor(e,t){this.privSynthesisServiceType=gR.Standard,this.avatarEnabled=!1,this.privSpeechServiceConfig=e||new fR.SpeechServiceConfig(new fR.Context(null)),this.privParameters=t}get parameters(){return this.privParameters}get synthesisServiceType(){return this.privSynthesisServiceType}set synthesisServiceType(e){this.privSynthesisServiceType=e}set synthesisVideoSection(e){this.privSpeechServiceConfig.Context.synthesis={video:e}}get SpeechServiceConfig(){return this.privSpeechServiceConfig}};pi.SynthesizerConfig=kf});var yR=p(Du=>{"use strict";Object.defineProperty(Du,"__esModule",{value:!0});Du.SynthesisContext=void 0;var Mf=f(),Df=class{constructor(){this.privContext={}}setSection(e,t){this.privContext[e]=t}set audioOutputFormat(e){this.privAudioOutputFormat=e}toJSON(){return JSON.stringify(this.privContext)}setSynthesisSection(e){let t=this.buildSynthesisContext(e);this.setSection("synthesis",t)}buildSynthesisContext(e){return{audio:{metadataOptions:{bookmarkEnabled:!!e?.bookmarkReached,punctuationBoundaryEnabled:e?.properties.getProperty(Mf.PropertyId.SpeechServiceResponse_RequestPunctuationBoundary,!!e?.wordBoundary),sentenceBoundaryEnabled:e?.properties.getProperty(Mf.PropertyId.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!e?.visemeReceived,wordBoundaryEnabled:e?.properties.getProperty(Mf.PropertyId.SpeechServiceResponse_RequestWordBoundary,!!e?.wordBoundary)},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:e?.autoDetectSourceLanguage}}}};Du.SynthesisContext=Df});var SR=p(xu=>{"use strict";Object.defineProperty(xu,"__esModule",{value:!0});xu.SpeakerRecognitionConfig=void 0;var pO=C(),xf=class{constructor(e,t){this.privContext=e||new pO.Context(null),this.privParameters=t}get parameters(){return this.privParameters}get Context(){return this.privContext}};xu.SpeakerRecognitionConfig=xf});var PR=p(qu=>{"use strict";Object.defineProperty(qu,"__esModule",{value:!0});qu.SpeakerServiceRecognizer=void 0;var lO=ce(),Nu=P(),Se=f(),CR=C(),hO=ii(),Nf=class extends CR.ServiceRecognizerBase{constructor(e,t,r,n,s){super(e,t,r,n,s),this.privSpeakerRecognizer=s,this.privSpeakerAudioSource=r,this.recognizeSpeaker=o=>this.recognizeSpeakerOnce(o),this.sendPrePayloadJSONOverride=()=>this.noOp()}processTypeSpecificMessages(e){let t=!1,r=new Se.PropertyCollection;switch(e.messageType===Nu.MessageType.Text&&r.setProperty(Se.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speaker.response":let s=JSON.parse(e.textBody),o;s.status.statusCode.toLowerCase()!=="success"?o=new Se.SpeakerRecognitionResult(s,Se.ResultReason.Canceled,Se.CancellationErrorCode.ServiceError,s.status.reason):o=new Se.SpeakerRecognitionResult(s,Se.ResultReason.RecognizedSpeaker),this.privResultDeferral&&this.privResultDeferral.resolve(o),t=!0;break;default:break}let n=new Nu.Deferred;return n.resolve(t),n.promise}cancelRecognition(e,t,r,n,s){if(new Se.PropertyCollection().setProperty(CR.CancellationErrorCodePropertyName,Se.CancellationErrorCode[n]),this.privResultDeferral){let a=new Se.SpeakerRecognitionResult({scenario:this.privSpeakerModel.scenario,status:{statusCode:s,reason:s}},Se.ResultReason.Canceled,n,s);try{this.privResultDeferral.resolve(a)}catch(c){this.privResultDeferral.reject(c)}}}async recognizeSpeakerOnce(e){this.privSpeakerModel=e,this.voiceProfileType=e.scenario,this.privResultDeferral||(this.privResultDeferral=new Nu.Deferred),this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(Se.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);let t=this.connectImpl(),r=this.sendPreAudioMessages(this.extractSpeakerContext(e)),n=await this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),s=await this.privSpeakerAudioSource.format,o=await this.privSpeakerAudioSource.deviceInfo,a=new lO.ReplayableAudioNode(n,s.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(a,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:o};try{await t,await r}catch(l){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Se.CancellationReason.Error,Se.CancellationErrorCode.ConnectionFailure,l)}let c=new Se.SessionEventArgs(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,c),this.receiveMessage(),this.sendAudio(a).then(()=>{},l=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Se.CancellationReason.Error,Se.CancellationErrorCode.RuntimeError,l)}),this.privResultDeferral.promise}async sendPreAudioMessages(e){let t=await this.fetchConnection();await this.sendSpeakerRecognition(t,e)}async sendSpeakerRecognition(e,t){let r=JSON.stringify(t);return e.send(new hO.SpeechConnectionMessage(Nu.MessageType.Text,"speaker.context",this.privRequestSession.requestId,"application/json; charset=utf-8",r))}extractSpeakerContext(e){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:e.profileIds,scenario:e.scenario}}};qu.SpeakerServiceRecognizer=Nf});var ER=p(ju=>{"use strict";Object.defineProperty(ju,"__esModule",{value:!0});ju.VoiceServiceRecognizer=void 0;var dO=ce(),qt=P(),L=f(),RR=C(),qf=ii(),jf=class extends RR.ServiceRecognizerBase{constructor(e,t,r,n,s){super(e,t,r,n,s),this.privDeferralMap=new qt.DeferralMap,this.privSpeakerAudioSource=r,this.sendPrePayloadJSONOverride=()=>this.noOp()}set SpeakerAudioSource(e){this.privSpeakerAudioSource=e}processTypeSpecificMessages(e){let t=!1,r=new L.PropertyCollection;switch(e.messageType===qt.MessageType.Text&&r.setProperty(L.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speaker.profiles":let s=JSON.parse(e.textBody);switch(s.operation.toLowerCase()){case"create":this.handleCreateResponse(s,e.requestId);break;case"delete":case"reset":this.handleResultResponse(s,e.requestId);break;case"fetch":let u=JSON.parse(e.textBody);this.handleFetchResponse(u,e.requestId);break;default:break}t=!0;break;case"speaker.phrases":let o=JSON.parse(e.textBody);this.handlePhrasesResponse(o,e.requestId),t=!0;break;case"speaker.profile.enrollment":let a=JSON.parse(e.textBody),c=new L.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(a.enrollment?a.enrollment.enrollmentStatus:a.status.statusCode),a.enrollment?JSON.stringify(a.enrollment):void 0,a.status.reason);this.privDeferralMap.getId(e.requestId)&&this.privDeferralMap.complete(e.requestId,c),this.privRequestSession.onSpeechEnded(),t=!0;break;default:break}let n=new qt.Deferred;return n.resolve(t),n.promise}cancelRecognition(e,t,r,n,s){new L.PropertyCollection().setProperty(RR.CancellationErrorCodePropertyName,L.CancellationErrorCode[n]);let a=new L.VoiceProfileEnrollmentResult(L.ResultReason.Canceled,s,s);this.privDeferralMap.getId(t)&&this.privDeferralMap.complete(t,a)}async createProfile(e,t){this.voiceProfileType=e.toString();let r=this.connectImpl();try{let n=new qt.Deferred;return await r,await this.sendCreateProfile(n,e,t),this.receiveMessage(),n.promise}catch(n){throw n}}async resetProfile(e){return this.voiceProfileType=e.profileType.toString(),this.sendCommonRequest("reset",e.profileType,e)}async deleteProfile(e){return this.voiceProfileType=e.profileType.toString(),this.sendCommonRequest("delete",e.profileType,e)}async retrieveEnrollmentResult(e){return this.voiceProfileType=e.profileType.toString(),this.privExpectedProfileId=e.profileId,this.sendCommonRequest("fetch",e.profileType,e)}async getAllProfiles(e){return this.voiceProfileType=e.toString(),this.sendCommonRequest("fetch",e)}async getActivationPhrases(e,t){this.voiceProfileType=e.toString();let r=this.connectImpl();try{let n=new qt.Deferred;return await r,await this.sendPhrasesRequest(n,e,t),this.receiveMessage(),n.promise}catch(n){throw n}}async enrollProfile(e){this.voiceProfileType=e.profileType.toString();let t=new qt.Deferred;this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(L.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);let r=this.connectImpl(),n=this.sendPreAudioMessages(e,t),s=await this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),o=await this.privSpeakerAudioSource.format,a=await this.privSpeakerAudioSource.deviceInfo,c=new dO.ReplayableAudioNode(s,o.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(c,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:a};try{await r,await n}catch(h){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,L.CancellationReason.Error,L.CancellationErrorCode.ConnectionFailure,h)}let u=new L.SessionEventArgs(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,u),this.receiveMessage(),this.sendAudio(c).then(()=>{},h=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,L.CancellationReason.Error,L.CancellationErrorCode.RuntimeError,h)}),t.promise}async sendPreAudioMessages(e,t){let r=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,t),await this.sendBaseRequest(r,"enroll",this.scenarioFrom(e.profileType),e)}async sendPhrasesRequest(e,t,r){let n=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,e);let s=this.scenarioFrom(t),o={locale:r,scenario:s};return n.send(new qf.SpeechConnectionMessage(qt.MessageType.Text,"speaker.profile.phrases",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(o)))}async sendCreateProfile(e,t,r){let n=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,e);let s=t===L.VoiceProfileType.TextIndependentIdentification?"TextIndependentIdentification":t===L.VoiceProfileType.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification",o={locale:r,number:"1",scenario:s};return n.send(new qf.SpeechConnectionMessage(qt.MessageType.Text,"speaker.profile.create",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(o)))}async sendCommonRequest(e,t,r=void 0){let n=this.connectImpl();try{let s=new qt.Deferred;this.privRequestSession.onSpeechContext(),await n;let o=await this.fetchConnection();return this.privDeferralMap.add(this.privRequestSession.requestId,s),await this.sendBaseRequest(o,e,this.scenarioFrom(t),r),this.receiveMessage(),s.promise}catch(s){throw s}}async sendBaseRequest(e,t,r,n){let s={scenario:r};return n?s.profileIds=[n.profileId]:s.maxPageSize=-1,e.send(new qf.SpeechConnectionMessage(qt.MessageType.Text,`speaker.profile.${t}`,this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(s)))}extractSpeakerContext(e){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:e.profileIds,scenario:e.scenario}}handlePhrasesResponse(e,t){if(this.privDeferralMap.getId(t))if(e.status.statusCode.toLowerCase()!=="success"){let r=L.ResultReason.Canceled,n=new L.VoiceProfilePhraseResult(r,e.status.statusCode,e.passPhraseType,[]);this.privDeferralMap.complete(t,n)}else if(e.phrases&&e.phrases.length>0){let r=L.ResultReason.EnrollingVoiceProfile,n=new L.VoiceProfilePhraseResult(r,e.status.statusCode,e.passPhraseType,e.phrases);this.privDeferralMap.complete(t,n)}else throw new Error("Voice Profile get activation phrases failed, no phrases received");else throw new Error(`Voice Profile get activation phrases request for requestID ${t} not found`)}handleCreateResponse(e,t){if(e.profiles&&e.profiles.length>0)if(this.privDeferralMap.getId(t)){let r=e.profiles.map(n=>n.profileId);this.privDeferralMap.complete(t,r)}else throw new Error(`Voice Profile create request for requestID ${t} not found`);else throw new Error("Voice Profile create failed, no profile id received")}handleResultResponse(e,t){if(this.privDeferralMap.getId(t)){let r=e.operation.toLowerCase()==="delete"?L.ResultReason.DeletedVoiceProfile:L.ResultReason.ResetVoiceProfile,n=e.status.statusCode.toLowerCase()==="success"?r:L.ResultReason.Canceled,s=new L.VoiceProfileResult(n,`statusCode: ${e.status.statusCode}, errorDetails: ${e.status.reason}`);this.privDeferralMap.complete(t,s)}else throw new Error(`Voice Profile create request for requestID ${t} not found`)}handleFetchResponse(e,t){if(this.privDeferralMap.getId(t)&&e.profiles[0]){if(this.privExpectedProfileId&&e.profiles.length===1&&e.profiles[0].profileId===this.privExpectedProfileId){this.privExpectedProfileId=void 0;let r=e.profiles[0],n=new L.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(r.enrollmentStatus),JSON.stringify(r),e.status.reason);this.privDeferralMap.complete(t,n)}else if(e.profiles.length>0){let r=e.profiles,n=[];for(let s of r)n.push(new L.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(s.enrollmentStatus),JSON.stringify(s),e.status.reason));this.privDeferralMap.complete(t,n)}}else throw new Error(`Voice Profile fetch request for requestID ${t} not found`)}enrollmentReasonFrom(e){switch(e.toLowerCase()){case"enrolled":return L.ResultReason.EnrolledVoiceProfile;case"invalidlocale":case"invalidphrase":case"invalidaudioformat":case"invalidscenario":case"invalidprofilecount":case"invalidoperation":case"audiotooshort":case"audiotoolong":case"toomanyenrollments":case"storageconflict":case"profilenotfound":case"incompatibleprofiles":case"incompleteenrollment":return L.ResultReason.Canceled;default:return L.ResultReason.EnrollingVoiceProfile}}scenarioFrom(e){return e===L.VoiceProfileType.TextIndependentIdentification?"TextIndependentIdentification":e===L.VoiceProfileType.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification"}};ju.VoiceServiceRecognizer=jf});var _R=p(pe=>{"use strict";Object.defineProperty(pe,"__esModule",{value:!0});pe.type=pe.connectivity=pe.Device=pe.OS=pe.System=pe.Context=pe.SpeechServiceConfig=void 0;var zf=class{constructor(e){this.context=e}serialize(){return JSON.stringify(this,(e,t)=>{if(t&&typeof t=="object"&&!Array.isArray(t)){let r={};for(let n in t)Object.hasOwnProperty.call(t,n)&&(r[n&&n.charAt(0).toLowerCase()+n.substring(1)]=t[n]);return r}return t})}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(e){this.recognition=e.toLowerCase()}};pe.SpeechServiceConfig=zf;var Lf=class{constructor(e){this.system=new zu,this.os=e}};pe.Context=Lf;var zu=class{constructor(){let e="1.36.0";this.name="SpeechSDK",this.version=e,this.build="JavaScript",this.lang="JavaScript"}};pe.System=zu;var Bf=class{constructor(e,t,r){this.platform=e,this.name=t,this.version=r}};pe.OS=Bf;var Ff=class{constructor(e,t,r){this.manufacturer=e,this.model=t,this.version=r}};pe.Device=Ff;var vO;(function(i){i.Bluetooth="Bluetooth",i.Wired="Wired",i.WiFi="WiFi",i.Cellular="Cellular",i.InBuilt="InBuilt",i.Unknown="Unknown"})(vO=pe.connectivity||(pe.connectivity={}));var fO;(function(i){i.Phone="Phone",i.Speaker="Speaker",i.Car="Car",i.Headset="Headset",i.Thermostat="Thermostat",i.Microphones="Microphones",i.Deskphone="Deskphone",i.RemoteControl="RemoteControl",i.Unknown="Unknown",i.File="File",i.Stream="Stream"})(fO=pe.type||(pe.type={}))});var C=p(m=>{"use strict";var gO=m&&m.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t),Object.defineProperty(i,r,{enumerable:!0,get:function(){return e[t]}})}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),R=m&&m.__exportStar||function(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&gO(e,i,t)};Object.defineProperty(m,"__esModule",{value:!0});m.AutoDetectSourceLanguagesOpenRangeOptionName=m.ForceDictationPropertyName=m.ServicePropertiesPropertyName=m.CancellationErrorCodePropertyName=m.OutputFormatPropertyName=void 0;R(Tm(),m);R(Dm(),m);R(Xs(),m);R(Nm(),m);R(jm(),m);R(MC(),m);R(qC(),m);R(Ac(),m);R(zC(),m);R(LC(),m);R(FC(),m);R(UC(),m);R(HC(),m);R($C(),m);R(ZC(),m);R(rP(),m);R(oP(),m);R(Fd(),m);R(aP(),m);R(cP(),m);R(pP(),m);R(lP(),m);R(hP(),m);R(vP(),m);R(fP(),m);R(gP(),m);R(mP(),m);R(yP(),m);R(SP(),m);R(PP(),m);R(RP(),m);R(EP(),m);R(_P(),m);R(wP(),m);R(bP(),m);R(TP(),m);R(MP(),m);R(DP(),m);R(xP(),m);R(qP(),m);R(BP(),m);R(FP(),m);R(oR(),m);R(Cf(),m);R(uR(),m);R(pR(),m);var mO=hR();Object.defineProperty(m,"AvatarSynthesisAdapter",{enumerable:!0,get:function(){return mO.AvatarSynthesisAdapter}});var yO=dR();Object.defineProperty(m,"SpeechSynthesisAdapter",{enumerable:!0,get:function(){return yO.SpeechSynthesisAdapter}});R(vR(),m);R(mR(),m);R(yR(),m);R(SR(),m);R(PR(),m);R(ER(),m);R(_R(),m);m.OutputFormatPropertyName="OutputFormat";m.CancellationErrorCodePropertyName="CancellationErrorCode";m.ServicePropertiesPropertyName="ServiceProperties";m.ForceDictationPropertyName="ForceDictation";m.AutoDetectSourceLanguagesOpenRangeOptionName="OpenRange"});var Vf=p(li=>{"use strict";var SO=li&&li.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t),Object.defineProperty(i,r,{enumerable:!0,get:function(){return e[t]}})}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),CO=li&&li.__exportStar||function(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&SO(e,i,t)};Object.defineProperty(li,"__esModule",{value:!0});var PO=C();new PO.AgentConfig;CO(f(),li)});var xR=Xu(Vf());var xx=new RegExp("^(?:[\\u{1F1E6}-\\u{1F1FF}]{2}|\\u{1F3F4}[\\u{E0061}-\\u{E007A}]{2}[\\u{E0030}-\\u{E0039}\\u{E0061}-\\u{E007A}]{1,3}\\u{E007F}|(?:\\p{Emoji}\\uFE0F\\u20E3?|\\p{Emoji_Modifier_Base}\\p{Emoji_Modifier}?|\\p{Emoji_Presentation})(?:\\u200D(?:\\p{Emoji}\\uFE0F\\u20E3?|\\p{Emoji_Modifier_Base}\\p{Emoji_Modifier}?|\\p{Emoji_Presentation}))*)+$","u");var Uf;function RO(i){return{lang:i?.lang??Uf?.lang,message:i?.message,abortEarly:i?.abortEarly??Uf?.abortEarly,abortPipeEarly:i?.abortPipeEarly??Uf?.abortPipeEarly}}var EO;function _O(i){return EO?.get(i)}var IO;function wO(i){return IO?.get(i)}var bO;function AO(i,e){return bO?.get(i)?.get(e)}function rn(i){let e=typeof i;return e==="string"?`"${i}"`:e==="number"||e==="bigint"||e==="boolean"?`${i}`:e==="object"||e==="function"?(i&&Object.getPrototypeOf(i)?.constructor?.name)??"null":e}function Be(i,e,t,r,n){let s=n&&"input"in n?n.input:t.value,o=n?.expected??i.expects??null,a=n?.received??rn(s),c={kind:i.kind,type:i.type,input:s,expected:o,received:a,message:`Invalid ${e}: ${o?`Expected ${o} but r`:"R"}eceived ${a}`,requirement:i.requirement,path:n?.path,issues:n?.issues,lang:r.lang,abortEarly:r.abortEarly,abortPipeEarly:r.abortPipeEarly},u=i.kind==="schema",l=n?.message??i.message??AO(i.reference,c.lang)??(u?wO(c.lang):null)??r.message??_O(c.lang);l&&(c.message=typeof l=="function"?l(c):l),u&&(t.typed=!1),t.issues?t.issues.push(c):t.issues=[c]}function Hf(i,e){let t=[...new Set(i)];return t.length>1?`(${t.join(` ${e} `)})`:t[0]??"never"}var TO=class extends Error{issues;constructor(i){super(i[0].message),this.name="ValiError",this.issues=i}};function Kf(i,e){return{kind:"validation",type:"max_value",reference:Kf,async:!1,expects:`<=${i instanceof Date?i.toJSON():rn(i)}`,requirement:i,message:e,_run(t,r){return t.typed&&t.value>this.requirement&&Be(this,"value",t,r,{received:t.value instanceof Date?t.value.toJSON():rn(t.value)}),t}}}function Jf(i,e){return{kind:"validation",type:"min_value",reference:Jf,async:!1,expects:`>=${i instanceof Date?i.toJSON():rn(i)}`,requirement:i,message:e,_run(t,r){return t.typed&&t.value<this.requirement&&Be(this,"value",t,r,{received:t.value instanceof Date?t.value.toJSON():rn(t.value)}),t}}}function Gf(){return{kind:"transformation",type:"readonly",reference:Gf,async:!1,_run(i){return i}}}function $f(i){return{kind:"transformation",type:"transform",reference:$f,async:!1,operation:i,_run(e){return e.value=this.operation(e.value),e}}}function OO(i,e,t){return typeof i.default=="function"?i.default(e,t):i.default}function Qf(i,e){return{kind:"schema",type:"array",reference:Qf,expects:"Array",async:!1,item:i,message:e,_run(t,r){let n=t.value;if(Array.isArray(n)){t.typed=!0,t.value=[];for(let s=0;s<n.length;s++){let o=n[s],a=this.item._run({typed:!1,value:o},r);if(a.issues){let c={type:"array",origin:"value",input:n,key:s,value:o};for(let u of a.issues)u.path?u.path.unshift(c):u.path=[c],t.issues?.push(u);if(t.issues||(t.issues=a.issues),r.abortEarly){t.typed=!1;break}}a.typed||(t.typed=!1),t.value.push(a.value)}}else Be(this,"type",t,r);return t}}}function br(i){return{kind:"schema",type:"boolean",reference:br,expects:"boolean",async:!1,message:i,_run(e,t){return typeof e.value=="boolean"?e.typed=!0:Be(this,"type",e,t),e}}}function Xf(i,e){let t=Object.entries(i).filter(([r])=>isNaN(+r)).map(([,r])=>r);return{kind:"schema",type:"enum",reference:Xf,expects:Hf(t.map(rn),"|"),async:!1,enum:i,options:t,message:e,_run(r,n){return this.options.includes(r.value)?r.typed=!0:Be(this,"type",r,n),r}}}function Zf(i){return{kind:"schema",type:"function",reference:Zf,expects:"Function",async:!1,message:i,_run(e,t){return typeof e.value=="function"?e.typed=!0:Be(this,"type",e,t),e}}}function Wf(i,e){if(typeof i==typeof e){if(i===e||i instanceof Date&&e instanceof Date&&+i==+e)return{value:i};if(i&&e&&i.constructor===Object&&e.constructor===Object){for(let t in e)if(t in i){let r=Wf(i[t],e[t]);if(r.issue)return r;i[t]=r.value}else i[t]=e[t];return{value:i}}if(Array.isArray(i)&&Array.isArray(e)&&i.length===e.length){for(let t=0;t<i.length;t++){let r=Wf(i[t],e[t]);if(r.issue)return r;i[t]=r.value}return{value:i}}}return{issue:!0}}function Yf(i,e){return{kind:"schema",type:"intersect",reference:Yf,expects:Hf(i.map(t=>t.expects),"&"),async:!1,options:i,message:e,_run(t,r){if(this.options.length){let n=t.value,s;t.typed=!0;for(let o of this.options){let a=o._run({typed:!1,value:n},r);if(a.issues&&(t.issues?t.issues.push(...a.issues):t.issues=a.issues,r.abortEarly)){t.typed=!1;break}a.typed||(t.typed=!1),t.typed&&(s?s.push(a.value):s=[a.value])}if(t.typed){t.value=s[0];for(let o=1;o<s.length;o++){let a=Wf(t.value,s[o]);if(a.issue){Be(this,"type",t,r,{received:"unknown"});break}t.value=a.value}}}else Be(this,"type",t,r);return t}}}function eg(i){return{kind:"schema",type:"number",reference:eg,expects:"number",async:!1,message:i,_run(e,t){return typeof e.value=="number"&&!isNaN(e.value)?e.typed=!0:Be(this,"type",e,t),e}}}function nn(i,e){return{kind:"schema",type:"object",reference:nn,expects:"Object",async:!1,entries:i,message:e,_run(t,r){let n=t.value;if(n&&typeof n=="object"){t.typed=!0,t.value={};for(let s in this.entries){let o=n[s],a=this.entries[s]._run({typed:!1,value:o},r);if(a.issues){let c={type:"object",origin:"value",input:n,key:s,value:o};for(let u of a.issues)u.path?u.path.unshift(c):u.path=[c],t.issues?.push(u);if(t.issues||(t.issues=a.issues),r.abortEarly){t.typed=!1;break}}a.typed||(t.typed=!1),(a.value!==void 0||s in n)&&(t.value[s]=a.value)}}else Be(this,"type",t,r);return t}}}function Y(i,...e){let t={kind:"schema",type:"optional",reference:Y,expects:`(${i.expects} | undefined)`,async:!1,wrapped:i,_run(r,n){return r.value===void 0&&("default"in this&&(r.value=OO(this,r,n)),r.value===void 0)?(r.typed=!0,r):this.wrapped._run(r,n)}};return 0 in e&&(t.default=e[0]),t}function at(i){return{kind:"schema",type:"string",reference:at,expects:"string",async:!1,message:i,_run(e,t){return typeof e.value=="string"?e.typed=!0:Be(this,"type",e,t),e}}}function St(i){return{kind:"schema",type:"undefined",reference:St,expects:"undefined",async:!1,message:i,_run(e,t){return e.value===void 0?e.typed=!0:Be(this,"type",e,t),e}}}function IR(i){let e;if(i)for(let t of i)e?e.push(...t.issues):e=t.issues;return e}function hi(i,e){return{kind:"schema",type:"union",reference:hi,expects:Hf(i.map(t=>t.expects),"|"),async:!1,options:i,message:e,_run(t,r){let n,s,o;for(let a of this.options){let c=a._run({typed:!1,value:t.value},r);if(c.typed)if(c.issues)s?s.push(c):s=[c];else{n=c;break}else o?o.push(c):o=[c]}if(n)return n;if(s){if(s.length===1)return s[0];Be(this,"type",t,r,{issues:IR(s)}),t.typed=!0}else{if(o?.length===1)return o[0];Be(this,"type",t,r,{issues:IR(o)})}return t}}}function Fe(i,e,t){let r=i._run({typed:!1,value:e},RO(t));if(r.issues)throw new TO(r.issues);return r.value}function sn(...i){return{...i[0],pipe:i,_run(e,t){for(let r of i)if(r.kind!=="metadata"){if(e.issues&&(r.kind==="schema"||r.kind==="transformation")){e.typed=!1;break}(!e.issues||!t.abortEarly&&!t.abortPipeEarly)&&(e=r._run(e,t))}return e}}}function kO(i){return typeof i=="function"}function tg(i){return kO(i)?i():i}var jt=Xu(Vf()),Ar={AudioConfig:jt.AudioConfig,OutputFormat:jt.OutputFormat,ResultReason:jt.ResultReason,SpeechConfig:jt.SpeechConfig,SpeechRecognizer:jt.SpeechRecognizer};var MO=sn(Yf([hi([nn({authorizationToken:at(),subscriptionKey:Y(St('"subscriptionKey" must be unset when "authorizationToken" is set.'))}),nn({authorizationToken:Y(St('"authorizationToken" must be unset when "subscriptionKey" is set.')),subscriptionKey:at()})],'The object must either have either "authorizationToken" or "subscriptionKey" set, but not both.'),hi([nn({customVoiceHostname:Y(St('"customVoiceHostname" must be unest when "region" is set.')),region:at(),speechRecognitionHostname:Y(St('"speechRecognitionHostname" must be unest when "region" is set.')),speechSynthesisHostname:Y(St('"speechSynthesisHostname" must be unest when "region" is set.'))}),nn({customVoiceHostname:Y(hi([at(),St()])),region:Y(St('"region" must be unset when "*Hostname" is set.')),speechRecognitionHostname:at(),speechSynthesisHostname:at()})],'The object must either have either "region" or "*Hostname" set, but not both.')]),Gf()),wR=MO;var DO=Y(br()),bR=DO;var xO=Y(sn(eg(),Jf(1),Kf(6e4))),AR=xO;var NO=Y(br(),!1),TR=NO;var qO=sn(Y(Qf(at()),[]),$f(i=>Object.isFrozen(i)?i:Object.freeze([...i]))),Lu=qO;var jO=Y(at()),OR=jO;var zO=Y(Xf({display:"display",itn:"itn",lexical:"lexical",maskeditn:"maskeditn"}),"display"),Bu=zO;var{AudioConfig:LO}=Ar,kR=!0;function ps(i){let{audioConfig:e,credentials:t,enableTelemetry:r,initialSilenceTimeout:n,looseEvent:s,referenceGrammars:o,speechRecognitionEndpointId:a,textNormalization:c}=i,{looseEvents:u}=i;return typeof s<"u"&&(console.warn('web-speech-cognitive-services: The option "looseEvent" should be named as "looseEvents".'),u=s),Object.freeze({audioConfig:e||LO.fromDefaultMicrophoneInput(),enableTelemetry:Fe(bR,r),fetchCredentials:async()=>{let l=Fe(wR,await tg(t));return kR&&l.subscriptionKey&&(console.warn("web-speech-cognitive-services: In production environment, subscription key should not be used, authorization token should be used instead."),kR=!1),l},initialSilenceTimeout:Fe(AR,n),looseEvents:Fe(TR,u),referenceGrammars:Fe(Lu,o),speechRecognitionEndpointId:Fe(OR,a),textNormalization:Fe(Bu,c)})}function ls(){let i={};return i.promise=new Promise((e,t)=>{i.resolve=e,i.reject=t}),i}function MR(){let i,e=[];return{push:n=>{if(i){let{resolve:s}=i;i=null,s(n)}else e.push(n)},shift:()=>e.length?Promise.resolve(e.shift()):(i||(i=ls())).promise}}var on=class{constructor({confidence:e,transcript:t}){this.#t=e,this.#e=t}#t;#e;get confidence(){return this.#t}get transcript(){return this.#e}};var di=class{constructor(e){if(!e)throw new Error("array must be set.");this.#t=e;for(let t in e)Object.defineProperty(this,t,{enumerable:!0,get(){return e[t]}})}#t;[Symbol.iterator](){return this.#t[Symbol.iterator]()}get length(){return this.#t.length}};var vi=class extends di{constructor(e){super(e.results),this.#t=e.isFinal}#t;get isFinal(){return this.#t}};var{ResultReason:{RecognizingSpeech:BO,RecognizedSpeech:rg}}=Ar;function ig(i,e){let{maxAlternatives:t=1/0,textNormalization:r="display"}=e||{},n=typeof i.json=="string"?JSON.parse(i.json):i.json;return i.reason===BO||i.reason===rg&&!n.NBest?new vi({isFinal:i.reason===rg,results:[new on({confidence:.5,transcript:i.text})]}):i.reason===rg?new vi({isFinal:!0,results:(n.NBest||[]).slice(0,t).map(({Confidence:s,Display:o,ITN:a,Lexical:c,MaskedITN:u})=>new on({confidence:s,transcript:r==="itn"?a:r==="lexical"?c:r==="maskeditn"?u:o}))}):new vi({isFinal:!1,results:[]})}function an(i,e=void 0){return(...t)=>new Promise((r,n)=>i.apply(e,[...t,r,n]))}var hs=class{constructor(e){this.#t=e,this.#e={}}#t;#e;getProperty(e){return this.#e[e]}setProperty(e,t){let r=this.#e[e];r&&this.#t.removeEventListener(e,r),t&&this.#t.addEventListener(e,t),this.#e[e]=t}};var DR=Xu(gp());function ng(i){let e=Array.from(new Int16Array(i));return e.reduce((t,r)=>t+Math.abs(r),0)/e.length}function sg(i){let e=i,t=e.attach,r=e.attach.bind(e),n=!1,s=!1;return e.attach=async()=>{let o=await r("");return{...o,read:async()=>{let a=await o.read();return!n&&ng(a.buffer)>150&&(e.events.onEvent(new DR.AudioSourceEvent("FirstAudibleChunk","")),n=!0),s?{buffer:new ArrayBuffer(0),isEnd:!0,timeReceived:Date.now()}:a}}},{audioConfig:i,pause:()=>{s=!0},unprepare:()=>{e.attach=t}}}function Fu({duration:i,errorDetails:e,json:t,offset:r,properties:n,reason:s,resultId:o,text:a}){return Object.freeze({duration:i,errorDetails:e,json:t&&JSON.parse(t),offset:r,properties:n,reason:s,resultId:o,text:a})}var fi=class{constructor(){this.#t=[]}addFromString(){throw new Error("JSGF is not supported")}addFromURI(){throw new Error("JSGF is not supported")}item(){throw new Error("JSGF is not supported")}get length(){throw new Error("JSGF is not supported")}#t;get phrases(){return this.#t}set phrases(e){if(Array.isArray(e))this.#t=Object.freeze([...e]);else if(typeof e=="string")this.#t=Object.freeze([e]);else throw new Error("The provided value is not an array or of type 'string'")}};var zt=class extends Event{constructor(e,{error:t,message:r}){super(e),this.#t=t,this.#e=r}#t;#e;get error(){return this.#t}get message(){return this.#e}get type(){return"error"}};var Lt=class extends di{constructor(e){super(e)}};var U=class extends Event{constructor(e,{data:t,resultIndex:r,results:n}={}){super(e),this.#t=t,this.#e=r,this.#r=n||new Lt([])}#t;#e;#r;get data(){return this.#t}get resultIndex(){return this.#e}get results(){return this.#r}get type(){return super.type}};var{ResultReason:FO,SpeechRecognizer:VO}=Ar,UO=hi([br(),St()]);function Tr({createRecognizer:i,enableTelemetry:e,looseEvents:t,referenceGrammars:r,textNormalization:n}){i=Fe(Zf(),i),e=Fe(UO,e),t=Fe(br(),t),r=Fe(Lu,r),n=Fe(Bu,n),typeof e<"u"&&VO.enableTelemetry(e);class s extends EventTarget{#t=!1;#e=new hs(this);#r=new fi;#i=!1;#n=typeof window<"u"?window.document.documentElement.getAttribute("lang")||window.navigator.language:"en-US";#s=1;emitCognitiveServices(a,c){this.dispatchEvent(new U("cognitiveservices",{data:{...c,type:a}}))}get continuous(){return this.#t}set continuous(a){this.#t=a}get grammars(){return this.#r}set grammars(a){if(a instanceof fi)this.#r=a;else throw new Error("The provided value is not of type 'SpeechGrammarList'")}get interimResults(){return this.#i}set interimResults(a){this.#i=a}get maxAlternatives(){return this.#s}set maxAlternatives(a){this.#s=a}get lang(){return this.#n}set lang(a){this.#n=a}get onaudioend(){return this.#e.getProperty("audioend")}set onaudioend(a){this.#e.setProperty("audioend",a)}get onaudiostart(){return this.#e.getProperty("audiostart")}set onaudiostart(a){this.#e.setProperty("audiostart",a)}get oncognitiveservices(){return this.#e.getProperty("cognitiveservices")}set oncognitiveservices(a){this.#e.setProperty("cognitiveservices",a)}get onend(){return this.#e.getProperty("end")}set onend(a){this.#e.setProperty("end",a)}get onerror(){return this.#e.getProperty("error")}set onerror(a){this.#e.setProperty("error",a)}get onresult(){return this.#e.getProperty("result")}set onresult(a){this.#e.setProperty("result",a)}get onsoundend(){return this.#e.getProperty("soundend")}set onsoundend(a){this.#e.setProperty("soundend",a)}get onsoundstart(){return this.#e.getProperty("soundstart")}set onsoundstart(a){this.#e.setProperty("soundstart",a)}get onspeechend(){return this.#e.getProperty("speechend")}set onspeechend(a){this.#e.setProperty("speechend",a)}get onspeechstart(){return this.#e.getProperty("speechstart")}set onspeechstart(a){this.#e.setProperty("speechstart",a)}get onstart(){return this.#e.getProperty("start")}set onstart(a){this.#e.setProperty("start",a)}abort;stop;start(){this._startOnce().catch(a=>{this.dispatchEvent(new zt("error",{error:a,message:a&&(a.stack||a.message)}))})}async _startOnce(){let a=await i(this.lang),{pause:c,unprepare:u}=sg(a.audioConfig);try{let l=MR(),h,d,g,{detach:M}=a.audioConfig.events.attach(F=>{let{name:K}=F;K==="AudioSourceReadyEvent"?l.push({audioSourceReady:{}}):K==="AudioSourceOffEvent"?l.push({audioSourceOff:{}}):K==="FirstAudibleChunk"&&l.push({firstAudibleChunk:{}})});a.canceled=(F,{errorDetails:K,offset:ct,reason:kr,sessionId:Ju})=>{l.push({canceled:{errorDetails:K,offset:ct,reason:kr,sessionId:Ju}})},a.recognized=(F,{offset:K,result:ct,sessionId:kr})=>{l.push({recognized:{offset:K,result:Fu(ct),sessionId:kr}})},a.recognizing=(F,{offset:K,result:ct,sessionId:kr})=>{l.push({recognizing:{offset:K,result:Fu(ct),sessionId:kr}})},a.sessionStarted=(F,{sessionId:K})=>{l.push({sessionStarted:{sessionId:K}})},a.sessionStopped=(F,{sessionId:K})=>{l.push({sessionStopped:{sessionId:K}})},a.speechStartDetected=(F,{offset:K,sessionId:ct})=>{l.push({speechStartDetected:{offset:K,sessionId:ct}})},a.speechEndDetected=(F,{sessionId:K})=>{l.push({speechEndDetected:{sessionId:K}})};let{phrases:D}=this.grammars,{dynamicGrammar:oe}=a.privReco;r&&r.length&&oe.addReferenceGrammar([...r]),D&&D.length&&oe.addPhrase([...D]),await an(a.startContinuousRecognitionAsync,a)(),typeof a.stopContinuousRecognitionAsync=="function"?(this.abort=()=>l.push({abort:{}}),this.stop=()=>l.push({stop:{}})):this.abort=this.stop=void 0;let Q,ee,Ce=[];for(let F=0;!g||Q;F++){let K=await l.shift(),{abort:ct,audioSourceOff:kr,audioSourceReady:Ju,canceled:Eg,firstAudibleChunk:fE,recognized:gi,recognizing:Gu,stop:gE}=K;Object.keys(K).forEach(hn=>this.emitCognitiveServices(hn,K[hn]));let $u=Eg&&Eg.errorDetails;if(/Permission\sdenied/u.test($u||"")){ee=new zt("error",{error:"not-allowed"});break}if(F||this.dispatchEvent(new U("start")),$u){/1006/u.test($u)?(Q||(this.dispatchEvent(new U("audiostart")),this.dispatchEvent(new U("audioend"))),ee=new zt("error",{error:"network"})):ee=new zt("error",{error:"unknown"});break}else if(ct||gE)ct?(ee=new zt("error",{error:"aborted"}),g="abort"):(c(),g="stop"),ct&&a.stopContinuousRecognitionAsync&&await an(a.stopContinuousRecognitionAsync,a)();else if(Ju)this.dispatchEvent(new U("audiostart")),Q=!0;else if(fE)this.dispatchEvent(new U("soundstart")),h=!0;else if(kr){d&&this.dispatchEvent(new U("speechend")),h&&this.dispatchEvent(new U("soundend")),Q&&this.dispatchEvent(new U("audioend")),Q=h=d=!1;break}else if(g!=="abort"){if(gi&&gi.result&&gi.result.reason===FO.NoMatch){if(!this.continuous||g==="stop"){ee=new U("result",{results:new Lt(Ce)}),a.stopContinuousRecognitionAsync&&await an(a.stopContinuousRecognitionAsync,a)();break}}else if(gi||Gu)if(Q||(this.dispatchEvent(new U("audiostart")),Q=!0),h||(this.dispatchEvent(new U("soundstart")),h=!0),d||(this.dispatchEvent(new U("speechstart")),d=!0),gi){let hn=ig(gi.result,{maxAlternatives:this.maxAlternatives,textNormalization:n}),Qu=!!hn[0]?.transcript;Qu&&(Ce=[...Ce,hn],this.continuous&&this.dispatchEvent(new U("result",{results:new Lt(Ce)}))),this.continuous&&Qu?ee=void 0:ee=new U("result",{results:new Lt(Ce)}),(!this.continuous||g==="stop")&&a.stopContinuousRecognitionAsync&&await an(a.stopContinuousRecognitionAsync,a)(),t&&ee&&Qu&&(this.dispatchEvent(ee),ee=void 0)}else Gu&&this.interimResults&&this.dispatchEvent(new U("result",{results:new Lt([...Ce,ig(Gu.result,{maxAlternatives:this.maxAlternatives,textNormalization:n})])}))}}d&&this.dispatchEvent(new U("speechend")),h&&this.dispatchEvent(new U("soundend")),Q&&this.dispatchEvent(new U("audioend")),ee&&(ee.type==="result"&&!ee.results.length&&(ee=new zt("error",{error:"no-speech"})),this.dispatchEvent(ee)),this.dispatchEvent(new U("end")),M()}catch(l){throw console.error(l),l}finally{u(),a.dispose(!1)}}}return{SpeechGrammarList:fi,SpeechRecognition:s,SpeechRecognitionEvent:U}}var{OutputFormat:WO,SpeechConfig:Vu,SpeechRecognizer:HO}=Ar;function ds(i){let{audioConfig:e,enableTelemetry:t,fetchCredentials:r,initialSilenceTimeout:n,looseEvents:s,referenceGrammars:o,speechRecognitionEndpointId:a,textNormalization:c}=ps(i);if(!e&&(!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia))throw new Error("web-speech-cognitive-services: This browser does not support Media Capture and Streams API and it will not work with Cognitive Services Speech Services.");return Tr({createRecognizer:async l=>{let h=await r(),d;if(typeof h.speechRecognitionHostname<"u"){let g=new URL("wss://localhost:443");g.hostname=h.speechRecognitionHostname,h.authorizationToken?(d=Vu.fromHost(g),d.authorizationToken=h.authorizationToken):d=Vu.fromHost(g,h.subscriptionKey)}else d=typeof h.authorizationToken<"u"?Vu.fromAuthorizationToken(h.authorizationToken,h.region):Vu.fromSubscription(h.subscriptionKey,h.region);return a&&(d.endpointId=a),d.outputFormat=WO.Detailed,d.speechRecognitionLanguage=l||"en-US",typeof n=="number"&&d.setProperty(xR.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,""+n),new HO(d,e)},enableTelemetry:t,looseEvents:s,referenceGrammars:o,textNormalization:c})}function pg(i,e,...t){if(!i)throw new TypeError(HR(e,t))}function HR(i,e){let t=0;return i.replace(/%[os]/gu,()=>KR(e[t++]))}function KR(i){return typeof i!="object"||i===null?String(i):Object.prototype.toString.call(i)}var NR;function KO(i){try{let e=i instanceof Error?i:new Error(KR(i));if(NR){NR(e);return}if(typeof dispatchEvent=="function"&&typeof ErrorEvent=="function")dispatchEvent(new ErrorEvent("error",{error:e,message:e.message}));else if(typeof process<"u"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)}catch{}}var Ct=typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:typeof globalThis<"u"?globalThis:void 0,qR;var Pt=class{constructor(e,t){this.code=e,this.message=t}warn(...e){var t;try{if(qR){qR({...this,args:e});return}let r=((t=new Error().stack)!==null&&t!==void 0?t:"").replace(/^(?:.+?\n){2}/gu,`
`);console.warn(this.message,...e,r)}catch{}}},JO=new Pt("W01","Unable to initialize event under dispatching."),GO=new Pt("W02","Assigning any falsy value to 'cancelBubble' property has no effect."),$O=new Pt("W03","Assigning any truthy value to 'returnValue' property has no effect."),QO=new Pt("W04","Unable to preventDefault on non-cancelable events."),XO=new Pt("W05","Unable to preventDefault inside passive event listener invocation."),ZO=new Pt("W06","An event listener wasn't added because it has been added already: %o, %o"),og=new Pt("W07","The %o option value was abandoned because the event listener wasn't added as duplicated."),jR=new Pt("W08","The 'callback' argument must be a function or an object that has 'handleEvent' method: %o"),YO=new Pt("W09","Event attribute handler must be a function: %o"),Ge=class{static get NONE(){return zR}static get CAPTURING_PHASE(){return LR}static get AT_TARGET(){return BR}static get BUBBLING_PHASE(){return FR}constructor(e,t){Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});let r=t??{};ug.set(this,{type:String(e),bubbles:!!r.bubbles,cancelable:!!r.cancelable,composed:!!r.composed,target:null,currentTarget:null,stopPropagationFlag:!1,stopImmediatePropagationFlag:!1,canceledFlag:!1,inPassiveListenerFlag:!1,dispatchFlag:!1,timeStamp:Date.now()})}get type(){return se(this).type}get target(){return se(this).target}get srcElement(){return se(this).target}get currentTarget(){return se(this).currentTarget}composedPath(){let e=se(this).currentTarget;return e?[e]:[]}get NONE(){return zR}get CAPTURING_PHASE(){return LR}get AT_TARGET(){return BR}get BUBBLING_PHASE(){return FR}get eventPhase(){return se(this).dispatchFlag?2:0}stopPropagation(){se(this).stopPropagationFlag=!0}get cancelBubble(){return se(this).stopPropagationFlag}set cancelBubble(e){e?se(this).stopPropagationFlag=!0:GO.warn()}stopImmediatePropagation(){let e=se(this);e.stopPropagationFlag=e.stopImmediatePropagationFlag=!0}get bubbles(){return se(this).bubbles}get cancelable(){return se(this).cancelable}get returnValue(){return!se(this).canceledFlag}set returnValue(e){e?$O.warn():VR(se(this))}preventDefault(){VR(se(this))}get defaultPrevented(){return se(this).canceledFlag}get composed(){return se(this).composed}get isTrusted(){return!1}get timeStamp(){return se(this).timeStamp}initEvent(e,t=!1,r=!1){let n=se(this);if(n.dispatchFlag){JO.warn();return}ug.set(this,{...n,type:String(e),bubbles:!!t,cancelable:!!r,target:null,currentTarget:null,stopPropagationFlag:!1,stopImmediatePropagationFlag:!1,canceledFlag:!1})}},zR=0,LR=1,BR=2,FR=3,ug=new WeakMap;function se(i,e="this"){let t=ug.get(i);return pg(t!=null,"'%s' must be an object that Event constructor created, but got another one: %o",e,i),t}function VR(i){if(i.inPassiveListenerFlag){XO.warn();return}if(!i.cancelable){QO.warn();return}i.canceledFlag=!0}Object.defineProperty(Ge,"NONE",{enumerable:!0});Object.defineProperty(Ge,"CAPTURING_PHASE",{enumerable:!0});Object.defineProperty(Ge,"AT_TARGET",{enumerable:!0});Object.defineProperty(Ge,"BUBBLING_PHASE",{enumerable:!0});var ag=Object.getOwnPropertyNames(Ge.prototype);for(let i=0;i<ag.length;++i)ag[i]!=="constructor"&&Object.defineProperty(Ge.prototype,ag[i],{enumerable:!0});typeof Ct<"u"&&typeof Ct.Event<"u"&&Object.setPrototypeOf(Ge.prototype,Ct.Event.prototype);function ek(i){return Ct.DOMException?new Ct.DOMException(i,"InvalidStateError"):(cn==null&&(cn=class JR extends Error{constructor(t){super(t),Error.captureStackTrace&&Error.captureStackTrace(this,JR)}get code(){return 11}get name(){return"InvalidStateError"}},Object.defineProperties(cn.prototype,{code:{enumerable:!0},name:{enumerable:!0}}),WR(cn),WR(cn.prototype)),new cn(i))}var cn,UR={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};function WR(i){let e=Object.keys(UR);for(let t=0;t<e.length;++t){let r=e[t],n=UR[r];Object.defineProperty(i,r,{get(){return n},configurable:!0,enumerable:!0})}}var pn=class extends Ge{static wrap(e){return new($R(e))(e)}constructor(e){super(e.type,{bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed}),e.cancelBubble&&super.stopPropagation(),e.defaultPrevented&&super.preventDefault(),GR.set(this,{original:e});let t=Object.keys(e);for(let r=0;r<t.length;++r){let n=t[r];n in this||Object.defineProperty(this,n,QR(e,n))}}stopPropagation(){super.stopPropagation();let{original:e}=Or(this);"stopPropagation"in e&&e.stopPropagation()}get cancelBubble(){return super.cancelBubble}set cancelBubble(e){super.cancelBubble=e;let{original:t}=Or(this);"cancelBubble"in t&&(t.cancelBubble=e)}stopImmediatePropagation(){super.stopImmediatePropagation();let{original:e}=Or(this);"stopImmediatePropagation"in e&&e.stopImmediatePropagation()}get returnValue(){return super.returnValue}set returnValue(e){super.returnValue=e;let{original:t}=Or(this);"returnValue"in t&&(t.returnValue=e)}preventDefault(){super.preventDefault();let{original:e}=Or(this);"preventDefault"in e&&e.preventDefault()}get timeStamp(){let{original:e}=Or(this);return"timeStamp"in e?e.timeStamp:super.timeStamp}},GR=new WeakMap;function Or(i){let e=GR.get(i);return pg(e!=null,"'this' is expected an Event object, but got",i),e}var Uu=new WeakMap;Uu.set(Object.prototype,pn);typeof Ct<"u"&&typeof Ct.Event<"u"&&Uu.set(Ct.Event.prototype,pn);function $R(i){let e=Object.getPrototypeOf(i);if(e==null)return pn;let t=Uu.get(e);return t==null&&(t=tk($R(e),e),Uu.set(e,t)),t}function tk(i,e){class t extends i{}let r=Object.keys(e);for(let n=0;n<r.length;++n)Object.defineProperty(t.prototype,r[n],QR(e,r[n]));return t}function QR(i,e){let t=Object.getOwnPropertyDescriptor(i,e);return{get(){let r=Or(this).original,n=r[e];return typeof n=="function"?n.bind(r):n},set(r){let n=Or(this).original;n[e]=r},configurable:t.configurable,enumerable:t.enumerable}}function rk(i,e,t,r,n,s){return{callback:i,flags:(e?1:0)|(t?2:0)|(r?4:0),signal:n,signalListener:s}}function ik(i){i.flags|=8}function XR(i){return(i.flags&1)===1}function ZR(i){return(i.flags&2)===2}function YR(i){return(i.flags&4)===4}function nk(i){return(i.flags&8)===8}function sk({callback:i},e,t){try{typeof i=="function"?i.call(e,t):typeof i.handleEvent=="function"&&i.handleEvent(t)}catch(r){KO(r)}}function eE({listeners:i},e,t){for(let r=0;r<i.length;++r)if(i[r].callback===e&&XR(i[r])===t)return r;return-1}function tE(i,e,t,r,n,s){let o;s&&(o=lg.bind(null,i,e,t),s.addEventListener("abort",o));let a=rk(e,t,r,n,s,o);return i.cow?(i.cow=!1,i.listeners=[...i.listeners,a]):i.listeners.push(a),a}function lg(i,e,t){let r=eE(i,e,t);return r!==-1?rE(i,r):!1}function rE(i,e,t=!1){let r=i.listeners[e];return ik(r),r.signal&&r.signal.removeEventListener("abort",r.signalListener),i.cow&&!t?(i.cow=!1,i.listeners=i.listeners.filter((n,s)=>s!==e),!1):(i.listeners.splice(e,1),!0)}function ok(){return Object.create(null)}function iE(i,e){var t;return(t=i[e])!==null&&t!==void 0?t:i[e]={attrCallback:void 0,attrListener:void 0,cow:!1,listeners:[]}}var nr=class{constructor(){nE.set(this,ok())}addEventListener(e,t,r){let n=un(this),{callback:s,capture:o,once:a,passive:c,signal:u,type:l}=ak(e,t,r);if(s==null||u?.aborted)return;let h=iE(n,l),d=eE(h,s,o);if(d!==-1){uk(h.listeners[d],c,a,u);return}tE(h,s,o,c,a,u)}removeEventListener(e,t,r){let n=un(this),{callback:s,capture:o,type:a}=ck(e,t,r),c=n[a];s!=null&&c&&lg(c,s,o)}dispatchEvent(e){let t=un(this)[String(e.type)];if(t==null)return!0;let r=e instanceof Ge?e:pn.wrap(e),n=se(r,"event");if(n.dispatchFlag)throw ek("This event has been in dispatching.");if(n.dispatchFlag=!0,n.target=n.currentTarget=this,!n.stopPropagationFlag){let{cow:s,listeners:o}=t;t.cow=!0;for(let a=0;a<o.length;++a){let c=o[a];if(!nk(c)&&(YR(c)&&rE(t,a,!s)&&(a-=1),n.inPassiveListenerFlag=ZR(c),sk(c,this,r),n.inPassiveListenerFlag=!1,n.stopImmediatePropagationFlag))break}s||(t.cow=!1)}return n.target=null,n.currentTarget=null,n.stopImmediatePropagationFlag=!1,n.stopPropagationFlag=!1,n.dispatchFlag=!1,!n.canceledFlag}},nE=new WeakMap;function un(i,e="this"){let t=nE.get(i);return pg(t!=null,"'%s' must be an object that EventTarget constructor created, but got another one: %o",e,i),t}function ak(i,e,t){var r;return sE(e),typeof t=="object"&&t!==null?{type:String(i),callback:e??void 0,capture:!!t.capture,passive:!!t.passive,once:!!t.once,signal:(r=t.signal)!==null&&r!==void 0?r:void 0}:{type:String(i),callback:e??void 0,capture:!!t,passive:!1,once:!1,signal:void 0}}function ck(i,e,t){return sE(e),typeof t=="object"&&t!==null?{type:String(i),callback:e??void 0,capture:!!t.capture}:{type:String(i),callback:e??void 0,capture:!!t}}function sE(i){if(!(typeof i=="function"||typeof i=="object"&&i!==null&&typeof i.handleEvent=="function")){if(i==null||typeof i=="object"){jR.warn(i);return}throw new TypeError(HR(jR.message,[i]))}}function uk(i,e,t,r){ZO.warn(XR(i)?"capture":"bubble",i.callback),ZR(i)!==e&&og.warn("passive"),YR(i)!==t&&og.warn("once"),i.signal!==r&&og.warn("signal")}var cg=Object.getOwnPropertyNames(nr.prototype);for(let i=0;i<cg.length;++i)cg[i]!=="constructor"&&Object.defineProperty(nr.prototype,cg[i],{enumerable:!0});typeof Ct<"u"&&typeof Ct.EventTarget<"u"&&Object.setPrototypeOf(nr.prototype,Ct.EventTarget.prototype);function Bt(i,e){var t,r;return(r=(t=un(i,"target")[e])===null||t===void 0?void 0:t.attrCallback)!==null&&r!==void 0?r:null}function Ft(i,e,t){t!=null&&typeof t!="function"&&YO.warn(t),typeof t=="function"||typeof t=="object"&&t!==null?pk(i,e,t):lk(i,e)}function pk(i,e,t){let r=iE(un(i,"target"),String(e));r.attrCallback=t,r.attrListener==null&&(r.attrListener=tE(r,hk(r),!1,!1,!1,void 0))}function lk(i,e){let r=un(i,"target")[String(e)];r&&r.attrListener&&(lg(r,r.attrListener.callback,!1),r.attrCallback=r.attrListener=void 0)}function hk(i){return function(e){let t=i.attrCallback;typeof t=="function"&&t.call(this,e)}}function oE(i){return!!((typeof i=="function"||typeof i=="object")&&i&&"then"in i&&typeof i.then=="function")}function hg(i,e){return new Promise(t=>{try{let r=i.call(e);oE(r)?r.then(t,()=>t(void 0)):t(r)}catch{t(void 0)}})}var aE=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function dk(i,e){return!!(i===e||aE(i)&&aE(e))}function vk(i,e){if(i.length!==e.length)return!1;for(var t=0;t<i.length;t++)if(!dk(i[t],e[t]))return!1;return!0}function cE(i,e){e===void 0&&(e=vk);var t=null;function r(){for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];if(t&&t.lastThis===this&&e(n,t.lastArgs))return t.lastResult;var o=i.apply(this,n);return t={lastResult:o,lastArgs:n,lastThis:this},o}return r.clear=function(){t=null},r}var Wu=class{constructor(i){this.audioContext=i}pause(){this.audioContext&&this.audioContext.suspend(),this.playingUtterance&&this.playingUtterance.dispatchEvent(new CustomEvent("pause"))}resume(){this.audioContext&&this.audioContext.resume(),this.playingUtterance&&this.playingUtterance.dispatchEvent(new CustomEvent("resume"))}async start(i){let e;for(;e=i.shift();)this.playingUtterance=e,await e.play(this.audioContext),this.playingUtterance=null}stop(){this.playingUtterance&&this.playingUtterance.stop(),this.audioContext.state==="suspended"&&this.audioContext.resume()}};var Hu=class{constructor({audioContext:i,ponyfill:e}){this.consumer=null,this.paused=!1,this.queue=[],this.getAudioContext=cE(()=>i||new e.AudioContext)}pause(){this.paused=!0,this.consumer&&this.consumer.pause()}push(i){this.queue.push(i),this.startConsumer()}resume(){this.paused=!1,this.consumer?this.consumer.resume():this.startConsumer()}get speaking(){return!!this.consumer}async startConsumer(){for(;!this.paused&&this.queue.length&&!this.consumer;)this.consumer=new Wu(this.getAudioContext()),await this.consumer.start(this.queue),this.consumer=null}stop(){this.queue.splice(0),this.consumer&&this.consumer.stop()}};var sr=class extends Ge{constructor(e){super(e)}};function uE(){let i={};return i.promise=new Promise((e,t)=>{i.reject=t,i.resolve=e}),i}var dg=class{constructor(){this.#t=i=>{let e=this.#e.shift();e&&e.resolve(i),this.#r&&(this.#r.resolve(i),this.#r=void 0)}}#t;#e=[];#r=void 0;get eventListener(){return this.#t}[Symbol.iterator](){return{next:()=>({done:!1,value:this.upcoming()})}}one(){let i=uE();return this.#e.push(i),i.promise}upcoming(){return this.#r||(this.#r=uE()),this.#r.promise}};var pE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fs=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(vs=0;vs<pE.length;vs++)fs[pE.charCodeAt(vs)]=vs;var vs;var lE=function(i){var e=i.length*.75,t=i.length,r,n=0,s,o,a,c;i[i.length-1]==="="&&(e--,i[i.length-2]==="="&&e--);var u=new ArrayBuffer(e),l=new Uint8Array(u);for(r=0;r<t;r+=4)s=fs[i.charCodeAt(r)],o=fs[i.charCodeAt(r+1)],a=fs[i.charCodeAt(r+2)],c=fs[i.charCodeAt(r+3)],l[n++]=s<<2|o>>4,l[n++]=(o&15)<<4|a>>2,l[n++]=(a&3)<<6|c&63;return u};function vg(i){let e=Math.round((i-1)*100);return e>=0&&(e="+"+e),e+"%"}function fg({lang:i,pitch:e=1,rate:t=1,text:r,voice:n,volume:s}){return`<speak version="1.0" xml:lang="${i}">
  <voice xml:lang="${i}" name="${n}">
    <prosody pitch="${vg(e)}" rate="${vg(t)}" volume="${vg(s)}">
      ${r}
    </prosody>
  </voice>
</speak>`}var fk=/^\s*<speak(\s|\/?>)/u,gk=/^\s*<\?xml\s/u;function gg(i){return fk.test(i)||gk.test(i)}var mk="en-US",yk="riff-16khz-16bit-mono-pcm",Sk="Microsoft Server Speech Text to Speech Voice (en-US, AriaNeural)",Ck="SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU3LjU2LjEwMQAAAAAAAAAAAAAA//tAwAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAACAAABhgC7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7//////////////////////////////////////////////////////////////////8AAAAATGF2YzU3LjY0AAAAAAAAAAAAAAAAJAUHAAAAAAAAAYYoRBqpAAAAAAD/+xDEAAPAAAGkAAAAIAAANIAAAARMQU1FMy45OS41VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7EMQpg8AAAaQAAAAgAAA0gAAABFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV";async function hE({deploymentId:i,fetchCredentials:e,lang:t=mk,outputFormat:r=yk,pitch:n,rate:s,text:o,voice:a=Sk,volume:c}){if(!o)return lE(Ck);let{authorizationToken:u,region:l,speechSynthesisHostname:h,subscriptionKey:d}=await e();if(u&&d||!u&&!d)throw new Error('Only "authorizationToken" or "subscriptionKey" should be set.');if(l&&h||!l&&!h)throw new Error('Only "region" or "speechSynthesisHostnamename" should be set.');let g=gg(o)?o:fg({lang:t,pitch:n,rate:s,text:o,voice:a,volume:c}),M=h||(i?`${encodeURI(l)}.voice.speech.microsoft.com`:`${encodeURI(l)}.tts.speech.microsoft.com`),D=i?`?deploymentId=${encodeURI(i)}`:"",oe=`https://${M}/cognitiveservices/v1${D}`,Q=await fetch(oe,{headers:{"Content-Type":"application/ssml+xml","X-Microsoft-OutputFormat":r,...u?{Authorization:`Bearer ${u}`}:{"Ocp-Apim-Subscription-Key":d}},method:"POST",body:g});if(!Q.ok)throw new Error(`web-speech-cognitive-services: Failed to syntheis speech, server returned ${Q.status}`);return Q.arrayBuffer()}function mg(i,e,t){return i.addEventListener(e,t),()=>i.removeEventListener(e,t)}function Pk(i,e){return new Promise((t,r)=>{let n=i.decodeAudioData(e,t,r);n&&typeof n.then=="function"&&t(n)})}function Rk(i,e,t){return new Promise((r,n)=>{let s=new dg,o=new dg,a=mg(i,"statechange",({target:{state:c}})=>c==="closed"&&s.eventListener());try{t.buffer=e,t.onended=o.eventListener,t.connect(i.destination),t.start(0),Promise.race([s.upcoming(),o.upcoming()]).then(r)}catch(c){n(c)}finally{a()}})}var yg=class extends nr{constructor(e){super(),this._lang=null,this._pitch=1,this._rate=1,this._voice=null,this._volume=1,this.text=e,this.onboundary=null,this.onend=null,this.onerror=null,this.onmark=null,this.onpause=null,this.onresume=null,this.onstart=null}get lang(){return this._lang}set lang(e){this._lang=e}get onboundary(){return Bt(this,"boundary")}set onboundary(e){Ft(this,"boundary",e)}get onend(){return Bt(this,"end")}set onend(e){Ft(this,"end",e)}get onerror(){return Bt(this,"error")}set onerror(e){Ft(this,"error",e)}get onmark(){return Bt(this,"mark")}set onmark(e){Ft(this,"mark",e)}get onpause(){return Bt(this,"pause")}set onpause(e){Ft(this,"pause",e)}get onresume(){return Bt(this,"resume")}set onresume(e){Ft(this,"resume",e)}get onstart(){return Bt(this,"start")}set onstart(e){Ft(this,"start",e)}get pitch(){return this._pitch}set pitch(e){this._pitch=e}get rate(){return this._rate}set rate(e){this._rate=e}get voice(){return this._voice}set voice(e){this._voice=e}get volume(){return this._volume}set volume(e){this._volume=e}preload({deploymentId:e,fetchCredentials:t,outputFormat:r}){this.arrayBufferPromise=hE({fetchCredentials:t,deploymentId:e,lang:this.lang||window.navigator.language,outputFormat:r,pitch:this.pitch,rate:this.rate,text:this.text,voice:this.voice&&this.voice.voiceURI,volume:this.volume}),this.arrayBufferPromise.catch()}async play(e){try{this.dispatchEvent(new sr("start"));let t=e.createBufferSource(),r=await Pk(e,await this.arrayBufferPromise);this._playingSource=t,await Rk(e,r,t),this._playingSource=null,this.dispatchEvent(new sr("end"))}catch(t){this.dispatchEvent(new ErrorEvent("error",{error:"synthesis-failed",message:t.stack}))}}stop(){this._playingSource&&this._playingSource.stop()}},Sg=yg;var ln=class{constructor({gender:i,lang:e,voiceURI:t}){this._default=!1,this._gender=i,this._lang=e,this._localService=!1,this._name=t,this._voiceURI=t}get default(){return this._default}get gender(){return this._gender}get lang(){return this._lang}get localService(){return this._localService}get name(){return this._name}get voiceURI(){return this._voiceURI}};async function Ek({customVoiceHostname:i,deploymentId:e,region:t,subscriptionKey:r}){let n=i||`${t}.customvoice.api.speech.microsoft.com`,s=await fetch(`https://${encodeURI(n)}/api/texttospeech/v2.0/endpoints/${encodeURIComponent(e)}`,{headers:{accept:"application/json","ocp-apim-subscription-key":r}});if(!s.ok)throw new Error("Failed to fetch custom voices");return s.json()}async function dE({customVoiceHostname:i,deploymentId:e,region:t,subscriptionKey:r}){let{models:n}=await Ek({customVoiceHostname:i,deploymentId:e,region:t,subscriptionKey:r});return n.map(({properties:{Gender:s},locale:o,name:a})=>new ln({gender:s,lang:o,voiceURI:a})).sort(({name:s},{name:o})=>s>o?1:s<o?-1:0)}async function Cg({authorizationToken:i,region:e,speechSynthesisHostname:t,subscriptionKey:r}){let n=t||`${encodeURI(e)}.tts.speech.microsoft.com`,s=await fetch(`https://${n}/cognitiveservices/voices/list`,{headers:{"content-type":"application/json",...i?{authorization:`Bearer ${i}`}:{"Ocp-Apim-Subscription-Key":r}}});if(!s.ok)throw new Error("Failed to fetch voices");return(await s.json()).map(({Gender:a,Locale:c,Name:u})=>new ln({gender:a,lang:c,voiceURI:u})).sort(({name:a},{name:c})=>a>c?1:a<c?-1:0)}var _k="audio-24khz-160kbitrate-mono-mp3",Ik=[],vE=i=>{let{audioContext:e,fetchCredentials:t,ponyfill:r={AudioContext:window.AudioContext||window.webkitAudioContext},speechSynthesisDeploymentId:n,speechSynthesisOutputFormat:s=_k}=ps(i);if(!e&&!r.AudioContext)return console.warn("web-speech-cognitive-services: This browser does not support Web Audio and it will not work with Cognitive Services Speech Services."),{};class o extends nr{constructor(){super(),this.queue=new Hu({audioContext:e,ponyfill:r}),this.updateVoices()}cancel(){this.queue.stop()}getVoices(){return Ik}get onvoiceschanged(){return Bt(this,"voiceschanged")}set onvoiceschanged(c){Ft(this,"voiceschanged",c)}pause(){this.queue.pause()}resume(){this.queue.resume()}speak(c){if(!(c instanceof Sg))throw new Error("invalid utterance");let{reject:u,resolve:l,promise:h}=ls(),d=({error:g,message:M})=>{let D=new Error(g);D.stack=M,u(D)};return c.addEventListener("end",l),c.addEventListener("error",d),c.preload({deploymentId:n,fetchCredentials:t,outputFormat:s}),this.queue.push(c),h.finally(()=>{c.removeEventListener("end",l),c.removeEventListener("error",d)})}get speaking(){return this.queue.speaking}async updateVoices(){let{customVoiceHostname:c,region:u,speechSynthesisHostname:l,subscriptionKey:h}=await t();n?h&&(console.warn("web-speech-cognitive-services: Listing of custom voice models are only available when using subscription key."),await hg(async()=>{let d=await dE({customVoiceHostname:c,deploymentId:n,region:u,speechSynthesisHostname:l,subscriptionKey:h});this.getVoices=()=>d})):await hg(async()=>{let d=await Cg(await t());this.getVoices=()=>d}),this.dispatchEvent(new sr("voiceschanged"))}}return{speechSynthesis:new o,SpeechSynthesisEvent:sr,SpeechSynthesisUtterance:Sg}};var Pg=vE;function Ku(i={}){return{...ds(i),...Pg(i)}}var Rg=document.createElement("meta");Rg.setAttribute("name","web-speech-cognitive-services");Rg.setAttribute("content","version=8.1.1");document.head.appendChild(Rg);globalThis.WebSpeechCognitiveServices={create:Ku,createSpeechRecognitionPonyfillFromRecognizer:Tr};})();
//# sourceMappingURL=web-speech-cognitive-services.production.min.js.map